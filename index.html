<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Capacity Planner | Gusto Workforce Planning</title>
  
  <!-- Google Fonts - Gusto uses Libre Franklin and similar -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* ═══════════════════════════════════════════════════════════════════════
       GUSTO DESIGN SYSTEM - Clean, Modern, Professional
       ═══════════════════════════════════════════════════════════════════════ */
    
    :root {
      /* Core Brand Colors */
      --gusto-teal: #0A8080;
      --gusto-teal-light: #E6F4F4;
      --gusto-teal-dark: #066060;
      --gusto-coral: #F45D48;
      --gusto-coral-light: #FEE7E4;
      
      /* Neutrals */
      --white: #FFFFFF;
      --gray-50: #F9FAFB;
      --gray-100: #F3F4F6;
      --gray-200: #E5E7EB;
      --gray-300: #D1D5DB;
      --gray-400: #9CA3AF;
      --gray-500: #6B7280;
      --gray-600: #4B5563;
      --gray-700: #374151;
      --gray-800: #1F2937;
      --gray-900: #111827;
      
      /* Status Colors */
      --success: #10B981;
      --success-bg: #D1FAE5;
      --warning: #F59E0B;
      --warning-bg: #FEF3C7;
      --error: #EF4444;
      --error-bg: #FEE2E2;
      --info: #3B82F6;
      --info-bg: #DBEAFE;
      
      /* Staffing Colors */
      --overstaffed: #10B981;
      --understaffed: #EF4444;
      --balanced: #6B7280;
      --editable: #FEF3C7;
      
      /* Spacing */
      --space-xs: 4px;
      --space-sm: 8px;
      --space-md: 16px;
      --space-lg: 24px;
      --space-xl: 32px;
      --space-2xl: 48px;
      
      /* Typography */
      --font-primary: 'DM Sans', 'Inter', system-ui, sans-serif;
      --font-mono: 'SF Mono', 'Monaco', 'Consolas', monospace;
      
      /* Borders & Shadows */
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: var(--font-primary);
      background: var(--gray-50);
      color: var(--gray-800);
      min-height: 100vh;
      line-height: 1.5;
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       APP LAYOUT - Left Nav + Main Content
       ═══════════════════════════════════════════════════════════════════════ */
    
    .app-container {
      display: flex;
      min-height: 100vh;
    }
    
    /* LEFT NAVIGATION SIDEBAR - Clean White Design */
    .nav-sidebar {
      width: 240px;
      background: var(--white);
      color: var(--gray-700);
      display: flex;
      flex-direction: column;
      position: fixed;
      left: 0;
      top: 0;
      bottom: 0;
      z-index: 100;
      box-shadow: 2px 0 20px rgba(0, 0, 0, 0.08);
      border-right: 1px solid var(--gray-100);
      transition: width 0.3s ease, transform 0.3s ease;
    }
    
    .nav-sidebar.collapsed {
      width: 64px;
    }
    
    .nav-sidebar.collapsed .nav-text,
    .nav-sidebar.collapsed .logo-text,
    .nav-sidebar.collapsed .section-label,
    .nav-sidebar.collapsed .status-details {
      opacity: 0;
      visibility: hidden;
    }
    
    .nav-header {
      padding: var(--space-lg);
      border-bottom: 1px solid var(--gray-100);
      display: flex;
      align-items: center;
      gap: var(--space-md);
      background: linear-gradient(135deg, var(--gusto-teal) 0%, var(--gusto-teal-light) 100%);
    }
    
    .logo {
      width: 36px;
      height: 36px;
      background: var(--white);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: var(--gusto-teal);
      font-size: 18px;
      flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .logo-text {
      font-weight: 600;
      font-size: 16px;
      color: var(--white);
      transition: opacity 0.3s ease;
    }
    
    .nav-content {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-sm) 0;
      scrollbar-width: thin;
      scrollbar-color: var(--gray-200) transparent;
    }
    
    .nav-content::-webkit-scrollbar {
      width: 6px;
    }
    
    .nav-content::-webkit-scrollbar-track {
      background: transparent;
    }
    
    .nav-content::-webkit-scrollbar-thumb {
      background: var(--gray-200);
      border-radius: 3px;
    }
    
    .nav-content::-webkit-scrollbar-thumb:hover {
      background: var(--gray-300);
    }
    
    .nav-section {
      margin-bottom: var(--space-sm);
    }
    
    .section-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--gusto-teal);
      padding: var(--space-sm) var(--space-md);
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: all 0.2s ease;
      user-select: none;
    }
    
    .section-label:hover {
      background: var(--gray-50);
    }
    
    .section-label::after {
      content: '▼';
      font-size: 8px;
      color: var(--gray-400);
      transition: transform 0.2s ease;
    }
    
    .nav-section.collapsed .section-label::after {
      transform: rotate(-90deg);
    }
    
    .nav-section.collapsed .nav-items {
      display: none;
    }
    
    .nav-item {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      padding: 8px var(--space-md);
      color: var(--gray-600);
      text-decoration: none;
      cursor: pointer;
      transition: all 0.2s ease;
      border-left: 3px solid transparent;
      font-size: 13px;
      margin: 2px 8px;
      border-radius: var(--radius-sm);
    }
    
    .nav-item:hover {
      background: rgba(10, 128, 128, 0.08);
      color: var(--gusto-teal);
    }
    
    .nav-item.active {
      background: rgba(10, 128, 128, 0.12);
      color: var(--gusto-teal);
      font-weight: 600;
      border-left-color: var(--gusto-teal);
    }
    
    .nav-icon {
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      flex-shrink: 0;
    }
    
    .nav-text {
      font-size: 14px;
      font-weight: 500;
      transition: opacity 0.3s ease;
    }
    
    .nav-badge {
      margin-left: auto;
      background: var(--gusto-coral);
      color: white;
      font-size: 11px;
      font-weight: 600;
      padding: 2px 6px;
      border-radius: 10px;
      min-width: 18px;
      text-align: center;
    }
    
    /* Status Panel in Nav */
    .status-panel {
      padding: var(--space-md) var(--space-lg);
      border-top: 1px solid rgba(255,255,255,0.1);
      background: rgba(0,0,0,0.1);
    }
    
    .status-indicator {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      margin-bottom: var(--space-sm);
    }
    
    .status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    .status-dot.editing { background: var(--warning); }
    .status-dot.saved { background: var(--success); }
    .status-dot.error { background: var(--error); }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .status-details {
      font-size: 11px;
      color: rgba(255,255,255,0.6);
    }
    
    .collapse-btn {
      position: absolute;
      right: -12px;
      top: 50%;
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      background: var(--white);
      border: 1px solid var(--gray-200);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: var(--shadow-md);
      transition: transform 0.2s ease;
      color: var(--gray-600);
      font-size: 12px;
    }
    
    .collapse-btn:hover {
      background: var(--gray-50);
    }
    
    .nav-sidebar.collapsed .collapse-btn {
      transform: translateY(-50%) rotate(180deg);
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       MAIN CONTENT AREA
       ═══════════════════════════════════════════════════════════════════════ */
    
    .main-content {
      flex: 1;
      margin-left: 240px;
      display: flex;
      flex-direction: column;
      transition: margin-left 0.3s ease;
    }
    
    .nav-sidebar.collapsed ~ .main-content {
      margin-left: 72px;
    }
    
    /* Top Header Bar */
    .top-bar {
      background: var(--white);
      border-bottom: 1px solid var(--gray-200);
      padding: var(--space-md) var(--space-xl);
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 50;
    }
    
    .page-title {
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }
    
    .page-title h1 {
      font-size: 22px;
      font-weight: 600;
      color: var(--gray-900);
    }
    
    .pillar-badge {
      background: var(--gusto-teal-light);
      color: var(--gusto-teal-dark);
      padding: var(--space-xs) var(--space-md);
      border-radius: var(--radius-md);
      font-size: 13px;
      font-weight: 600;
    }
    
    .pillar-dropdown {
      background: var(--gusto-teal);
      color: var(--white);
      padding: var(--space-sm) var(--space-md);
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 600;
      border: 2px solid var(--gusto-teal-dark);
      cursor: pointer;
      font-family: inherit;
      min-width: 180px;
    }
    
    .pillar-dropdown:hover {
      background: var(--gusto-teal-dark);
    }
    
    .pillar-dropdown:focus {
      outline: none;
      box-shadow: 0 0 0 3px var(--gusto-teal-light);
    }
    
    .pillar-dropdown option {
      background: var(--white);
      color: var(--gray-800);
      padding: var(--space-sm);
    }
    
    .top-actions {
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }
    
    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-sm) var(--space-md);
      border-radius: var(--radius-md);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      font-family: inherit;
    }
    
    .btn-primary {
      background: var(--gusto-teal);
      color: var(--white);
    }
    
    .btn-primary:hover {
      background: var(--gusto-teal-dark);
      box-shadow: var(--shadow-md);
    }
    
    .btn-secondary {
      background: var(--white);
      color: var(--gray-700);
      border: 1px solid var(--gray-300);
    }
    
    .btn-secondary:hover {
      background: var(--gray-50);
      border-color: var(--gray-400);
    }
    
    .btn-coral {
      background: var(--gusto-coral);
      color: var(--white);
    }
    
    .btn-coral:hover {
      background: #E04D3A;
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       PLANNING WORKSPACE
       ═══════════════════════════════════════════════════════════════════════ */
    
    .workspace {
      flex: 1;
      padding: var(--space-lg) var(--space-xl);
      overflow-y: auto;
      max-width: 100%;
    }
    
    /* Make nav sidebar narrower to give more space */
    .nav-sidebar {
      width: 240px;
    }
    
    .main-content {
      margin-left: 240px;
    }
    
    /* Quick Stats Bar - Full Width, Even Spacing */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--space-md);
      margin-bottom: var(--space-md);
    }
    
    /* Responsive Grid Utilities */
    .responsive-grid-4 {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--space-md);
    }
    
    .responsive-grid-3 {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-lg);
    }
    
    .stat-card {
      background: var(--white);
      border-radius: var(--radius-md);
      padding: var(--space-md);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--gray-100);
      text-align: center;
      position: relative;
    }
    
    .stat-card.highlight {
      border-top: 3px solid var(--gusto-teal);
    }
    
    .stat-card.warning {
      border-top: 3px solid var(--warning);
    }
    
    .stat-card.success {
      border-top: 3px solid var(--success);
    }
    
    .stat-card.error {
      border-top: 3px solid var(--error);
    }
    
    .stat-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-xs);
    }
    
    .stat-card select {
      font-size: 10px;
      padding: 2px 4px;
      border: 1px solid var(--gray-200);
      border-radius: var(--radius-sm);
      background: var(--gray-50);
      color: var(--gray-600);
      cursor: pointer;
    }
    
    .stat-label {
      font-size: 10px;
      color: var(--gray-500);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }
    
    .stat-month {
      font-size: 9px;
      color: var(--gusto-teal);
      font-weight: 600;
      background: var(--gusto-teal-light);
      padding: 2px 6px;
      border-radius: 10px;
    }
    
    .stat-value {
      font-size: 28px;
      font-weight: 700;
      color: var(--gray-900);
      margin: var(--space-xs) 0;
    }
    
    .stat-change {
      font-size: 11px;
      color: var(--gray-400);
    }
    
    .stat-change.positive { color: var(--success); }
    .stat-change.negative { color: var(--error); }
    
    /* ═══════════════════════════════════════════════════════════════════════
       PILLAR SUMMARY - Quad Layout with Trend Chart
       ═══════════════════════════════════════════════════════════════════════ */
    
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--gray-200);
      border-top-color: var(--gusto-teal);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-text {
      margin-top: var(--space-md);
      color: var(--gray-600);
      font-size: 14px;
    }
    
    .pillar-summary-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: var(--space-sm);
      margin-bottom: var(--space-sm);
      align-items: stretch;
      min-height: 180px;
    }
    
    .summary-section {
      background: var(--white);
      border-radius: var(--radius-sm);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--gray-100);
      overflow: hidden;
    }
    
    .summary-header {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      gap: 10px;
      padding: 6px 10px;
      background: var(--gray-50);
      border-bottom: 1px solid var(--gray-100);
    }
    
    .summary-header h3 {
      margin: 0;
      font-size: 13px;
      font-weight: 600;
      color: var(--gusto-teal);
    }
    
    .summary-header .expand-btn,
    .summary-header button[data-tooltip] {
      margin-left: auto;
    }
    
    .month-select {
      font-size: 9px;
      padding: 2px 4px;
      border: 1px solid var(--gray-200);
      border-radius: var(--radius-sm);
      background: var(--white);
      cursor: pointer;
    }
    
    .expand-btn {
      background: var(--gray-100);
      border: none;
      padding: 6px 10px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    
    .expand-btn:hover {
      background: var(--gusto-teal);
      color: white;
    }
    
    .metrics-quad {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1px;
      background: var(--gray-200);
      padding: 1px;
      flex: 1;
    }
    
    .metric-tile {
      background: var(--white);
      padding: 12px 10px;
      text-align: center;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .metric-tile::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
    }
    
    .metric-tile.teal::before { background: var(--gusto-teal); }
    .metric-tile.coral::before { background: var(--gusto-coral); }
    .metric-tile.green::before { background: var(--success); }
    .metric-tile.gray::before { background: var(--gray-400); }
    
    .metric-label {
      font-size: 9px;
      color: var(--gray-500);
      text-transform: uppercase;
      letter-spacing: 0.03em;
      margin-bottom: 2px;
    }
    
    .metric-value {
      font-size: 26px;
      font-weight: 700;
      color: var(--gray-900);
      line-height: 1.1;
      margin: 6px 0 4px;
    }
    
    .metric-delta {
      font-size: 10px;
      color: var(--gray-400);
    }
    
    .metric-delta.positive { color: var(--success); }
    .metric-delta.negative { color: var(--error); }
    
    .trend-chart-container {
      padding: 2px 4px;
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 120px;
    }
    
    .trend-chart {
      width: 100%;
      height: 100%;
      flex: 1;
    }
    
    .trend-chart {
      flex: 1;
      width: 100%;
    }
    
    .chart-legend {
      display: flex;
      justify-content: center;
      gap: var(--space-lg);
      padding-top: var(--space-sm);
      border-top: 1px solid var(--gray-100);
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: var(--space-xs);
      font-size: 11px;
      color: var(--gray-600);
    }
    
    .legend-line {
      width: 20px;
      height: 2px;
      background: currentColor;
    }
    
    .legend-line.teal { background: var(--gusto-teal); }
    .legend-line.coral { background: var(--gusto-coral); }
    .legend-line.dashed { 
      background: repeating-linear-gradient(
        90deg,
        var(--gusto-coral),
        var(--gusto-coral) 4px,
        transparent 4px,
        transparent 8px
      );
    }
    
    /* Expanded chart modal */
    .chart-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9998;
    }
    
    .chart-modal.active {
      display: flex;
    }
    
    .chart-modal-content {
      background: white;
      border-radius: var(--radius-lg);
      padding: var(--space-xl);
      width: 90%;
      max-width: 1000px;
      max-height: 80vh;
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       COLLAPSIBLE SECTION COLORS - Visual Hierarchy
       ═══════════════════════════════════════════════════════════════════════ */
    
    /* Full table collapse header */
    .row-section-header {
      cursor: pointer;
      transition: background 0.2s;
    }
    
    /* Main section headers - Dark backgrounds */
    .row-section-header[style*="gusto-teal"] td,
    .row-section-header[style*="gusto-coral"] td,
    .row-section-header[style*="error"] td {
      font-weight: 700 !important;
    }
    
    /* Subsection headers - Lighter, indented feel */
    .row-section-header.collapsible-row[style*="gray-100"] td {
      font-size: 11px !important;
      font-weight: 500 !important;
      color: var(--gray-600) !important;
      padding-left: 24px !important;
    }
    
    /* Subsection toggle indicator */
    .row-section-header.collapsible-row::after {
      content: ' ▼';
      font-size: 10px;
      opacity: 0.6;
    }
    
    .row-section-header.collapsible-row.collapsed::after {
      content: ' ▶';
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       STAFFING TABLE - Modern Data Grid
       ═══════════════════════════════════════════════════════════════════════ */
    
    .table-section {
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--gray-100);
      margin-bottom: var(--space-xl);
      overflow: hidden;
    }
    
    .table-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-md) var(--space-lg);
      background: var(--gray-50);
      border-bottom: 1px solid var(--gray-200);
    }
    
    .table-title {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      font-weight: 600;
      font-size: 15px;
      color: var(--gray-800);
    }
    
    .table-title-icon {
      width: 24px;
      height: 24px;
      background: var(--gusto-teal-light);
      color: var(--gusto-teal);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }
    
    .table-actions {
      display: flex;
      gap: var(--space-sm);
    }
    
    .table-action-btn {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--gray-200);
      background: var(--white);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray-500);
      transition: all 0.2s ease;
    }
    
    .table-action-btn:hover {
      border-color: var(--gusto-teal);
      color: var(--gusto-teal);
    }
    
    /* Universal Tooltip - POPUP style, never clipped */
    [data-tooltip] {
      position: relative;
    }
    
    /* Hide default tooltip arrow - we'll just show text */
    [data-tooltip]:hover::before {
      display: none;
    }
    
    [data-tooltip]:hover::after {
      content: attr(data-tooltip);
      position: fixed;
      background: var(--gray-800);
      color: var(--white);
      padding: 10px 14px;
      border-radius: var(--radius-md);
      font-size: 12px;
      white-space: nowrap;
      z-index: 99999;
      box-shadow: var(--shadow-xl);
      pointer-events: none;
      animation: tooltipPopIn 0.15s ease;
      /* Position will be set by JS, fallback to center */
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    
    @keyframes tooltipPopIn {
      from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
      to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
    
    /* Scenario tabs */
    .scenario-tab {
      flex: 1;
      padding: var(--space-md);
      border: none;
      background: var(--gray-50);
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      color: var(--gray-500);
      transition: all 0.2s ease;
    }
    
    .scenario-tab:hover {
      background: var(--gray-100);
    }
    
    .scenario-tab.active {
      background: var(--white);
      color: var(--gusto-teal);
      border-bottom: 2px solid var(--gusto-teal);
    }
    
    .data-grid {
      overflow-x: auto;
      position: relative;
    }
    
    /* Only use scrollable class when truly needed (e.g., modals) */
    .data-grid.scrollable {
      max-height: 500px;
      overflow-y: auto;
    }
    
    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    
    .data-table thead {
      position: sticky;
      top: 0;
      z-index: 25;
    }
    
    .data-table th {
      background: var(--gray-100);
      font-weight: 600;
      color: var(--gray-600);
      text-transform: uppercase;
      font-size: 10px;
      letter-spacing: 0.02em;
      padding: 6px 8px;
      border-bottom: 2px solid var(--gusto-teal);
      text-align: center;
      white-space: nowrap;
    }

    .data-table th:first-child {
      text-align: left;
      background: var(--gray-200);
      position: sticky;
      left: 0;
      z-index: 35;
      min-width: 160px;
    }
    
    .data-table td {
      padding: 6px 8px;
      border-bottom: 1px solid var(--gray-100);
      text-align: center;
      white-space: nowrap;
    }
    
    .data-table td:first-child {
      text-align: left;
      font-weight: 500;
      background: var(--white);
      position: sticky;
      left: 0;
      z-index: 10;
      border-right: 1px solid var(--gray-200);
      min-width: 180px;
      max-width: 200px;
      font-size: 11px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      box-shadow: 2px 0 4px rgba(0,0,0,0.05);
    }
    
    .data-table tr:hover td {
      background: var(--gusto-teal-light);
    }
    
    .data-table tr:hover td:first-child {
      background: var(--gusto-teal-light);
    }
    
    /* Compact inputs for overlay tables */
    .data-table input,
    .data-table select {
      font-size: 10px;
      padding: 2px 3px;
      border: 1px solid var(--gray-300);
      border-radius: 3px;
      width: 42px;
      text-align: center;
    }
    
    .data-table select {
      width: 48px;
      cursor: pointer;
      font-size: 9px;
    }
    
    /* Uniform SL Target dropdown */
    .data-table select.sl-select {
      width: 50px;
      font-size: 10px;
      padding: 3px 2px;
      text-align: center;
    }
    
    /* Percent input with % inside */
    .pct-input {
      display: inline-flex;
      align-items: center;
      background: var(--white);
      border: 1px solid var(--gray-300);
      border-radius: 4px;
      padding: 2px 4px;
    }
    
    .pct-input input {
      width: 32px !important;
      border: none !important;
      padding: 2px !important;
      text-align: right;
      font-size: 12px;
      background: transparent;
    }
    
    .pct-input input:focus {
      outline: none;
    }
    
    .pct-input span {
      font-size: 11px;
      color: var(--gray-500);
      margin-left: 1px;
    }
    
    /* Optimized for 24-month view - balanced readability */
    .compact-24 .data-table th,
    .compact-24 .data-table td {
      padding: 5px 8px;
      font-size: 12px;
    }
    
    .compact-24 .data-table th:first-child,
    .compact-24 .data-table td:first-child {
      min-width: 180px;
      max-width: 200px;
      font-size: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .compact-24 .data-table input,
    .compact-24 .data-table select {
      width: 48px;
      font-size: 11px;
      padding: 3px 4px;
    }
    
    /* Quarter grouping headers */
    .quarter-header {
      background: var(--gusto-teal-dark) !important;
      color: var(--white) !important;
      font-weight: 700 !important;
      text-align: center !important;
      cursor: pointer;
      user-select: none;
    }
    
    .quarter-header:hover {
      background: var(--gusto-teal) !important;
    }
    
    .quarter-months {
      transition: all 0.3s ease;
    }
    
    .quarter-months.collapsed {
      display: none;
    }
    
    /* Collapsible table subsections */
    .row-section-header.collapsible-row {
      cursor: pointer;
      user-select: none;
    }
    
    .row-section-header.collapsible-row:hover {
      opacity: 0.9;
    }
    
    .row-section-header.collapsible-row td::after {
      content: ' ▼';
      font-size: 10px;
      opacity: 0.7;
    }
    
    .row-section-header.collapsible-row.collapsed td::after {
      content: ' ▶';
    }
    
    .subsection-row {
      transition: all 0.2s ease;
    }
    
    .subsection-row.hidden, .hidden {
      display: none !important;
    }
    
    /* Channel subsection rows - light teal with dark teal text (brand consistent) */
    .subsection-row.channel-sub {
      background: rgba(10, 128, 128, 0.08) !important;
    }
    
    .subsection-row.channel-sub td {
      background: rgba(10, 128, 128, 0.08) !important;
      color: var(--gray-700) !important;
      font-size: 11px;
      text-align: right;
      padding-right: 16px;
    }
    
    .subsection-row.channel-sub td:first-child {
      text-align: right !important;
      padding-right: 20px;
      font-weight: 500;
      color: var(--gusto-teal) !important;
    }
    
    /* "By Channel" collapse header row - light teal (brand consistent) */
    .by-channel-header {
      background: rgba(10, 128, 128, 0.12) !important;
      font-size: 11px !important;
      cursor: pointer;
    }
    
    .by-channel-header td {
      background: rgba(10, 128, 128, 0.12) !important;
      color: var(--gusto-teal) !important;
      font-weight: 500 !important;
      padding-left: 24px !important;
    }
    
    /* Smaller channel header */
    .channel-header {
      padding: var(--space-sm) var(--space-md);
    }
    
    .channel-name {
      font-size: 14px !important;
      font-weight: 600;
    }
    
    .channel-icon {
      width: 28px !important;
      height: 28px !important;
      font-size: 14px !important;
    }
    
    .channel-stat-value {
      font-size: 14px !important;
    }
    
    .channel-stat-label {
      font-size: 9px !important;
    }
    
    /* Smart input indicator */
    .data-table input.is-percent {
      background: var(--info-bg);
      border-color: var(--info);
    }
    
    .data-table input.is-value {
      background: var(--white);
    }
    
    /* Row Categories */
    .row-section-header {
      background: var(--gusto-teal) !important;
      color: var(--white) !important;
      font-weight: 600 !important;
      font-size: 11px !important;
      cursor: pointer;
    }
    
    .row-section-header td {
      background: var(--gusto-teal) !important;
      color: var(--white) !important;
      padding: 6px 8px !important;
    }
    
    .row-section-header.collapsible td:first-child::before {
      content: '▼ ';
      font-size: 9px;
    }
    
    .row-section-header.collapsible.collapsed td:first-child::before {
      content: '▶ ';
    }
    
    .row-calculated {
      background: var(--success-bg);
    }
    
    .row-calculated td {
      color: var(--gray-800);
      font-weight: 500;
    }
    
    .row-editable {
      background: var(--warning-bg);
    }
    
    .row-editable input {
      width: 100%;
      padding: 4px 8px;
      border: 1px solid var(--gray-300);
      border-radius: var(--radius-sm);
      text-align: center;
      font-size: 13px;
      font-family: inherit;
      background: var(--white);
    }
    
    .row-editable input:focus {
      outline: none;
      border-color: var(--gusto-teal);
      box-shadow: 0 0 0 3px var(--gusto-teal-light);
    }
    
    .row-result {
      background: var(--gray-50);
      font-weight: 600;
    }
    
    /* Staffing Gap Indicators */
    .gap-positive {
      color: var(--success);
      font-weight: 600;
    }
    
    .gap-negative {
      color: var(--error);
      font-weight: 600;
    }
    
    /* Compare Mode Diff Highlights */
    .diff-increase {
      background: #D1FAE5 !important;
      position: relative;
    }
    .diff-increase::after {
      content: '▲';
      position: absolute;
      right: 4px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--success);
      font-size: 8px;
    }
    .diff-decrease {
      background: #FEE2E2 !important;
      position: relative;
    }
    .diff-decrease::after {
      content: '▼';
      position: absolute;
      right: 4px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--error);
      font-size: 8px;
    }
    
    /* Published view styling */
    body.view-published .data-table input {
      cursor: not-allowed;
    }
    body.view-published .comparison-toggle .comparison-option:nth-child(2) {
      background: var(--success);
      color: white;
    }
    
    /* Compare view styling */
    body.view-compare .comparison-toggle .comparison-option:nth-child(3) {
      background: var(--warning);
      color: white;
    }
    
    .gap-neutral {
      color: var(--gray-500);
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       CHANNEL SECTION - Collapsible
       ═══════════════════════════════════════════════════════════════════════ */
    
    .channel-section {
      border: 1px solid var(--gray-200);
      border-radius: var(--radius-md);
      margin: var(--space-md) var(--space-lg);
      overflow: hidden;
    }
    
    .channel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-xs) var(--space-md);
      background: var(--gray-50);
      cursor: pointer;
      transition: background 0.2s ease;
    }
    
    .channel-header:hover {
      background: var(--gray-100);
    }
    
    .channel-info {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    
    .channel-icon {
      width: 28px;
      height: 28px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    
    .channel-icon.phone { background: #DBEAFE; color: #2563EB; }
    .channel-icon.email { background: #FEE2E2; color: #DC2626; }
    .channel-icon.chat { background: #D1FAE5; color: #059669; }
    
    .channel-name {
      font-weight: 600;
      color: var(--gray-800);
    }
    
    .channel-stats {
      display: flex;
      gap: var(--space-lg);
    }
    
    .channel-stat {
      text-align: center;
    }
    
    .channel-stat-value {
      font-weight: 700;
      font-size: 16px;
    }
    
    .channel-stat-label {
      font-size: 11px;
      color: var(--gray-500);
    }
    
    .channel-body {
      display: none;
      padding: var(--space-sm);
      background: var(--white);
    }
    
    .channel-section.expanded .channel-body {
      display: block;
    }
    
    /* Channel tables - horizontal scroll only, natural vertical */
    .channel-body .data-grid {
      overflow-x: auto;
      position: relative;
      border: 2px solid var(--gusto-teal);
      border-radius: var(--radius-sm);
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.05);
    }
    
    /* Visual scroll indicator */
    .channel-body .data-grid::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 20px;
      background: linear-gradient(transparent, rgba(10, 128, 128, 0.1));
      pointer-events: none;
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       COMPACT CHANNEL TABLES - Tighter spacing for 24-month view
       ═══════════════════════════════════════════════════════════════════════ */
    .channel-body .data-table {
      font-size: 11px;
    }
    
    .channel-body .data-table th,
    .channel-body .data-table td {
      padding: 4px 3px;
      min-width: 45px;
      max-width: 55px;
    }
    
    .channel-body .data-table th:first-child,
    .channel-body .data-table td:first-child {
      min-width: 200px;
      max-width: 220px;
      font-size: 11px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      z-index: 10;
      box-shadow: 2px 0 4px rgba(0,0,0,0.05);
    }
    
    .channel-body .data-table input[type="text"],
    .channel-body .data-table input[type="number"] {
      width: 40px !important;
      padding: 2px 3px;
      font-size: 10px;
    }
    
    .channel-body .data-table select.sl-select {
      width: 55px !important;
      padding: 1px 2px;
      font-size: 9px;
    }
    
    /* Quarter separators for visual grouping */
    .channel-body .data-table th:nth-child(4),
    .channel-body .data-table td:nth-child(4),
    .channel-body .data-table th:nth-child(7),
    .channel-body .data-table td:nth-child(7),
    .channel-body .data-table th:nth-child(10),
    .channel-body .data-table td:nth-child(10),
    .channel-body .data-table th:nth-child(13),
    .channel-body .data-table td:nth-child(13),
    .channel-body .data-table th:nth-child(16),
    .channel-body .data-table td:nth-child(16),
    .channel-body .data-table th:nth-child(19),
    .channel-body .data-table td:nth-child(19),
    .channel-body .data-table th:nth-child(22),
    .channel-body .data-table td:nth-child(22),
    .channel-body .data-table th:nth-child(25),
    .channel-body .data-table td:nth-child(25) {
      border-right: 2px solid var(--gusto-teal-light);
    }
    
    /* Baseline metrics rows - teal backfill */
    .baseline-row, 
    .subsection-row[class*="baseline"] {
      background: var(--gusto-teal-light) !important;
    }
    
    .baseline-row td,
    .subsection-row[class*="baseline"] td {
      background: var(--gusto-teal-light) !important;
    }
    
    .baseline-row td:first-child,
    .subsection-row[class*="baseline"] td:first-child {
      background: var(--gusto-teal-light) !important;
      color: var(--gray-700);
      font-weight: 500;
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       MULTI-SELECT DROPDOWN WITH CHECKBOXES
       ═══════════════════════════════════════════════════════════════════════ */
    
    .multi-select {
      position: relative;
      display: inline-block;
    }
    
    .multi-select-trigger {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: var(--white);
      border: 1px solid var(--gray-300);
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 13px;
      min-width: 140px;
    }
    
    .multi-select-trigger:hover {
      border-color: var(--gusto-teal);
    }
    
    .multi-select-trigger::after {
      content: '▼';
      font-size: 10px;
      margin-left: auto;
      color: var(--gray-400);
    }
    
    .multi-select-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--white);
      border: 1px solid var(--gray-200);
      border-radius: var(--radius-sm);
      box-shadow: var(--shadow-lg);
      z-index: 100;
      display: none;
      max-height: 250px;
      overflow-y: auto;
      min-width: 180px;
    }
    
    .multi-select.open .multi-select-dropdown {
      display: block;
    }
    
    .multi-select-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 13px;
      transition: background 0.15s ease;
    }
    
    .multi-select-item:hover {
      background: var(--gray-50);
    }
    
    .multi-select-item.select-all {
      border-bottom: 1px solid var(--gray-200);
      font-weight: 600;
      background: var(--gray-50);
    }
    
    .multi-select-item input[type="checkbox"] {
      width: 16px;
      height: 16px;
      cursor: pointer;
    }
    
    .expand-icon {
      transition: transform 0.2s ease;
    }
    
    .channel-section.expanded .expand-icon {
      transform: rotate(180deg);
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       COMPARISON VIEW
       ═══════════════════════════════════════════════════════════════════════ */
    
    .comparison-toggle {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      background: var(--gray-100);
      padding: 4px;
      border-radius: var(--radius-md);
    }
    
    .comparison-option {
      padding: var(--space-sm) var(--space-md);
      border-radius: var(--radius-sm);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--gray-600);
    }
    
    .comparison-option.active {
      background: var(--white);
      color: var(--gusto-teal);
      box-shadow: var(--shadow-sm);
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       COLLAPSIBLE SECTIONS
       ═══════════════════════════════════════════════════════════════════════ */
    
    .collapsible-section {
      transition: all 0.3s ease;
    }
    
    .collapsible-section .table-body {
      max-height: 2000px;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }
    
    .collapsible-section.collapsed .table-body {
      max-height: 0;
    }
    
    .collapse-toggle {
      cursor: pointer;
      user-select: none;
    }
    
    .collapse-toggle::after {
      content: '▼';
      margin-left: var(--space-sm);
      font-size: 10px;
      transition: transform 0.2s ease;
    }
    
    .collapsible-section.collapsed .collapse-toggle::after {
      transform: rotate(-90deg);
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       FLOATING ACTION BUTTONS (FAB)
       ═══════════════════════════════════════════════════════════════════════ */
    
    .fab-container {
      position: fixed;
      bottom: var(--space-lg);
      right: var(--space-lg);
      z-index: 500;
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
      align-items: flex-end;
    }
    
    .fab-container.expanded .fab-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .fab-main {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--gray-600);
      color: var(--white);
      border: none;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-md);
      transition: all 0.3s ease;
      opacity: 0.8;
    }
    
    .fab-main:hover {
      transform: scale(1.1);
      background: var(--gusto-teal);
      opacity: 1;
    }
    
    .fab-menu {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: all 0.3s ease;
      margin-bottom: var(--space-sm);
    }
    
    .fab-item {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-sm) var(--space-md);
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
      font-size: 13px;
      font-weight: 500;
    }
    
    .fab-item:hover {
      transform: translateX(5px);
      box-shadow: var(--shadow-lg);
    }
    
    .fab-item-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }
    
    .fab-item.feedback .fab-item-icon { background: var(--info-bg); color: var(--info); }
    .fab-item.bug .fab-item-icon { background: var(--error-bg); color: var(--error); }
    .fab-item.feature .fab-item-icon { background: var(--success-bg); color: var(--success); }
    
    /* ═══════════════════════════════════════════════════════════════════════
       ACTIVITY/CONTROL CENTER PANEL
       ═══════════════════════════════════════════════════════════════════════ */
    
    .activity-panel {
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--gray-100);
      padding: var(--space-lg);
      margin-bottom: var(--space-xl);
    }
    
    .activity-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--space-md);
    }
    
    .activity-title {
      font-weight: 600;
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    
    .activity-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }
    
    .activity-item {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-sm) var(--space-md);
      background: var(--gray-50);
      border-radius: var(--radius-md);
      font-size: 13px;
    }
    
    .activity-avatar {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--gusto-teal);
      color: var(--white);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 600;
    }
    
    .activity-status {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 12px;
      margin-left: auto;
    }
    
    .activity-status.editing {
      background: var(--warning-bg);
      color: var(--warning);
    }
    
    .activity-status.viewing {
      background: var(--info-bg);
      color: var(--info);
    }
    
    .activity-status.idle {
      background: var(--gray-100);
      color: var(--gray-500);
    }
    
    .pulse-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }
    
    .pulse-dot.editing { background: var(--warning); }
    .pulse-dot.viewing { background: var(--info); }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.2); }
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       VERSION CONTROL / PUBLISHED PLANS
       ═══════════════════════════════════════════════════════════════════════ */
    
    .version-panel {
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--gray-100);
      margin-bottom: var(--space-xl);
    }
    
    .version-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-md) var(--space-lg);
      border-bottom: 1px solid var(--gray-100);
    }
    
    .version-tabs {
      display: flex;
      gap: var(--space-sm);
    }
    
    .version-tab {
      padding: var(--space-sm) var(--space-md);
      border-radius: var(--radius-sm);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      background: transparent;
      color: var(--gray-500);
      border: none;
    }
    
    .version-tab.active {
      background: var(--gusto-teal);
      color: var(--white);
    }
    
    .version-list {
      padding: var(--space-md) var(--space-lg);
      max-height: 300px;
      overflow-y: auto;
    }
    
    .version-item {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md);
      border-radius: var(--radius-md);
      transition: background 0.2s ease;
      cursor: pointer;
    }
    
    .version-item:hover {
      background: var(--gray-50);
    }
    
    .version-item.current {
      background: var(--gusto-teal-light);
      border-left: 3px solid var(--gusto-teal);
    }
    
    .version-badge {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 10px;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .version-badge.published {
      background: var(--success-bg);
      color: var(--success);
    }
    
    .version-badge.draft {
      background: var(--warning-bg);
      color: var(--warning);
    }
    
    .version-badge.scenario {
      background: var(--info-bg);
      color: var(--info);
    }
    
    .version-info {
      flex: 1;
    }
    
    .version-name {
      font-weight: 600;
      font-size: 14px;
      color: var(--gray-800);
    }
    
    .version-meta {
      font-size: 12px;
      color: var(--gray-500);
    }
    
    .version-actions {
      display: flex;
      gap: var(--space-xs);
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       TOAST NOTIFICATIONS
       ═══════════════════════════════════════════════════════════════════════ */
    
    .toast-container {
      position: fixed;
      bottom: var(--space-xl);
      right: var(--space-xl);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }
    
    .toast {
      background: var(--gray-800);
      color: var(--white);
      padding: 8px 14px;
      font-size: 12px;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: var(--space-md);
      animation: slideIn 0.3s ease;
      max-width: 400px;
    }
    
    .toast.success { background: var(--success); }
    .toast.warning { background: var(--warning); color: var(--gray-900); }
    .toast.error { background: var(--error); }
    
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    /* Anomaly highlighting for overlays */
    .anomaly-high {
      background: #FEF3C7 !important;
      font-weight: 600;
      color: #92400E;
      border-left: 3px solid #F59E0B !important;
    }
    .anomaly-peak {
      background: #FEE2E2 !important;
      font-weight: 700;
      color: #991B1B;
      border-left: 3px solid #DC2626 !important;
    }
    .anomaly-low {
      background: #D1FAE5 !important;
      font-weight: 600;
      color: #065F46;
      border-left: 3px solid #10B981 !important;
    }
    
    /* Overlay accordion styling */
    .overlay-pillar-content, .overlay-channel-content {
      display: block;
    }
    .overlay-pillar-content.collapsed, .overlay-channel-content.collapsed {
      display: none;
    }
    .overlay-pillar-arrow, .overlay-channel-arrow {
      transition: transform 0.2s ease;
      font-size: 10px;
    }
    .overlay-pillar-header.collapsed .overlay-pillar-arrow,
    .overlay-channel-header.collapsed .overlay-channel-arrow {
      transform: rotate(-90deg);
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       MODALS
       ═══════════════════════════════════════════════════════════════════════ */
    
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .modal {
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-xl);
      max-width: 500px;
      width: 90%;
      max-height: 90vh;
      overflow: hidden;
      transform: scale(0.95);
      transition: transform 0.3s ease;
    }
    
    .modal-overlay.active .modal {
      transform: scale(1);
    }
    
    .modal-header {
      padding: var(--space-lg);
      border-bottom: 1px solid var(--gray-200);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .modal-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--gray-900);
    }
    
    .modal-close {
      width: 32px;
      height: 32px;
      border: none;
      background: var(--gray-100);
      border-radius: var(--radius-sm);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray-500);
    }
    
    .modal-body {
      padding: var(--space-lg);
      overflow-y: auto;
    }
    
    .modal-footer {
      padding: var(--space-lg);
      border-top: 1px solid var(--gray-200);
      display: flex;
      justify-content: flex-end;
      gap: var(--space-md);
    }
    
    /* Form Elements */
    .form-group {
      margin-bottom: var(--space-lg);
    }
    
    .form-label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      color: var(--gray-700);
      margin-bottom: var(--space-sm);
    }
    
    .form-input,
    .form-select {
      width: 100%;
      max-width: 100%;
      padding: var(--space-sm) var(--space-md);
      border: 1px solid var(--gray-300);
      border-radius: var(--radius-md);
      font-size: 14px;
      font-family: inherit;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236B7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 16px;
      padding-right: 36px;
      cursor: pointer;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
    }
    
    .form-input:focus,
    .form-select:focus {
      outline: none;
      border-color: var(--gusto-teal);
      box-shadow: 0 0 0 3px var(--gusto-teal-light);
    }
    
    /* ═══════════════════════════════════════════════════════════════════════
       RESPONSIVE - Adapts to all screen sizes
       ═══════════════════════════════════════════════════════════════════════ */
    
    /* Small screens / tablets */
    @media (max-width: 1024px) {
      .nav-sidebar {
        transform: translateX(-100%);
      }
      
      .nav-sidebar.mobile-open {
        transform: translateX(0);
      }
      
      .main-content {
        margin-left: 0;
      }
    }
    
    /* Large screens (1440px+) - Scale up content */
    @media (min-width: 1440px) {
      :root {
        --space-md: 20px;
        --space-lg: 32px;
        --space-xl: 40px;
        --space-2xl: 56px;
      }
      
      .workspace {
        padding: var(--space-xl) !important;
      }
      
      /* Bigger cards */
      .stat-card, .quick-stat-card {
        padding: 24px 28px !important;
      }
      
      .stat-value {
        font-size: 32px !important;
      }
      
      .stat-label {
        font-size: 13px !important;
      }
      
      /* Bigger section titles */
      section h1, .section-title, .view-container h1 {
        font-size: 28px !important;
      }
      
      /* Bigger table text */
      table th {
        font-size: 13px !important;
        padding: 14px 18px !important;
      }
      
      table td {
        font-size: 14px !important;
        padding: 12px 18px !important;
      }
      
      /* Bigger buttons */
      .btn {
        padding: 12px 20px !important;
        font-size: 14px !important;
      }
      
      /* Wider nav */
      .nav-sidebar {
        width: 260px;
      }
      
      .main-content {
        margin-left: 260px;
      }
      
      .nav-sidebar.collapsed ~ .main-content {
        margin-left: 72px;
      }
    }
    
    /* Extra large screens (1920px+) - Big desktop monitors */
    @media (min-width: 1920px) {
      :root {
        --space-md: 24px;
        --space-lg: 40px;
        --space-xl: 48px;
        --space-2xl: 64px;
      }
      
      .workspace {
        padding: var(--space-2xl) !important;
        max-width: 1800px;
        margin: 0 auto;
      }
      
      /* Even bigger cards */
      .stat-card, .quick-stat-card {
        padding: 32px 36px !important;
      }
      
      .stat-value {
        font-size: 40px !important;
      }
      
      .stat-label {
        font-size: 14px !important;
      }
      
      /* Bigger section titles */
      section h1, .section-title, .view-container h1 {
        font-size: 32px !important;
      }
      
      /* Bigger page title */
      .page-title h1 {
        font-size: 26px !important;
      }
      
      /* Bigger table text */
      table th {
        font-size: 14px !important;
        padding: 16px 20px !important;
      }
      
      table td {
        font-size: 15px !important;
        padding: 14px 20px !important;
      }
      
      /* Bigger chart areas */
      .chart-container, .chart-card {
        min-height: 350px !important;
      }
      
      /* Wider nav on big screens */
      .nav-sidebar {
        width: 280px;
      }
      
      .main-content {
        margin-left: 280px;
      }
    }
    
    /* Ultra-wide screens (2560px+) */
    @media (min-width: 2560px) {
      .workspace {
        max-width: 2200px;
      }
      
      .stat-value {
        font-size: 48px !important;
      }
      
      section h1, .section-title, .view-container h1 {
        font-size: 36px !important;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- LEFT NAVIGATION SIDEBAR -->
    <nav class="nav-sidebar" id="navSidebar">
      <div class="nav-header">
        <div class="logo">G</div>
        <span class="logo-text">Capacity Planner</span>
      </div>
      
      <div class="nav-content">
        <!-- PROJECT SECTION - First for easy access -->
        <div class="nav-section">
          <div class="section-label">Project</div>
          <div class="nav-items">
            <div class="nav-item active" onclick="loadView('projecthub')" id="nav-projecthub">
              <span class="nav-icon">🚀</span>
              <span class="nav-text">Project Hub</span>
            </div>
            <div class="nav-item" onclick="loadView('overview')" id="nav-overview">
              <span class="nav-icon">📄</span>
              <span class="nav-text">Product Overview</span>
            </div>
            <div class="nav-item" onclick="loadView('designsystem')" id="nav-designsystem">
              <span class="nav-icon">🎨</span>
              <span class="nav-text">Design System</span>
            </div>
          </div>
        </div>
        
        <div class="nav-section">
          <div class="section-label">Views</div>
          <div class="nav-items">
            <div class="nav-item" onclick="loadView('controlpanel')" id="nav-controlpanel">
              <span class="nav-icon">🎛️</span>
              <span class="nav-text">Control Panel</span>
            </div>
            <div class="nav-item" onclick="loadView('allin')" id="nav-allin">
              <span class="nav-icon">🔗</span>
              <span class="nav-text">All-In View</span>
            </div>
            <div class="nav-item" onclick="loadView('comparison')" id="nav-comparison">
              <span class="nav-icon">⚖️</span>
              <span class="nav-text">Plan Comparison</span>
            </div>
            <div class="nav-item" onclick="loadView('dashboard')" id="nav-dashboard">
              <span class="nav-icon">📊</span>
              <span class="nav-text">Dashboard</span>
            </div>
          </div>
        </div>
        
        <div class="nav-section">
          <div class="section-label">Pillars</div>
          <div class="nav-items">
            <div class="nav-item" onclick="openModal('createPillar')" style="border-left-color: var(--success); background: rgba(16,185,129,0.08);">
              <span class="nav-icon">➕</span>
              <span class="nav-text">Create New Pillar</span>
            </div>
            <div class="nav-item" onclick="selectPillar('Accountant')" id="pillar-Accountant">
              <span class="nav-icon">👤</span>
              <span class="nav-text">Accountant</span>
            </div>
            <div class="nav-item" onclick="selectPillar('Benefits')" id="pillar-Benefits">
              <span class="nav-icon">🏥</span>
              <span class="nav-text">Benefits</span>
            </div>
            <div class="nav-item" onclick="selectPillar('PAC')" id="pillar-PAC">
              <span class="nav-icon">📞</span>
              <span class="nav-text">PAC</span>
            </div>
            <div class="nav-item" onclick="selectPillar('Payroll')" id="pillar-Payroll">
              <span class="nav-icon">💰</span>
              <span class="nav-text">Payroll</span>
            </div>
            <div class="nav-item" onclick="selectPillar('Premier')" id="pillar-Premier">
              <span class="nav-icon">⭐</span>
              <span class="nav-text">Premier</span>
            </div>
          </div>
        </div>
        
        <div class="nav-section">
          <div class="section-label">Data</div>
          <div class="nav-items">
            <div class="nav-item" onclick="loadView('overlays')" id="nav-overlays">
              <span class="nav-icon">🎚️</span>
              <span class="nav-text">Overlay Tracker</span>
            </div>
            <div class="nav-item" onclick="loadView('published')" id="nav-published">
              <span class="nav-icon">📋</span>
              <span class="nav-text">Published Plans</span>
            </div>
            <div class="nav-item" onclick="loadView('scenarios')" id="nav-scenarios">
              <span class="nav-icon">💾</span>
              <span class="nav-text">Scenarios</span>
            </div>
            <div class="nav-item" onclick="loadView('datamanagement')" id="nav-datamanagement">
              <span class="nav-icon">🗄️</span>
              <span class="nav-text">Data Management</span>
            </div>
          </div>
        </div>
        
        <div class="nav-section">
          <div class="section-label">Help</div>
          <div class="nav-items">
            <div class="nav-item" onclick="openModal('feedback')">
              <span class="nav-icon">💬</span>
              <span class="nav-text">Feedback</span>
            </div>
            <div class="nav-item" onclick="openModal('help')">
              <span class="nav-icon">❓</span>
              <span class="nav-text">User Guide</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="status-panel">
        <div class="status-indicator">
          <span class="status-dot editing"></span>
          <span class="nav-text">Editing Mode</span>
        </div>
        <div class="status-details">
          Last saved: 2 min ago
        </div>
      </div>
      
      <button class="collapse-btn" onclick="toggleNav()">◀</button>
    </nav>
    
    <!-- MAIN CONTENT -->
    <main class="main-content">
      <!-- Top Bar -->
      <header class="top-bar">
        <div class="page-title">
          <h1 id="pageTitle" style="font-size: 18px; font-weight: 500;">👋 Hello, Bunny B!</h1>
          <!-- Pillar Selector Dropdown (shown in pillar view) -->
          <select id="pillarDropdown" class="pillar-dropdown" onchange="selectPillar(this.value)" style="display: none; margin-left: 12px;">
            <option value="">Select a Pillar...</option>
            <option value="Accountant">👤 Accountant</option>
            <option value="Benefits">🏥 Benefits</option>
            <option value="PAC">📞 PAC</option>
            <option value="Payroll">💰 Payroll</option>
            <option value="Premier">⭐ Premier</option>
            <option value="Members">👥 Members</option>
            <option value="Money">💵 Money</option>
            <option value="BAC">📋 BAC</option>
          </select>
        </div>
        
        <div class="top-actions" id="topActions">
          <!-- Saved Plans Button -->
          <button class="btn btn-secondary" id="scenariosBtn" onclick="openModal('scenarios')" style="display: none;">
            💾 Saved Plans
          </button>
          <div class="comparison-toggle" id="comparisonToggle">
            <span class="comparison-option active" onclick="setPlanView('working')">Working Plan</span>
            <span class="comparison-option" onclick="setPlanView('published')">Published</span>
            <span class="comparison-option" onclick="setPlanView('compare')">Compare</span>
          </div>
          <button class="btn btn-secondary" onclick="recalculate()">
            🔄 Recalculate
          </button>
          <button class="btn btn-coral" onclick="openModal('save')">
            💾 Save Scenario
          </button>
          <button class="btn btn-primary" onclick="publishPlan()">
            ✅ Publish Plan
          </button>
        </div>
      </header>
      
      <!-- Workspace -->
      <div class="workspace">
        <!-- Activity/Control Center Panel - MODAL POPUP -->
        <div class="activity-modal-overlay" id="activityPanel" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.3); z-index: 1000;" onclick="if(event.target === this) toggleActivityPanel()">
          <div class="activity-modal" style="position: absolute; top: 80px; right: 20px; width: 320px; background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-xl); overflow: hidden;">
            <div class="activity-header" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: var(--gray-50); border-bottom: 1px solid var(--gray-200);">
              <div class="activity-title" style="font-weight: 600; font-size: 14px;">
                👥 Active Users
              </div>
              <button style="background: none; border: none; font-size: 18px; cursor: pointer; color: var(--gray-500);" onclick="toggleActivityPanel()">✕</button>
            </div>
            <div class="activity-list" style="padding: 8px;">
              <div class="activity-item" style="display: flex; align-items: center; gap: 12px; padding: 10px; border-radius: var(--radius-sm); background: var(--gray-50); margin-bottom: 6px;">
                <div class="activity-avatar" style="width: 36px; height: 36px; border-radius: 50%; background: var(--gusto-teal); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 12px;">BB</div>
                <div style="flex: 1;">
                  <div style="font-weight: 500; font-size: 13px;">Bunny Bates</div>
                  <div style="font-size: 11px; color: var(--gray-500);">Accountant - Phone</div>
                </div>
                <div style="display: flex; align-items: center; gap: 4px; font-size: 10px; color: var(--gusto-coral); font-weight: 500;">
                  <span style="width: 6px; height: 6px; background: var(--gusto-coral); border-radius: 50%; animation: pulse 1.5s infinite;"></span>
                  Editing
                </div>
              </div>
              <div class="activity-item" style="display: flex; align-items: center; gap: 12px; padding: 10px; border-radius: var(--radius-sm); background: var(--gray-50); margin-bottom: 6px;">
                <div class="activity-avatar" style="width: 36px; height: 36px; border-radius: 50%; background: var(--gusto-coral); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 12px;">JD</div>
                <div style="flex: 1;">
                  <div style="font-weight: 500; font-size: 13px;">John Doe</div>
                  <div style="font-size: 11px; color: var(--gray-500);">Benefits - All Channels</div>
                </div>
                <div style="display: flex; align-items: center; gap: 4px; font-size: 10px; color: var(--gusto-teal); font-weight: 500;">
                  <span style="width: 6px; height: 6px; background: var(--gusto-teal); border-radius: 50%;"></span>
                  Viewing
                </div>
              </div>
              <div class="activity-item" style="display: flex; align-items: center; gap: 12px; padding: 10px; border-radius: var(--radius-sm); background: var(--gray-50);">
                <div class="activity-avatar" style="width: 36px; height: 36px; border-radius: 50%; background: var(--success); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 12px;">AS</div>
                <div style="flex: 1;">
                  <div style="font-weight: 500; font-size: 13px;">Alex Smith</div>
                  <div style="font-size: 11px; color: var(--gray-500);">All-In View</div>
                </div>
                <div style="font-size: 10px; color: var(--gray-400);">
                  Idle 5m
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Version Control Panel - POPUP MODAL -->
        <div class="version-modal-overlay" id="versionPanel" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.3); z-index: 1000;" onclick="if(event.target === this) toggleVersionPanel()">
          <div class="version-modal" style="position: absolute; top: 80px; right: 20px; width: 380px; background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-xl); overflow: hidden; max-height: 80vh;">
            <div class="version-header" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: var(--gray-50); border-bottom: 1px solid var(--gray-200);">
              <div class="activity-title" style="font-weight: 600; font-size: 14px;">
                📚 Plan Versions & Scenarios
              </div>
              <button style="background: none; border: none; font-size: 18px; cursor: pointer; color: var(--gray-500);" onclick="toggleVersionPanel()">✕</button>
            </div>
            <div class="version-tabs" style="display: flex; border-bottom: 1px solid var(--gray-200);">
              <button class="version-tab active" onclick="showVersionType('published')" style="flex: 1; padding: 10px; border: none; background: white; cursor: pointer; font-size: 12px; font-weight: 500; border-bottom: 2px solid var(--gusto-teal);">Published Plans</button>
              <button class="version-tab" onclick="showVersionType('scenarios')" style="flex: 1; padding: 10px; border: none; background: var(--gray-50); cursor: pointer; font-size: 12px; color: var(--gray-500);">Scenarios</button>
            </div>
            <div class="version-list" id="publishedList" style="padding: 8px; max-height: 400px; overflow-y: auto;">
              <div class="version-item current" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: var(--radius-sm); background: var(--gusto-teal-light); margin-bottom: 6px; border-left: 3px solid var(--gusto-teal);">
                <span class="version-badge" style="background: var(--gusto-teal); color: white; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600;">Current</span>
                <div class="version-info" style="flex: 1;">
                  <div class="version-name" style="font-weight: 600; font-size: 13px;">FY25 Q4 Plan v3.2</div>
                  <div class="version-meta" style="font-size: 11px; color: var(--gray-500);">Published Dec 6, 2024 by Bunny B. • 51 HC</div>
                </div>
                <button class="table-action-btn" data-tooltip="View" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">👁️</button>
              </div>
              <div class="version-item" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: var(--radius-sm); background: var(--gray-50); margin-bottom: 6px;">
                <span class="version-badge" style="background: var(--success); color: white; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600;">Published</span>
                <div class="version-info" style="flex: 1;">
                  <div class="version-name" style="font-weight: 600; font-size: 13px;">FY25 Q4 Plan v3.1</div>
                  <div class="version-meta" style="font-size: 11px; color: var(--gray-500);">Published Dec 2, 2024 by Bunny B. • 49 HC</div>
                </div>
                <div style="display: flex; gap: 4px;">
                  <button class="table-action-btn" data-tooltip="Compare" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">⚖️</button>
                  <button class="table-action-btn" data-tooltip="Restore" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">↩️</button>
                </div>
              </div>
              <div class="version-item" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: var(--radius-sm); background: var(--gray-50); margin-bottom: 6px;">
                <span class="version-badge" style="background: var(--success); color: white; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600;">Published</span>
                <div class="version-info" style="flex: 1;">
                  <div class="version-name" style="font-weight: 600; font-size: 13px;">FY25 Q3 Final</div>
                  <div class="version-meta" style="font-size: 11px; color: var(--gray-500);">Published Sep 30, 2024 by Admin • 47 HC</div>
                </div>
                <div style="display: flex; gap: 4px;">
                  <button class="table-action-btn" data-tooltip="Compare" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">⚖️</button>
                  <button class="table-action-btn" data-tooltip="Restore" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">↩️</button>
                </div>
              </div>
            </div>
            <div class="version-list" id="scenariosList" style="display: none; padding: 8px; max-height: 400px; overflow-y: auto;">
              <div class="version-item" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: var(--radius-sm); background: var(--gray-50); margin-bottom: 6px;">
                <span class="version-badge" style="background: var(--gusto-coral); color: white; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600;">Draft</span>
                <div class="version-info" style="flex: 1;">
                  <div class="version-name" style="font-weight: 600; font-size: 13px;">+10% Volume Q1 Test</div>
                  <div class="version-meta" style="font-size: 11px; color: var(--gray-500);">Created Dec 6, 2024 • 56 HC (+5)</div>
                </div>
                <div style="display: flex; gap: 4px;">
                  <button class="table-action-btn" data-tooltip="Load scenario" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">📥</button>
                  <button class="table-action-btn" data-tooltip="Delete" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">🗑️</button>
                </div>
              </div>
              <div class="version-item" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: var(--radius-sm); background: var(--gray-50); margin-bottom: 6px;">
                <span class="version-badge" style="background: var(--gusto-coral); color: white; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600;">Draft</span>
                <div class="version-info" style="flex: 1;">
                  <div class="version-name" style="font-weight: 600; font-size: 13px;">Reduced Shrink Scenario</div>
                  <div class="version-meta" style="font-size: 11px; color: var(--gray-500);">Created Dec 5, 2024 • 48 HC (-3)</div>
                </div>
                <div style="display: flex; gap: 4px;">
                  <button class="table-action-btn" data-tooltip="Load scenario" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">📥</button>
                  <button class="table-action-btn" data-tooltip="Delete" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">🗑️</button>
                </div>
              </div>
              <div class="version-item" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: var(--radius-sm); background: #FEF3C7; margin-bottom: 6px; border-left: 3px solid var(--warning);">
                <span class="version-badge" style="background: var(--warning); color: var(--gray-800); padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600;">Working</span>
                <div class="version-info" style="flex: 1;">
                  <div class="version-name" style="font-weight: 600; font-size: 13px;">Current Draft (Unsaved)</div>
                  <div class="version-meta" style="font-size: 11px; color: var(--gray-500);">Modified just now • 51 HC</div>
                </div>
                <div style="display: flex; gap: 4px;">
                  <button class="table-action-btn" data-tooltip="Save as scenario" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">💾</button>
                  <button class="table-action-btn" data-tooltip="Discard changes" style="padding: 6px; border: none; background: white; border-radius: 4px; cursor: pointer;">🗑️</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Export Panel - POPUP MODAL -->
        <div class="export-modal-overlay" id="exportPanel" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.3); z-index: 1000;" onclick="if(event.target === this) toggleExportPanel()">
          <div class="export-modal" style="position: absolute; top: 80px; right: 20px; width: 320px; background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-xl); overflow: hidden;">
            <div class="export-header" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: var(--gray-50); border-bottom: 1px solid var(--gray-200);">
              <div style="font-weight: 600; font-size: 14px;">
                📥 Export Data
              </div>
              <button style="background: none; border: none; font-size: 18px; cursor: pointer; color: var(--gray-500);" onclick="toggleExportPanel()">✕</button>
            </div>
            <div style="padding: 16px;">
              <p style="font-size: 12px; color: var(--gray-600); margin-bottom: 16px;">Choose export format and data range:</p>
              
              <div style="margin-bottom: 12px;">
                <label style="font-size: 11px; font-weight: 500; color: var(--gray-700); display: block; margin-bottom: 4px;">Format</label>
                <select style="width: 100%; padding: 8px; border: 1px solid var(--gray-200); border-radius: 4px; font-size: 12px;">
                  <option>CSV - Spreadsheet</option>
                  <option>PDF - Report</option>
                  <option>Excel (.xlsx)</option>
                  <option>JSON - Data</option>
                </select>
              </div>
              
              <div style="margin-bottom: 12px;">
                <label style="font-size: 11px; font-weight: 500; color: var(--gray-700); display: block; margin-bottom: 4px;">Include</label>
                <div style="display: flex; flex-direction: column; gap: 6px;">
                  <label style="display: flex; align-items: center; gap: 8px; font-size: 11px; cursor: pointer;">
                    <input type="checkbox" checked> Staffing Model
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px; font-size: 11px; cursor: pointer;">
                    <input type="checkbox" checked> Channel Tables
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px; font-size: 11px; cursor: pointer;">
                    <input type="checkbox" checked> Overlay Settings
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px; font-size: 11px; cursor: pointer;">
                    <input type="checkbox"> Plan Notes
                  </label>
                </div>
              </div>
              
              <div style="margin-bottom: 16px;">
                <label style="font-size: 11px; font-weight: 500; color: var(--gray-700); display: block; margin-bottom: 4px;">Date Range</label>
                <select style="width: 100%; padding: 8px; border: 1px solid var(--gray-200); border-radius: 4px; font-size: 12px;">
                  <option>All 24 months</option>
                  <option>Current FY (May 25 - Apr 26)</option>
                  <option>Q1 Only</option>
                  <option>Q2 Only</option>
                  <option>Custom Range...</option>
                </select>
              </div>
              
              <div style="display: flex; gap: 8px;">
                <button onclick="toggleExportPanel()" style="flex: 1; padding: 10px; border: 1px solid var(--gray-200); background: white; border-radius: 6px; font-size: 12px; cursor: pointer;">Cancel</button>
                <button onclick="showToast('📥 Exporting...', 'success'); toggleExportPanel();" style="flex: 1; padding: 10px; border: none; background: var(--gusto-teal); color: white; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">Export</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ═══════════════════════════════════════════════════════════════
             VIEW: CONTROL PANEL - MODERN DASHBOARD LAYOUT
             ═══════════════════════════════════════════════════════════════ -->
        <div id="view-controlpanel" class="view-container" style="display: none;">
          <div style="max-width: 1400px; margin: 0 auto;">
            
            <!-- Header Row -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-lg);">
              <h2 style="display: flex; align-items: center; gap: var(--space-sm); margin: 0;">
                🎛️ Control Panel
              </h2>
              <a href="#" style="display: flex; align-items: center; gap: 6px; color: var(--gusto-teal); text-decoration: none; font-size: 13px; font-weight: 500;">
                📖 Process Documentation →
              </a>
            </div>
            
            <!-- Quick Stats Row -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-md); margin-bottom: var(--space-lg);">
              <div style="background: white; border-radius: var(--radius-lg); padding: 16px 20px; border: 1px solid var(--gray-200); box-shadow: var(--shadow-sm); text-align: center;">
                <div style="width: 40px; height: 40px; background: var(--gusto-coral-light); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; margin: 0 auto 8px auto;">✏️</div>
                    <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; letter-spacing: 0.5px;">Active Editing</div>
                    <div style="font-size: 28px; font-weight: 700; color: var(--gusto-coral);">2</div>
                <div style="font-size: 11px; color: var(--gray-500); margin-top: 4px;">Benefits, PAC in progress</div>
              </div>
              <div style="background: white; border-radius: var(--radius-lg); padding: 16px 20px; border: 1px solid var(--gray-200); box-shadow: var(--shadow-sm); text-align: center;">
                <div style="width: 40px; height: 40px; background: var(--gusto-teal-light); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; margin: 0 auto 8px auto;">📊</div>
                    <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; letter-spacing: 0.5px;">Total Pillars</div>
                    <div style="font-size: 28px; font-weight: 700; color: var(--gusto-teal);">6</div>
                <div style="font-size: 11px; color: var(--gray-500); margin-top: 4px;">18 channels total</div>
              </div>
              <div style="background: white; border-radius: var(--radius-lg); padding: 16px 20px; border: 1px solid var(--gray-200); box-shadow: var(--shadow-sm); text-align: center;">
                <div style="width: 40px; height: 40px; background: var(--warning-bg); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; margin: 0 auto 8px auto;">⚠️</div>
                    <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; letter-spacing: 0.5px;">Unsaved Changes</div>
                    <div style="font-size: 28px; font-weight: 700; color: var(--warning);">5</div>
                <div style="font-size: 11px; color: var(--gray-500); margin-top: 4px;">Across 2 pillars</div>
              </div>
              <div style="background: white; border-radius: var(--radius-lg); padding: 16px 20px; border: 1px solid var(--gray-200); box-shadow: var(--shadow-sm); text-align: center;">
                <div style="width: 40px; height: 40px; background: var(--success-bg); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; margin: 0 auto 8px auto;">👥</div>
                    <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; letter-spacing: 0.5px;">Active Users</div>
                    <div style="font-size: 28px; font-weight: 700; color: var(--success);">2</div>
                <div style="font-size: 11px; color: var(--gray-500); margin-top: 4px;">Online now</div>
              </div>
            </div>
            
            <!-- Alerts Section -->
            <div style="background: var(--warning-bg); border: 1px solid var(--warning); border-radius: var(--radius-md); padding: 12px 16px; margin-bottom: var(--space-lg); display: flex; align-items: center; gap: 12px;">
              <span style="font-size: 20px;">🔔</span>
              <div style="flex: 1;">
                <strong style="color: var(--gray-800);">1 Alert:</strong>
                <span style="color: var(--gray-600);"> PAC pillar is missing baseline forecast data for Q2 2025.</span>
              </div>
              <button style="background: white; border: 1px solid var(--warning); padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;" onclick="selectPillar('PAC')">View PAC →</button>
            </div>
            
            <!-- Main Content Grid: Pillar Table + Sidebar -->
            <div style="display: grid; grid-template-columns: 1fr 340px; gap: var(--space-lg); margin-bottom: var(--space-lg);">
              
              <!-- LEFT: Pillar Status Table -->
              <div class="table-section" style="margin: 0;">
                <div class="table-header">
                  <div class="table-title">
                    <div class="table-title-icon">📊</div>
                    <span>Pillar Status Overview</span>
                  </div>
                  <div class="table-actions">
                    <button class="btn btn-primary" onclick="openModal('createPillar')" style="font-size: 12px;">➕ Add Pillar</button>
                  </div>
                </div>
                <div class="data-grid">
                  <table class="data-table" style="font-size: 13px; width: 100%;">
                    <thead>
                      <tr>
                        <th style="width: 140px; text-align: center;">Pillar</th>
                        <th style="width: 100px; text-align: center;">Org</th>
                        <th style="width: 110px; text-align: center;">Status</th>
                        <th style="width: 60px; text-align: center;">HC</th>
                        <th style="width: 50px; text-align: center;">Pub</th>
                        <th style="width: 50px; text-align: center;">Scn</th>
                        <th style="width: 90px; text-align: center;">Updated</th>
                        <th style="width: 100px; text-align: center;">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td style="text-align: center;"><a href="#" onclick="selectPillar('Accountant'); return false;" style="color: var(--gusto-teal); text-decoration: none; font-weight: 600;">Accountant</a></td>
                        <td style="font-size: 11px; color: var(--gray-500); text-align: center;">On-Demand</td>
                        <td style="text-align: center;"><span style="background: var(--success-bg); color: var(--success); padding: 2px 8px; border-radius: 12px; font-size: 11px;">🟢 Ready</span></td>
                        <td style="text-align: center; font-weight: 600;">51</td>
                        <td style="text-align: center;">3</td>
                        <td style="text-align: center;">2</td>
                        <td style="font-size: 11px; text-align: center;">Dec 6</td>
                        <td style="text-align: center;">
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 8px;" onclick="selectPillar('Accountant')">View Pillar</button>
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 6px;" onclick="openEditPillarModal('Accountant', 'On-Demand')" data-tooltip="Edit name, org, channels & owner">⚙️</button>
                        </td>
                      </tr>
                      <tr style="background: #FEF3C7;">
                        <td style="text-align: center;"><a href="#" onclick="selectPillar('Benefits'); return false;" style="color: var(--gusto-teal); text-decoration: none; font-weight: 600;">Benefits</a></td>
                        <td style="font-size: 11px; color: var(--gray-500); text-align: center;">On-Demand</td>
                        <td style="text-align: center;"><span style="background: var(--warning-bg); color: var(--warning); padding: 2px 8px; border-radius: 12px; font-size: 11px;">🟡 Editing</span></td>
                        <td style="text-align: center; font-weight: 600;">78</td>
                        <td style="text-align: center;">2</td>
                        <td style="text-align: center;">5</td>
                        <td style="font-size: 11px; text-align: center;">Dec 6</td>
                        <td style="text-align: center;">
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 8px;" onclick="selectPillar('Benefits')">View Pillar</button>
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 6px;" onclick="openEditPillarModal('Benefits', 'On-Demand')" data-tooltip="Edit name, org, channels & owner">⚙️</button>
                        </td>
                      </tr>
                      <tr style="background: #FEE2E2;">
                        <td style="text-align: center;"><a href="#" onclick="selectPillar('PAC'); return false;" style="color: var(--gusto-teal); text-decoration: none; font-weight: 600;">PAC</a></td>
                        <td style="font-size: 11px; color: var(--gray-500); text-align: center;">Adv Care</td>
                        <td style="text-align: center;"><span style="background: var(--error-bg); color: var(--error); padding: 2px 8px; border-radius: 12px; font-size: 11px;">🔴 Missing</span></td>
                        <td style="text-align: center; color: var(--gray-400);">--</td>
                        <td style="text-align: center;">1</td>
                        <td style="text-align: center;">0</td>
                        <td style="font-size: 11px; text-align: center;">Dec 4</td>
                        <td style="text-align: center;">
                          <button class="btn btn-coral" style="font-size: 10px; padding: 3px 8px;" onclick="selectPillar('PAC')">Setup Pillar</button>
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 6px;" onclick="openEditPillarModal('PAC', 'Adv Care')" data-tooltip="Edit name, org, channels & owner">⚙️</button>
                        </td>
                      </tr>
                      <tr>
                        <td style="text-align: center;"><a href="#" onclick="selectPillar('Payroll'); return false;" style="color: var(--gusto-teal); text-decoration: none; font-weight: 600;">Payroll</a></td>
                        <td style="font-size: 11px; color: var(--gray-500); text-align: center;">On-Demand</td>
                        <td style="text-align: center;"><span style="background: var(--success-bg); color: var(--success); padding: 2px 8px; border-radius: 12px; font-size: 11px;">🟢 Ready</span></td>
                        <td style="text-align: center; font-weight: 600;">124</td>
                        <td style="text-align: center;">4</td>
                        <td style="text-align: center;">3</td>
                        <td style="font-size: 11px; text-align: center;">Dec 5</td>
                        <td style="text-align: center;">
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 8px;" onclick="selectPillar('Payroll')">View Pillar</button>
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 6px;" onclick="openEditPillarModal('Payroll', 'On-Demand')" data-tooltip="Edit name, org, channels & owner">⚙️</button>
                        </td>
                      </tr>
                      <tr>
                        <td style="text-align: center;"><a href="#" onclick="selectPillar('Premier'); return false;" style="color: var(--gusto-teal); text-decoration: none; font-weight: 600;">Premier</a></td>
                        <td style="font-size: 11px; color: var(--gray-500); text-align: center;">On-Demand</td>
                        <td style="text-align: center;"><span style="background: var(--success-bg); color: var(--success); padding: 2px 8px; border-radius: 12px; font-size: 11px;">🟢 Ready</span></td>
                        <td style="text-align: center; font-weight: 600;">89</td>
                        <td style="text-align: center;">2</td>
                        <td style="text-align: center;">1</td>
                        <td style="font-size: 11px; text-align: center;">Dec 5</td>
                        <td style="text-align: center;">
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 8px;" onclick="selectPillar('Premier')">View Pillar</button>
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 6px;" onclick="openEditPillarModal('Premier', 'On-Demand')" data-tooltip="Edit name, org, channels & owner">⚙️</button>
                        </td>
                      </tr>
                      <tr style="background: var(--gray-50);">
                        <td style="text-align: center;"><span style="font-weight: 600; color: var(--gray-500);">DSA</span></td>
                        <td style="font-size: 11px; color: var(--gray-500); text-align: center;">Special</td>
                        <td style="text-align: center;"><span style="background: var(--info-bg); color: var(--info); padding: 2px 8px; border-radius: 12px; font-size: 11px;">🔵 Overlay</span></td>
                        <td style="text-align: center; font-weight: 600;">42</td>
                        <td style="text-align: center;">1</td>
                        <td style="text-align: center;">0</td>
                        <td style="font-size: 11px; text-align: center;">Dec 6</td>
                        <td style="text-align: center;">
                          <button class="btn btn-secondary" style="font-size: 10px; padding: 3px 8px;" onclick="openEditPillarModal('DSA', 'Special')">Config</button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              
              <!-- RIGHT: Sidebar Cards -->
              <div style="display: flex; flex-direction: column; gap: var(--space-md);">
                
                <!-- Active Users Card -->
                <div style="background: white; border-radius: var(--radius-lg); border: 1px solid var(--gray-200); overflow: hidden;">
                  <div style="padding: 12px 16px; background: var(--gray-50); border-bottom: 1px solid var(--gray-200); font-weight: 600; font-size: 13px; display: flex; align-items: center; gap: 8px;">
                    👥 Active Users
                    <span style="background: var(--success); color: white; padding: 1px 6px; border-radius: 10px; font-size: 10px; margin-left: auto;">2 online</span>
                  </div>
                  <div style="padding: 12px;">
                    <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: var(--gray-50); border-radius: 8px; margin-bottom: 8px;">
                      <div style="width: 32px; height: 32px; background: var(--gusto-teal); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600;">BB</div>
                      <div style="flex: 1;">
                        <div style="font-weight: 500; font-size: 12px;">Bunny Bates</div>
                        <div style="font-size: 10px; color: var(--gray-500);">Accountant - Phone</div>
                      </div>
                      <span style="font-size: 10px; color: var(--gusto-coral); font-weight: 500;">✏️ Editing</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: var(--gray-50); border-radius: 8px;">
                      <div style="width: 32px; height: 32px; background: var(--gusto-coral); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600;">JD</div>
                      <div style="flex: 1;">
                        <div style="font-weight: 500; font-size: 12px;">John Doe</div>
                        <div style="font-size: 10px; color: var(--gray-500);">Benefits - All Channels</div>
                      </div>
                      <span style="font-size: 10px; color: var(--gusto-teal); font-weight: 500;">👁️ Viewing</span>
                    </div>
                  </div>
                </div>
                
                <!-- Admin Actions Card -->
                <div style="background: white; border-radius: var(--radius-lg); border: 1px solid var(--gray-200); overflow: hidden;">
                  <div style="padding: 12px 16px; background: var(--gray-50); border-bottom: 1px solid var(--gray-200); font-weight: 600; font-size: 13px;">
                    ⚙️ Admin Actions
                  </div>
                  <div style="padding: 8px;">
                    <button style="width: 100%; text-align: left; padding: 10px 12px; border: none; background: none; cursor: pointer; font-size: 12px; border-radius: 6px; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='var(--gray-50)'" onmouseout="this.style.background='none'">👥 Manage Users & Permissions</button>
                    <button style="width: 100%; text-align: left; padding: 10px 12px; border: none; background: none; cursor: pointer; font-size: 12px; border-radius: 6px; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='var(--gray-50)'" onmouseout="this.style.background='none'">📅 Set Planning Timeline</button>
                    <button style="width: 100%; text-align: left; padding: 10px 12px; border: none; background: none; cursor: pointer; font-size: 12px; border-radius: 6px; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='var(--gray-50)'" onmouseout="this.style.background='none'" onclick="openModal('scenarios')">🗂️ Manage Scenarios</button>
                    <button style="width: 100%; text-align: left; padding: 10px 12px; border: none; background: none; cursor: pointer; font-size: 12px; border-radius: 6px; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='var(--gray-50)'" onmouseout="this.style.background='none'" onclick="openModal('scenarios')">📋 Manage Published Plans</button>
                    <button style="width: 100%; text-align: left; padding: 10px 12px; border: none; background: none; cursor: pointer; font-size: 12px; border-radius: 6px; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='var(--gray-50)'" onmouseout="this.style.background='none'" onclick="toggleExportPanel()">📤 Export All Data</button>
                  </div>
                </div>
                
                <!-- Feedback Tracker Card -->
                <div style="background: white; border-radius: var(--radius-lg); border: 1px solid var(--gray-200); overflow: hidden;">
                  <div style="padding: 12px 16px; background: var(--gray-50); border-bottom: 1px solid var(--gray-200); font-weight: 600; font-size: 13px;">
                    📬 Feedback Tracker
                  </div>
                  <div style="padding: 12px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                    <div style="text-align: center; padding: 12px; background: #FEE2E2; border-radius: 8px;">
                      <div style="font-size: 20px; font-weight: 700; color: var(--error);">3</div>
                      <div style="font-size: 10px; color: var(--gray-600);">Open Bugs</div>
                    </div>
                    <div style="text-align: center; padding: 12px; background: #EDE9FE; border-radius: 8px;">
                      <div style="font-size: 20px; font-weight: 700; color: #7C3AED;">7</div>
                      <div style="font-size: 10px; color: var(--gray-600);">Feature Requests</div>
                    </div>
                  </div>
                </div>
                
              </div>
            </div>
            
            <!-- Bottom Section: Two Column Grid -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
              
              <!-- Data Sources Card -->
              <div class="table-section" style="margin: 0;">
                <div class="table-header" style="padding: 12px 16px;">
                  <div class="table-title" style="font-size: 13px;">
                    <div class="table-title-icon">📊</div>
                    <span>Data Sources</span>
                  </div>
                  <button class="btn btn-secondary" style="font-size: 11px; padding: 4px 10px;">🔄 Refresh</button>
                </div>
                <div style="padding: 0 12px 12px;">
                  <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: var(--gray-50); border-radius: 6px; margin-bottom: 6px;">
                    <div>
                      <div style="font-weight: 500; font-size: 12px;">📈 Baseline Forecast</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Dec 6 @ 3:45 PM • 580 records</div>
                    </div>
                    <span style="color: var(--success); font-size: 11px;">✅ Current</span>
                  </div>
                  <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: var(--gray-50); border-radius: 6px; margin-bottom: 6px;">
                    <div>
                      <div style="font-weight: 500; font-size: 12px;">👥 Active HC Data</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Dec 6 @ 3:42 PM • 999 records</div>
                    </div>
                    <span style="color: var(--success); font-size: 11px;">✅ Current</span>
                  </div>
                  <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: var(--gray-50); border-radius: 6px; opacity: 0.6;">
                    <div>
                      <div style="font-weight: 500; font-size: 12px;">📞 Contact Rate Forecast</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Not configured</div>
                    </div>
                    <button style="font-size: 10px; padding: 3px 8px; background: var(--gusto-teal); color: white; border: none; border-radius: 4px; cursor: pointer;">Configure</button>
                  </div>
                </div>
              </div>
              
              <!-- Recent Activity Card -->
              <div class="table-section" style="margin: 0;">
                <div class="table-header" style="padding: 12px 16px;">
                  <div class="table-title" style="font-size: 13px;">
                    <div class="table-title-icon">📜</div>
                    <span>Recent Activity</span>
                  </div>
                  <span style="font-size: 11px; color: var(--gray-500);">Last 24 hours</span>
                </div>
                <div style="padding: 0 12px 12px; max-height: 180px; overflow-y: auto;">
                  <div style="display: flex; gap: 10px; padding: 8px 0; border-bottom: 1px solid var(--gray-100);">
                    <div style="width: 6px; height: 6px; background: var(--gusto-teal); border-radius: 50%; margin-top: 6px;"></div>
                    <div>
                      <div style="font-size: 12px;"><strong>Bunny B.</strong> published Accountant plan v3.2</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Today at 2:15 PM</div>
                    </div>
                  </div>
                  <div style="display: flex; gap: 10px; padding: 8px 0; border-bottom: 1px solid var(--gray-100);">
                    <div style="width: 6px; height: 6px; background: var(--gusto-coral); border-radius: 50%; margin-top: 6px;"></div>
                    <div>
                      <div style="font-size: 12px;"><strong>John D.</strong> started editing Benefits</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Today at 1:42 PM</div>
                    </div>
                  </div>
                  <div style="display: flex; gap: 10px; padding: 8px 0; border-bottom: 1px solid var(--gray-100);">
                    <div style="width: 6px; height: 6px; background: var(--warning); border-radius: 50%; margin-top: 6px;"></div>
                    <div>
                      <div style="font-size: 12px;"><strong>System</strong> uploaded new forecast data</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Today at 11:30 AM</div>
                    </div>
                  </div>
                  <div style="display: flex; gap: 10px; padding: 8px 0;">
                    <div style="width: 6px; height: 6px; background: var(--success); border-radius: 50%; margin-top: 6px;"></div>
                    <div>
                      <div style="font-size: 12px;"><strong>Bunny B.</strong> saved scenario "+10% Volume Test"</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Yesterday at 4:20 PM</div>
                    </div>
                  </div>
                </div>
              </div>
              
            </div>
            
          </div>
        </div>
        
        <!-- ═══════════════════════════════════════════════════════════════
             VIEW: CUSTOMER CARE ALL-IN
             ═══════════════════════════════════════════════════════════════ -->
        <div id="view-allin" class="view-container" style="display: none;">
          <div style="display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-lg); flex-wrap: wrap;">
            <h2 style="display: flex; align-items: center; gap: var(--space-sm); margin: 0;">
              🔗 Customer Care - All In
            </h2>
            <select class="form-select" style="width: auto; font-size: 12px;">
              <option>May-2025</option>
              <option>Jun-2025</option>
              <option selected>Dec-2025</option>
            </select>
            <span style="font-size: 12px; color: var(--gray-500);">→ 24 months</span>
            <button class="btn btn-secondary" style="margin-left: auto;">📤 Export PDF</button>
          </div>
          
          <!-- All-In Summary Grid (same as Pillar view) -->
          <div class="pillar-summary-grid">
            <!-- LEFT: Key Metrics Quad -->
            <div class="summary-section" style="display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 10px;">
                <h3 style="font-size: 14px; margin: 0;">📊 Key Metrics</h3>
                <select id="allInStatCardMonth" onchange="updateAllStatCardMonths(this.value)" class="month-select" style="font-size: 11px; padding: 3px 8px; border: 1px solid var(--gray-200); border-radius: 4px;">
                  <option value="Dec-24">Dec-24</option><option value="Jan-25">Jan-25</option><option value="Feb-25">Feb-25</option>
                  <option value="Mar-25">Mar-25</option><option value="Apr-25">Apr-25</option><option value="May-25" selected>May-25</option>
                </select>
              </div>
              <div class="metrics-quad" style="margin-top: 10px;">
                <div class="metric-tile">
                  <div class="metric-label" style="font-size: 11px;">HC Need</div>
                  <div class="metric-value" style="font-size: 26px;">541</div>
                  <div class="metric-delta positive" style="font-size: 10px;">All Pillars</div>
                </div>
                <div class="metric-tile">
                  <div class="metric-label" style="font-size: 11px;">Net Staffing</div>
                  <div class="metric-value" style="font-size: 26px; color: var(--error);">-227</div>
                  <div class="metric-delta negative" style="font-size: 10px;">Understaffed</div>
                </div>
                <div class="metric-tile">
                  <div class="metric-label" style="font-size: 11px;">Actual HC</div>
                  <div class="metric-value" style="font-size: 26px;">596</div>
                  <div class="metric-delta" style="font-size: 10px;">Current</div>
                </div>
                <div class="metric-tile">
                  <div class="metric-label" style="font-size: 11px;">Active Pillars</div>
                  <div class="metric-value" style="font-size: 26px; color: var(--success);">9</div>
                  <div class="metric-delta positive" style="font-size: 10px;">All Synced</div>
                </div>
              </div>
            </div>
            
            <!-- CENTER: Trend Chart -->
            <div class="summary-section" style="display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 10px;">
                <h3 style="font-size: 14px; margin: 0;">📈 Trend</h3>
                <select id="allInTrendMetric" onchange="updateAllInTrendChart(this.value)" style="font-size: 11px; padding: 3px 8px; border: 1px solid var(--gray-200); border-radius: 4px;">
                  <option value="hc">HC Need vs Actual</option>
                  <option value="volume">Total Volume</option>
                  <option value="staffing">Net Staffing</option>
                </select>
                <button onclick="expandChart()" style="background: none; border: none; cursor: pointer; font-size: 14px; margin-left: auto;" data-tooltip="Expand chart">⛶</button>
              </div>
              <div class="trend-chart-container" style="flex: 1; padding: 4px 8px; min-height: 100px;">
                <svg viewBox="0 0 530 150" style="width: 100%; height: 100%;">
                  <!-- Grid lines -->
                  <g stroke="#e5e7eb" stroke-width="0.5">
                    <line x1="40" y1="20" x2="520" y2="20"/>
                    <line x1="40" y1="50" x2="520" y2="50"/>
                    <line x1="40" y1="80" x2="520" y2="80"/>
                    <line x1="40" y1="110" x2="520" y2="110"/>
                  </g>
                  <!-- Y-axis labels -->
                  <g fill="#9ca3af" font-size="8">
                    <text x="35" y="23" text-anchor="end">600</text>
                    <text x="35" y="53" text-anchor="end">500</text>
                    <text x="35" y="83" text-anchor="end">400</text>
                    <text x="35" y="113" text-anchor="end">300</text>
                  </g>
                  <!-- HC Need line (all pillars) -->
                  <polyline id="allInChartLine1" fill="none" stroke="var(--gusto-teal)" stroke-width="2" points="45,85 85,80 125,75 165,65 205,55 245,45 285,50 325,55 365,60 405,65 445,70 485,75"/>
                  <!-- Actual HC line -->
                  <polyline id="allInChartLine2" fill="none" stroke="var(--gusto-coral)" stroke-width="2" stroke-dasharray="4,2" points="45,95 85,93 125,90 165,88 205,85 245,80 285,78 325,82 365,85 405,88 445,90 485,92"/>
                  <!-- X-axis month labels -->
                  <g fill="#9ca3af" font-size="7" text-anchor="middle">
                    <text x="45" y="130">Dec</text>
                    <text x="85" y="130">Jan</text>
                    <text x="125" y="130">Feb</text>
                    <text x="165" y="130">Mar</text>
                    <text x="205" y="130">Apr</text>
                    <text x="245" y="130">May</text>
                    <text x="285" y="130">Jun</text>
                    <text x="325" y="130">Jul</text>
                    <text x="365" y="130">Aug</text>
                    <text x="405" y="130">Sep</text>
                    <text x="445" y="130">Oct</text>
                    <text x="485" y="130">Nov</text>
                  </g>
                  <text id="allInChartTitle" x="265" y="145" text-anchor="middle" font-size="9" fill="#666" font-weight="500">HC Need vs Actual HC (All Pillars)</text>
                </svg>
                <!-- Legend -->
                <div class="chart-legend" style="display: flex; justify-content: center; gap: 16px; margin-top: 2px;">
                  <div class="legend-item" style="display: flex; align-items: center; gap: 4px; font-size: 9px;">
                    <span style="width: 16px; height: 2px; background: var(--gusto-teal);"></span>
                    <span>HC Need</span>
                  </div>
                  <div class="legend-item" style="display: flex; align-items: center; gap: 4px; font-size: 9px;">
                    <span style="width: 16px; height: 2px; background: var(--gusto-coral); border-style: dashed;"></span>
                    <span>Actual HC</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- RIGHT: Key Insights (Auto-Generated) -->
            <div class="summary-section" style="background: linear-gradient(135deg, #F0FDF4 0%, #DCFCE7 100%); border-radius: 12px; padding: 12px; border: 1px solid #BBF7D0; display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
                <span style="font-size: 14px;">🔮</span>
                <span style="font-weight: 600; font-size: 12px; color: #166534;">Org Insights</span>
                <span style="font-size: 8px; background: #22C55E; color: white; padding: 2px 5px; border-radius: 3px;">AUTO</span>
                <div style="margin-left: auto; display: flex; gap: 4px;">
                  <button class="table-action-btn" data-tooltip="Pop out" onclick="popOutAllInInsights()" style="font-size: 10px; padding: 4px;">⤢</button>
                  <button class="table-action-btn" data-tooltip="Save" style="font-size: 10px; padding: 4px;">💾</button>
              </div>
                    </div>
              
              <div style="flex: 1; display: flex; flex-direction: column; gap: 6px; overflow-y: auto;" id="allInInsights">
                <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                  <span>📞</span>
                  <span style="color: var(--gray-700); line-height: 1.4;" contenteditable="true"><strong>Phone</strong> understaffed by 12 HC in Dec-25 peak.</span>
                  </div>
                <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                  <span>💬</span>
                  <span style="color: var(--gray-700); line-height: 1.4;" contenteditable="true"><strong>Chat</strong> balanced — slight surplus expected Q2.</span>
                </div>
                <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                  <span>📧</span>
                  <span style="color: var(--gray-700); line-height: 1.4;" contenteditable="true"><strong>Email</strong> gap narrowing due to efficiency gains.</span>
                  </div>
                <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                  <span>💡</span>
                  <span style="color: var(--gray-700); line-height: 1.4;" contenteditable="true"><strong>Rec:</strong> Reallocate 3 FTE from Chat to Phone for Q4.</span>
                  </div>
                </div>
              
              <div style="margin-top: 8px; display: flex; gap: 6px;">
                <button onclick="addAllInInsight()" style="flex: 1; background: none; border: 1px dashed #22C55E; border-radius: 4px; padding: 5px 8px; font-size: 10px; color: #166534; cursor: pointer;">
                  + Add
                </button>
                <button onclick="popOutAllInInsights()" style="flex: 1; background: #22C55E; border: none; border-radius: 4px; padding: 5px 8px; font-size: 10px; color: white; cursor: pointer;">
                  ⤢ Expand
                </button>
              </div>
            </div>
          </div>
          
          <!-- Plan Status Footer Bar -->
          <div class="plan-status-footer" style="display: flex; justify-content: space-between; align-items: center; padding: 6px 12px; background: var(--gray-50); border-radius: var(--radius-sm); margin-bottom: var(--space-sm); font-size: 10px; border: 1px solid var(--gray-100);">
            <div style="display: flex; gap: 16px; align-items: center;">
              <span style="color: var(--gray-500);">💾 Last Saved: <strong style="color: var(--gray-700);">Today 3:45 PM</strong></span>
              <span style="color: var(--gray-500);">📋 Published: <strong style="color: var(--success);">Dec 6</strong></span>
              <span style="color: var(--gray-500);">📚 Scenarios: <strong style="color: var(--gray-700);">2 saved</strong></span>
            </div>
            <div style="display: flex; gap: 8px; align-items: center;">
              <span style="color: var(--success); font-weight: 500;">✓ All synced</span>
              <button style="padding: 4px 10px; font-size: 9px; background: var(--gusto-teal); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">💾 Save All-In</button>
            </div>
          </div>
          
          <!-- All-In Table -->
          <div class="table-section" style="flex: 1; display: flex; flex-direction: column;">
            <div class="table-header" style="padding: 10px 16px;">
              <div class="table-title" style="display: flex; align-items: center; gap: 12px;">
                <div class="table-title-icon">📊</div>
                <span>Customer Care Staffing Summary</span>
                <!-- Channel Multi-Select -->
                <div class="multi-select" id="allInChannelSelect" style="margin-left: 8px;">
                  <div class="multi-select-trigger" onclick="toggleMultiSelect('allInChannelSelect')" style="font-size: 11px; padding: 4px 10px; min-width: 100px;">
                    <span>All Channels</span>
                  </div>
                  <div class="multi-select-dropdown" style="min-width: 140px;">
                    <label class="multi-select-item select-all" style="font-size: 11px;">
                      <input type="checkbox" checked onchange="toggleAllInMultiSelect('allInChannelSelect', this); filterAllInData();"> Select All
                    </label>
                    <label class="multi-select-item" style="font-size: 11px;">
                      <input type="checkbox" value="phone" checked onchange="filterAllInData()"> 📞 Phone
                    </label>
                    <label class="multi-select-item" style="font-size: 11px;">
                      <input type="checkbox" value="chat" checked onchange="filterAllInData()"> 💬 Chat
                    </label>
                    <label class="multi-select-item" style="font-size: 11px;">
                      <input type="checkbox" value="email" checked onchange="filterAllInData()"> 📧 Email
                    </label>
                  </div>
                </div>
                <!-- Organization Multi-Select -->
                <div class="multi-select" id="allInOrgSelect">
                  <div class="multi-select-trigger" onclick="toggleMultiSelect('allInOrgSelect')" style="font-size: 11px; padding: 4px 10px; min-width: 110px;">
                    <span>All Orgs</span>
                  </div>
                  <div class="multi-select-dropdown" style="min-width: 150px;">
                    <label class="multi-select-item select-all" style="font-size: 11px;">
                      <input type="checkbox" checked onchange="toggleAllInMultiSelect('allInOrgSelect', this); filterAllInData();"> Select All
                    </label>
                    <label class="multi-select-item" style="font-size: 11px;">
                      <input type="checkbox" value="ondemand" checked onchange="filterAllInData()"> On-Demand
                    </label>
                    <label class="multi-select-item" style="font-size: 11px;">
                      <input type="checkbox" value="advanced" checked onchange="filterAllInData()"> Advanced Care
                    </label>
                    <label class="multi-select-item" style="font-size: 11px;">
                      <input type="checkbox" value="dsa" checked onchange="filterAllInData()"> DSA
                    </label>
                  </div>
                </div>
                <label style="display: flex; align-items: center; gap: 4px; font-size: 11px; color: var(--gray-600); margin-left: 8px;">
                  <input type="checkbox" id="showOverlaysToggle" style="width: 14px; height: 14px;" onchange="toggleOverlaysVisibility(this.checked)" checked> Show Overlays
                </label>
              </div>
              <div class="table-actions">
                <button class="table-action-btn" data-tooltip="Refresh data">🔄</button>
                <button class="table-action-btn" data-tooltip="Export data">📥</button>
              </div>
            </div>
            
            <!-- STICKY OVERLAY IMPACT BAR -->
            <div id="overlayImpactBar" style="position: sticky; top: 0; z-index: 40; background: linear-gradient(135deg, var(--gusto-coral-light) 0%, #FFF5F3 100%); border: 1px solid var(--gusto-coral); border-radius: 8px; padding: 10px 16px; margin-bottom: 8px; display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 16px;">🎯</span>
                <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Active Overlays:</span>
                <span style="background: var(--gusto-coral); color: white; padding: 2px 10px; border-radius: 12px; font-size: 12px; font-weight: 600;">12</span>
              </div>
              <div style="height: 20px; width: 1px; background: var(--gray-300);"></div>
              <div style="display: flex; align-items: center; gap: 6px; font-size: 12px;">
                <span style="color: var(--gray-600);">HC Impact:</span>
                <span style="color: var(--error); font-weight: 700;">+38</span>
              </div>
              <div style="height: 20px; width: 1px; background: var(--gray-300);"></div>
              <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                <span style="background: var(--gusto-teal-light); color: var(--gusto-teal-dark); padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 500; cursor: pointer;" onclick="showPillarOverlays('Payroll')" title="Click to see details">Payroll +15</span>
                <span style="background: var(--gusto-teal-light); color: var(--gusto-teal-dark); padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 500; cursor: pointer;" onclick="showPillarOverlays('Benefits')" title="Click to see details">Benefits +18</span>
                <span style="background: #D1FAE5; color: #065F46; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 500; cursor: pointer;" onclick="showPillarOverlays('PAC')" title="Click to see details">PAC -5</span>
                <span style="background: var(--gray-100); color: var(--gray-600); padding: 3px 10px; border-radius: 12px; font-size: 11px; cursor: pointer;" onclick="toggleOverlayPanel()">+3 more →</span>
              </div>
              <button onclick="toggleOverlayPanel()" style="margin-left: auto; background: white; border: 1px solid var(--gusto-coral); color: var(--gusto-coral); padding: 6px 12px; border-radius: 6px; font-size: 11px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 4px;">
                📋 View All Overlays
              </button>
            </div>
            
            <div class="data-grid compact-24" style="flex: 1; min-height: 400px;">
              <table class="data-table">
                <thead>
                  <!-- Quarter Row -->
                  <tr style="background: var(--gusto-teal-dark);">
                    <th style="min-width: 160px; position: sticky; left: 0; background: var(--gusto-teal-dark); z-index: 31; color: white;">Metric</th>
                    <th colspan="3" class="quarter-header" onclick="toggleQuarter(1)" style="cursor: pointer;">Q1 FY26 ▼</th>
                    <th colspan="3" class="quarter-header" onclick="toggleQuarter(2)" style="cursor: pointer;">Q2 FY26 ▼</th>
                    <th colspan="3" class="quarter-header" onclick="toggleQuarter(3)" style="cursor: pointer;">Q3 FY26 ▼</th>
                    <th colspan="3" class="quarter-header" onclick="toggleQuarter(4)" style="cursor: pointer;">Q4 FY26 ▼</th>
                    <th colspan="3" class="quarter-header" onclick="toggleQuarter(5)" style="cursor: pointer;">Q1 FY27 ▼</th>
                    <th colspan="3" class="quarter-header" onclick="toggleQuarter(6)" style="cursor: pointer;">Q2 FY27 ▼</th>
                    <th colspan="3" class="quarter-header" onclick="toggleQuarter(7)" style="cursor: pointer;">Q3 FY27 ▼</th>
                    <th colspan="3" class="quarter-header" onclick="toggleQuarter(8)" style="cursor: pointer;">Q4 FY27 ▼</th>
                  </tr>
                  <!-- Month Row -->
                  <tr>
                    <th style="min-width: 120px; position: sticky; left: 0; background: var(--gray-100); z-index: 30;"></th>
                    <!-- Q1 FY26 -->
                    <th class="q1-month">May-25</th>
                    <th class="q1-month">Jun-25</th>
                    <th class="q1-month">Jul-25</th>
                    <!-- Q2 FY26 -->
                    <th class="q2-month">Aug-25</th>
                    <th class="q2-month">Sep-25</th>
                    <th class="q2-month">Oct-25</th>
                    <!-- Q3 FY26 -->
                    <th class="q3-month">Nov-25</th>
                    <th class="q3-month">Dec-25</th>
                    <th class="q3-month">Jan-26</th>
                    <!-- Q4 FY26 -->
                    <th class="q4-month">Feb-26</th>
                    <th class="q4-month">Mar-26</th>
                    <th class="q4-month">Apr-26</th>
                    <!-- Q1 FY27 -->
                    <th class="q5-month">May-26</th>
                    <th class="q5-month">Jun-26</th>
                    <th class="q5-month">Jul-26</th>
                    <!-- Q2 FY27 -->
                    <th class="q6-month">Aug-26</th>
                    <th class="q6-month">Sep-26</th>
                    <th class="q6-month">Oct-26</th>
                    <!-- Q3 FY27 -->
                    <th class="q7-month">Nov-26</th>
                    <th class="q7-month">Dec-26</th>
                    <th class="q7-month">Jan-27</th>
                    <!-- Q4 FY27 -->
                    <th class="q8-month">Feb-27</th>
                    <th class="q8-month">Mar-27</th>
                    <th class="q8-month">Apr-27</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- ═══════════ VOLUME SECTION ═══════════ -->
                  <tr class="row-section-header collapsible" onclick="toggleAllInSection(this)" style="cursor: pointer;">
                    <td colspan="25">📈 Volume - Active (by Channel) <span style="float: right; font-size: 10px;">▼</span></td>
                  </tr>
                  <tr class="allin-volume-section" style="font-weight: 700; background: var(--gusto-teal-light); cursor: pointer;" onclick="toggleSubsection(this, 'volume-channel-sub')">
                    <td style="position: sticky; left: 0; background: var(--gusto-teal-light);"><strong>Volume - Total</strong> <span class="subsection-arrow" style="font-size: 10px; margin-left: 4px;">▼</span></td>
                    <td>202,950</td><td>188,577</td><td>215,728</td><td>199,358</td><td>216,728</td><td>235,582</td><td>220,170</td><td>304,892</td><td>375,464</td><td>285,587</td><td>269,387</td><td>262,407</td>
                    <td>209,830</td><td>195,000</td><td>222,900</td><td>205,900</td><td>223,800</td><td>243,200</td><td>227,400</td><td>314,900</td><td>387,700</td><td>295,000</td><td>278,200</td><td>271,000</td>
                  </tr>
                  <tr class="allin-volume-section volume-channel-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ 📞 Phone</td>
                    <td>71,653</td><td>72,548</td><td>81,229</td><td>75,764</td><td>78,435</td><td>83,964</td><td>74,102</td><td>114,183</td><td>133,581</td><td>95,876</td><td>91,971</td><td>92,645</td>
                    <td>74,230</td><td>75,100</td><td>84,000</td><td>78,300</td><td>81,000</td><td>86,700</td><td>76,600</td><td>118,000</td><td>138,000</td><td>99,100</td><td>95,000</td><td>95,700</td>
                  </tr>
                  <tr class="allin-volume-section volume-channel-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ 💬 Chat</td>
                    <td>56,413</td><td>47,484</td><td>55,869</td><td>47,912</td><td>51,033</td><td>62,492</td><td>71,173</td><td>101,779</td><td>129,843</td><td>100,517</td><td>91,839</td><td>86,841</td>
                    <td>58,300</td><td>49,100</td><td>57,700</td><td>49,500</td><td>52,700</td><td>64,500</td><td>73,500</td><td>105,100</td><td>134,000</td><td>103,800</td><td>94,800</td><td>89,700</td>
                  </tr>
                  <tr class="allin-volume-section volume-channel-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ 📧 Email</td>
                    <td>74,884</td><td>68,545</td><td>78,630</td><td>75,682</td><td>87,260</td><td>89,126</td><td>74,895</td><td>88,930</td><td>112,040</td><td>89,194</td><td>85,577</td><td>82,921</td>
                    <td>77,300</td><td>70,800</td><td>81,200</td><td>78,100</td><td>90,100</td><td>92,000</td><td>77,300</td><td>91,800</td><td>115,700</td><td>92,100</td><td>88,400</td><td>85,600</td>
                  </tr>
                  
                  <!-- ═══════════ AHT SECTION ═══════════ -->
                  <tr class="row-section-header collapsible" onclick="toggleAllInSection(this)" style="cursor: pointer;">
                    <td colspan="25">⏱️ Weighted AHT (by Channel) <span style="float: right; font-size: 10px;">▼</span></td>
                  </tr>
                  <tr class="allin-aht-section" style="font-weight: 700; background: var(--gusto-teal-light); cursor: pointer;" onclick="toggleSubsection(this, 'aht-channel-sub')">
                    <td style="position: sticky; left: 0; background: var(--gusto-teal-light);"><strong>Weighted AHT - All In</strong> <span class="subsection-arrow" style="font-size: 10px; margin-left: 4px;">▼</span></td>
                    <td>1,090</td><td>1,082</td><td>1,132</td><td>1,118</td><td>1,079</td><td>1,119</td><td>1,115</td><td>1,103</td><td>1,077</td><td>1,078</td><td>1,099</td><td>1,078</td>
                    <td>1,095</td><td>1,088</td><td>1,138</td><td>1,124</td><td>1,085</td><td>1,125</td><td>1,121</td><td>1,109</td><td>1,083</td><td>1,084</td><td>1,105</td><td>1,084</td>
                  </tr>
                  <tr class="allin-aht-section aht-channel-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ 📞 Phone AHT</td>
                    <td>839</td><td>835</td><td>843</td><td>863</td><td>871</td><td>880</td><td>902</td><td>873</td><td>813</td><td>818</td><td>846</td><td>835</td>
                    <td>841</td><td>837</td><td>845</td><td>865</td><td>873</td><td>882</td><td>904</td><td>875</td><td>815</td><td>820</td><td>848</td><td>837</td>
                  </tr>
                  <tr class="allin-aht-section aht-channel-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ 💬 Chat AHT</td>
                    <td>1,270</td><td>1,252</td><td>1,299</td><td>1,260</td><td>1,103</td><td>1,073</td><td>1,094</td><td>1,126</td><td>1,099</td><td>1,075</td><td>1,080</td><td>1,095</td>
                    <td>1,265</td><td>1,247</td><td>1,294</td><td>1,255</td><td>1,098</td><td>1,068</td><td>1,089</td><td>1,121</td><td>1,094</td><td>1,070</td><td>1,110</td><td>1,072</td>
                  </tr>
                  <tr class="allin-aht-section aht-channel-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ 📧 Email AHT</td>
                    <td>1,194</td><td>1,225</td><td>1,313</td><td>1,283</td><td>1,253</td><td>1,377</td><td>1,347</td><td>1,370</td><td>1,365</td><td>1,362</td><td>1,359</td><td>1,356</td>
                    <td>1,200</td><td>1,231</td><td>1,319</td><td>1,289</td><td>1,259</td><td>1,383</td><td>1,353</td><td>1,376</td><td>1,371</td><td>1,368</td><td>1,365</td><td>1,362</td>
                  </tr>
                  
                  <!-- ═══════════ HC NEED SECTION ═══════════ -->
                  <tr class="row-section-header collapsible" onclick="toggleAllInSection(this)" style="cursor: pointer;">
                    <td colspan="25">🎯 Active HC Need (Inc Overlays) <span style="float: right; font-size: 10px;">▼</span></td>
                  </tr>
                  <tr class="allin-hc-section" style="font-weight: 700; background: var(--gusto-teal-light); cursor: pointer;" onclick="toggleSubsection(this, 'hc-pillar-sub')">
                    <td style="position: sticky; left: 0; background: var(--gusto-teal-light);"><strong>Active HC Need - Total</strong> <span class="subsection-arrow" style="font-size: 10px; margin-left: 4px;">▼</span></td>
                    <td>541</td><td>535</td><td>574</td><td>577</td><td>613</td><td>635</td><td>779</td><td>817</td><td>1,056</td><td>929</td><td>802</td><td>795</td>
                    <td>559</td><td>553</td><td>593</td><td>596</td><td>633</td><td>656</td><td>805</td><td>844</td><td>1,091</td><td>960</td><td>829</td><td>822</td>
                  </tr>
                  <tr class="allin-hc-section hc-pillar-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ On-Demand</td>
                    <td>456</td><td>445</td><td>478</td><td>479</td><td>501</td><td>503</td><td>643</td><td>691</td><td>902</td><td>782</td><td>658</td><td>648</td>
                    <td>471</td><td>460</td><td>494</td><td>495</td><td>518</td><td>520</td><td>664</td><td>714</td><td>932</td><td>808</td><td>680</td><td>670</td>
                  </tr>
                  <tr class="allin-hc-section hc-pillar-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ Advanced Care</td>
                    <td>43</td><td>47</td><td>51</td><td>51</td><td>62</td><td>79</td><td>81</td><td>68</td><td>90</td><td>79</td><td>68</td><td>67</td>
                    <td>44</td><td>48</td><td>53</td><td>53</td><td>64</td><td>82</td><td>84</td><td>70</td><td>93</td><td>82</td><td>70</td><td>69</td>
                  </tr>
                  <tr class="allin-hc-section hc-pillar-sub" style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50);">&nbsp;&nbsp;&nbsp;&nbsp;→ DSA</td>
                    <td>42</td><td>43</td><td>45</td><td>47</td><td>50</td><td>53</td><td>55</td><td>58</td><td>64</td><td>68</td><td>76</td><td>80</td>
                    <td>44</td><td>45</td><td>46</td><td>48</td><td>51</td><td>54</td><td>57</td><td>60</td><td>66</td><td>70</td><td>79</td><td>83</td>
                  </tr>
                  
                  <!-- ═══════════ ACTUAL HEADCOUNT SECTION ═══════════ -->
                  <tr class="row-section-header collapsible" onclick="toggleAllInSection(this)" style="cursor: pointer;">
                    <td colspan="25">👥 Actual Headcount <span style="float: right; font-size: 10px;">▼</span></td>
                  </tr>
                  <tr class="allin-actual-section" style="font-weight: 700; background: var(--gusto-teal-light);">
                    <td style="position: sticky; left: 0; background: var(--gusto-teal-light);"><strong>Actual HC - Total</strong></td>
                    <td>596</td><td>564</td><td>585</td><td>530</td><td>501</td><td>508</td><td>552</td><td>715</td><td>747</td><td>736</td><td>671</td><td>613</td>
                    <td>616</td><td>583</td><td>604</td><td>548</td><td>518</td><td>525</td><td>570</td><td>739</td><td>772</td><td>760</td><td>693</td><td>633</td>
                  </tr>
                  
                  <!-- ═══════════ DSA MANUAL INPUTS ═══════════ -->
                  <tr class="row-section-header collapsible" onclick="toggleAllInSection(this)" style="cursor: pointer; background: var(--gusto-coral) !important; color: white;">
                    <td colspan="25" style="color: white;">✏️ DSA Manual Inputs (Overlay) <span style="float: right; font-size: 10px;">▼</span></td>
                  </tr>
                  <tr class="allin-dsa-section row-editable">
                    <td style="position: sticky; left: 0; background: white;">DSA Actual HC</td>
                    <td><input type="number" value="40" style="width: 44px;"></td><td><input type="number" value="39" style="width: 44px;"></td><td><input type="number" value="39" style="width: 44px;"></td><td><input type="number" value="36" style="width: 44px;"></td><td><input type="number" value="42" style="width: 44px;"></td><td><input type="number" value="54" style="width: 44px;"></td><td><input type="number" value="51" style="width: 44px;"></td><td><input type="number" value="59" style="width: 44px;"></td><td><input type="number" value="65" style="width: 44px;"></td><td><input type="number" value="65" style="width: 44px;"></td><td><input type="number" value="65" style="width: 44px;"></td><td><input type="number" value="65" style="width: 44px;"></td>
                    <td><input type="number" value="41" style="width: 44px;"></td><td><input type="number" value="40" style="width: 44px;"></td><td><input type="number" value="40" style="width: 44px;"></td><td><input type="number" value="37" style="width: 44px;"></td><td><input type="number" value="43" style="width: 44px;"></td><td><input type="number" value="56" style="width: 44px;"></td><td><input type="number" value="53" style="width: 44px;"></td><td><input type="number" value="61" style="width: 44px;"></td><td><input type="number" value="67" style="width: 44px;"></td><td><input type="number" value="67" style="width: 44px;"></td><td><input type="number" value="67" style="width: 44px;"></td><td><input type="number" value="67" style="width: 44px;"></td>
                  </tr>
                  <tr class="allin-dsa-section row-editable">
                    <td style="position: sticky; left: 0; background: white;">DSA HC Need</td>
                    <td><input type="number" value="42" style="width: 44px;"></td><td><input type="number" value="43" style="width: 44px;"></td><td><input type="number" value="45" style="width: 44px;"></td><td><input type="number" value="47" style="width: 44px;"></td><td><input type="number" value="50" style="width: 44px;"></td><td><input type="number" value="53" style="width: 44px;"></td><td><input type="number" value="55" style="width: 44px;"></td><td><input type="number" value="58" style="width: 44px;"></td><td><input type="number" value="64" style="width: 44px;"></td><td><input type="number" value="68" style="width: 44px;"></td><td><input type="number" value="76" style="width: 44px;"></td><td><input type="number" value="80" style="width: 44px;"></td>
                    <td><input type="number" value="44" style="width: 44px;"></td><td><input type="number" value="45" style="width: 44px;"></td><td><input type="number" value="46" style="width: 44px;"></td><td><input type="number" value="48" style="width: 44px;"></td><td><input type="number" value="51" style="width: 44px;"></td><td><input type="number" value="54" style="width: 44px;"></td><td><input type="number" value="57" style="width: 44px;"></td><td><input type="number" value="60" style="width: 44px;"></td><td><input type="number" value="66" style="width: 44px;"></td><td><input type="number" value="70" style="width: 44px;"></td><td><input type="number" value="79" style="width: 44px;"></td><td><input type="number" value="83" style="width: 44px;"></td>
                  </tr>
                  <tr class="allin-dsa-section row-editable">
                    <td style="position: sticky; left: 0; background: white;">DSA OT Per IC (hrs)</td>
                    <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td>
                    <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td>
                  </tr>
                  
                  <!-- ═══════════ NET STAFFING SECTION ═══════════ -->
                  <tr class="row-section-header collapsible" onclick="toggleAllInSection(this)" style="cursor: pointer;">
                    <td colspan="25">📊 Net Staffing (Active HC Need vs Actual) <span style="float: right; font-size: 10px;">▼</span></td>
                  </tr>
                  <tr class="allin-net-section" style="font-weight: 700;">
                    <td style="position: sticky; left: 0; background: white;"><strong>Total Net Staffing</strong></td>
                    <td class="gap-positive">55</td><td class="gap-positive">29</td><td class="gap-positive">11</td><td class="gap-negative">(47)</td><td class="gap-negative">(112)</td><td class="gap-negative">(127)</td><td class="gap-negative">(227)</td><td class="gap-negative">(102)</td><td class="gap-negative">(309)</td><td class="gap-negative">(193)</td><td class="gap-negative">(131)</td><td class="gap-negative">(182)</td>
                    <td class="gap-positive">57</td><td class="gap-positive">30</td><td class="gap-positive">11</td><td class="gap-negative">(48)</td><td class="gap-negative">(115)</td><td class="gap-negative">(131)</td><td class="gap-negative">(235)</td><td class="gap-negative">(105)</td><td class="gap-negative">(319)</td><td class="gap-negative">(200)</td><td class="gap-negative">(136)</td><td class="gap-negative">(189)</td>
                  </tr>
                  
                  <!-- ═══════════ NET STAFFING WITH OT ═══════════ -->
                  <tr class="row-section-header collapsible" onclick="toggleAllInSection(this)" style="cursor: pointer;">
                    <td colspan="25">⏰ Net Staffing With OT <span style="float: right; font-size: 10px;">▼</span></td>
                  </tr>
                  <tr class="allin-ot-section" style="font-weight: 700;">
                    <td style="position: sticky; left: 0; background: white;"><strong>Net Staffing w/ OT</strong></td>
                    <td class="gap-positive">55</td><td class="gap-positive">29</td><td class="gap-positive">11</td><td class="gap-negative">(47)</td><td class="gap-negative">(112)</td><td class="gap-negative">(127)</td><td class="gap-negative">(227)</td><td class="gap-negative">(102)</td><td class="gap-negative">(149)</td><td class="gap-negative">(193)</td><td class="gap-negative">(131)</td><td class="gap-negative">(182)</td>
                    <td class="gap-positive">57</td><td class="gap-positive">30</td><td class="gap-positive">11</td><td class="gap-negative">(48)</td><td class="gap-negative">(115)</td><td class="gap-negative">(131)</td><td class="gap-negative">(235)</td><td class="gap-negative">(105)</td><td class="gap-negative">(154)</td><td class="gap-negative">(200)</td><td class="gap-negative">(136)</td><td class="gap-negative">(189)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- Active Overlays Summary Section - Hierarchical Collapsible -->
          <div id="overlaysSummarySection" class="table-section" style="margin-top: var(--space-md);">
            <div class="table-header" style="background: var(--gusto-coral-light); border-bottom: 2px solid var(--gusto-coral); flex-direction: column; align-items: flex-start; padding: 10px 16px;">
              <div class="table-title" style="cursor: pointer;" onclick="toggleOverlaysSummary()">
                <div class="table-title-icon">🎯</div>
                <span>Active Overlays Summary</span>
                <span id="overlaysArrow" style="margin-left: 8px; font-size: 10px;">▼</span>
              </div>
              <div style="display: flex; align-items: center; gap: 16px; margin-top: 8px; flex-wrap: wrap;">
                <span style="font-size: 11px; color: var(--gray-600);">Only showing non-default values</span>
                <div style="display: flex; gap: 12px; font-size: 11px; background: white; padding: 4px 10px; border-radius: 4px; box-shadow: 0 1px 2px rgba(0,0,0,0.1);">
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 14px; height: 14px; background: #DC2626; border-radius: 3px; border: 1px solid #B91C1C;"></span> <strong style="color: #DC2626;">Peak</strong></span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 14px; height: 14px; background: #F59E0B; border-radius: 3px; border: 1px solid #D97706;"></span> <strong style="color: #D97706;">High</strong></span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 14px; height: 14px; background: #10B981; border-radius: 3px; border: 1px solid #059669;"></span> <strong style="color: #059669;">Low</strong></span>
                </div>
              </div>
            </div>
            <div id="overlaysSummaryContent">
              
              <!-- ACCOUNTANT - On-Demand -->
              <div class="overlay-pillar-group overlay-ondemand" style="border-bottom: 1px solid var(--gray-200);">
                <div class="overlay-pillar-header" onclick="toggleOverlayPillar(this)" style="padding: 10px 16px; background: var(--gusto-teal-light); cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 600;">
                  <span class="overlay-pillar-arrow">▼</span>
                  <span>📊 Accountant</span>
                  <span style="font-size: 10px; color: var(--gray-500); font-weight: normal;">On-Demand • 4 active overlays</span>
                </div>
                <div class="overlay-pillar-content">
                  <!-- Phone Channel -->
                  <div class="overlay-channel-group overlay-phone" style="border-left: 3px solid var(--gusto-teal); margin-left: 16px;">
                    <div class="overlay-channel-header" onclick="toggleOverlayChannel(this)" style="padding: 8px 12px; background: var(--gray-50); cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 12px;">
                      <span class="overlay-channel-arrow">▼</span>
                      <span>📞 Phone</span>
                      <span style="font-size: 10px; color: var(--gray-400);">2 overlays</span>
                    </div>
                    <div class="overlay-channel-content data-grid compact-24 scrollable" style="max-height: 150px; margin-left: 8px;">
                      <table class="data-table" style="font-size: 10px;">
                        <thead><tr style="background: var(--gray-100);"><th style="min-width: 80px; position: sticky; left: 0; background: var(--gray-100);">Overlay</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th></tr></thead>
                        <tbody>
                          <tr><td style="position: sticky; left: 0; background: white;">Shrink %</td><td>28%</td><td>28%</td><td>28%</td><td class="anomaly-high">30%</td><td class="anomaly-high">30%</td><td class="anomaly-high">30%</td><td class="anomaly-high">32%</td><td class="anomaly-peak">35%</td><td class="anomaly-high">32%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td class="anomaly-high">30%</td><td class="anomaly-high">30%</td><td class="anomaly-high">30%</td><td class="anomaly-high">32%</td><td class="anomaly-peak">35%</td><td class="anomaly-high">32%</td><td>28%</td><td>28%</td><td>28%</td></tr>
                          <tr style="background: var(--gray-50);"><td style="position: sticky; left: 0; background: var(--gray-50);">AHT Adj (s)</td><td>+15</td><td>+15</td><td>+10</td><td>+10</td><td>0</td><td>0</td><td class="anomaly-high">+20</td><td class="anomaly-peak">+25</td><td>+15</td><td>0</td><td>0</td><td>0</td><td>+15</td><td>+15</td><td>+10</td><td>+10</td><td>0</td><td>0</td><td class="anomaly-high">+20</td><td class="anomaly-peak">+25</td><td>+15</td><td>0</td><td>0</td><td>0</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <!-- Email Channel -->
                  <div class="overlay-channel-group overlay-email" style="border-left: 3px solid var(--gusto-coral); margin-left: 16px;">
                    <div class="overlay-channel-header" onclick="toggleOverlayChannel(this)" style="padding: 8px 12px; background: var(--gray-50); cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 12px;">
                      <span class="overlay-channel-arrow">▼</span>
                      <span>📧 Email</span>
                      <span style="font-size: 10px; color: var(--gray-400);">2 overlays</span>
                    </div>
                    <div class="overlay-channel-content data-grid compact-24 scrollable" style="max-height: 150px; margin-left: 8px;">
                      <table class="data-table" style="font-size: 10px;">
                        <thead><tr style="background: var(--gray-100);"><th style="min-width: 80px; position: sticky; left: 0; background: var(--gray-100);">Overlay</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th></tr></thead>
                        <tbody>
                          <tr><td style="position: sticky; left: 0; background: white;">Shrink %</td><td>25%</td><td>25%</td><td>25%</td><td class="anomaly-high">27%</td><td class="anomaly-high">27%</td><td class="anomaly-high">27%</td><td class="anomaly-high">29%</td><td class="anomaly-peak">30%</td><td>28%</td><td>25%</td><td>25%</td><td>25%</td><td>25%</td><td>25%</td><td>25%</td><td class="anomaly-high">27%</td><td class="anomaly-high">27%</td><td class="anomaly-high">27%</td><td class="anomaly-high">29%</td><td class="anomaly-peak">30%</td><td>28%</td><td>25%</td><td>25%</td><td>25%</td></tr>
                          <tr style="background: var(--gray-50);"><td style="position: sticky; left: 0; background: var(--gray-50);">TFIR (hrs)</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td class="anomaly-peak">48</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td>24</td><td class="anomaly-peak">48</td><td>24</td><td>24</td><td>24</td><td>24</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- BENEFITS - On-Demand -->
              <div class="overlay-pillar-group overlay-ondemand" style="border-bottom: 1px solid var(--gray-200);">
                <div class="overlay-pillar-header" onclick="toggleOverlayPillar(this)" style="padding: 10px 16px; background: var(--gusto-teal-light); cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 600;">
                  <span class="overlay-pillar-arrow">▼</span>
                  <span>📊 Benefits</span>
                  <span style="font-size: 10px; color: var(--gray-500); font-weight: normal;">On-Demand • 3 active overlays</span>
                </div>
                <div class="overlay-pillar-content">
                  <!-- Chat Channel -->
                  <div class="overlay-channel-group overlay-chat" style="border-left: 3px solid #7C3AED; margin-left: 16px;">
                    <div class="overlay-channel-header" onclick="toggleOverlayChannel(this)" style="padding: 8px 12px; background: var(--gray-50); cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 12px;">
                      <span class="overlay-channel-arrow">▼</span>
                      <span>💬 Chat</span>
                      <span style="font-size: 10px; color: var(--gray-400);">2 overlays</span>
                    </div>
                    <div class="overlay-channel-content data-grid compact-24 scrollable" style="max-height: 150px; margin-left: 8px;">
                      <table class="data-table" style="font-size: 10px;">
                        <thead><tr style="background: var(--gray-100);"><th style="min-width: 80px; position: sticky; left: 0; background: var(--gray-100);">Overlay</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th></tr></thead>
                        <tbody>
                          <tr><td style="position: sticky; left: 0; background: white;">Shrink %</td><td>26%</td><td>26%</td><td>26%</td><td class="anomaly-high">28%</td><td class="anomaly-high">28%</td><td class="anomaly-high">28%</td><td class="anomaly-high">30%</td><td class="anomaly-peak">32%</td><td class="anomaly-high">30%</td><td>26%</td><td>26%</td><td>26%</td><td>26%</td><td>26%</td><td>26%</td><td class="anomaly-high">28%</td><td class="anomaly-high">28%</td><td class="anomaly-high">28%</td><td class="anomaly-high">30%</td><td class="anomaly-peak">32%</td><td class="anomaly-high">30%</td><td>26%</td><td>26%</td><td>26%</td></tr>
                          <tr style="background: var(--gray-50);"><td style="position: sticky; left: 0; background: var(--gray-50);">Concurrency</td><td>2.0</td><td>2.0</td><td>2.0</td><td>2.2</td><td>2.2</td><td>2.2</td><td>2.0</td><td class="anomaly-low">1.8</td><td>2.0</td><td>2.2</td><td>2.2</td><td>2.2</td><td>2.0</td><td>2.0</td><td>2.0</td><td>2.2</td><td>2.2</td><td>2.2</td><td>2.0</td><td class="anomaly-low">1.8</td><td>2.0</td><td>2.2</td><td>2.2</td><td>2.2</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <!-- Phone Channel -->
                  <div class="overlay-channel-group overlay-phone" style="border-left: 3px solid var(--gusto-teal); margin-left: 16px;">
                    <div class="overlay-channel-header" onclick="toggleOverlayChannel(this)" style="padding: 8px 12px; background: var(--gray-50); cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 12px;">
                      <span class="overlay-channel-arrow">▼</span>
                      <span>📞 Phone</span>
                      <span style="font-size: 10px; color: var(--gray-400);">1 overlay</span>
                    </div>
                    <div class="overlay-channel-content data-grid compact-24 scrollable" style="max-height: 150px; margin-left: 8px;">
                      <table class="data-table" style="font-size: 10px;">
                        <thead><tr style="background: var(--gray-100);"><th style="min-width: 80px; position: sticky; left: 0; background: var(--gray-100);">Overlay</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th></tr></thead>
                        <tbody>
                          <tr><td style="position: sticky; left: 0; background: white;">Shrink %</td><td>30%</td><td>30%</td><td>30%</td><td class="anomaly-high">32%</td><td class="anomaly-high">32%</td><td class="anomaly-high">32%</td><td class="anomaly-high">34%</td><td class="anomaly-peak">36%</td><td class="anomaly-high">34%</td><td>30%</td><td>30%</td><td>30%</td><td>30%</td><td>30%</td><td>30%</td><td class="anomaly-high">32%</td><td class="anomaly-high">32%</td><td class="anomaly-high">32%</td><td class="anomaly-high">34%</td><td class="anomaly-peak">36%</td><td class="anomaly-high">34%</td><td>30%</td><td>30%</td><td>30%</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- PAC - Advanced Care -->
              <div class="overlay-pillar-group overlay-advanced" style="border-bottom: 1px solid var(--gray-200);">
                <div class="overlay-pillar-header" onclick="toggleOverlayPillar(this)" style="padding: 10px 16px; background: #EDE9FE; cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 600;">
                  <span class="overlay-pillar-arrow">▼</span>
                  <span>📊 PAC</span>
                  <span style="font-size: 10px; color: var(--gray-500); font-weight: normal;">Advanced Care • 2 active overlays</span>
                </div>
                <div class="overlay-pillar-content">
                  <!-- Phone Channel -->
                  <div class="overlay-channel-group overlay-phone" style="border-left: 3px solid var(--gusto-teal); margin-left: 16px;">
                    <div class="overlay-channel-header" onclick="toggleOverlayChannel(this)" style="padding: 8px 12px; background: var(--gray-50); cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 12px;">
                      <span class="overlay-channel-arrow">▼</span>
                      <span>📞 Phone</span>
                      <span style="font-size: 10px; color: var(--gray-400);">1 overlay</span>
                    </div>
                    <div class="overlay-channel-content data-grid compact-24 scrollable" style="max-height: 150px; margin-left: 8px;">
                      <table class="data-table" style="font-size: 10px;">
                        <thead><tr style="background: var(--gray-100);"><th style="min-width: 80px; position: sticky; left: 0; background: var(--gray-100);">Overlay</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th></tr></thead>
                        <tbody>
                          <tr><td style="position: sticky; left: 0; background: white;">Shrink %</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td><td>24%</td><td>24%</td><td>24%</td><td>26%</td><td class="anomaly-high">28%</td><td>26%</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td><td>24%</td><td>24%</td><td>24%</td><td>26%</td><td class="anomaly-high">28%</td><td>26%</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td><td class="anomaly-low">22%</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <!-- Email Channel -->
                  <div class="overlay-channel-group overlay-email" style="border-left: 3px solid var(--gusto-coral); margin-left: 16px;">
                    <div class="overlay-channel-header" onclick="toggleOverlayChannel(this)" style="padding: 8px 12px; background: var(--gray-50); cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 12px;">
                      <span class="overlay-channel-arrow">▼</span>
                      <span>📧 Email</span>
                      <span style="font-size: 10px; color: var(--gray-400);">1 overlay</span>
                    </div>
                    <div class="overlay-channel-content data-grid compact-24 scrollable" style="max-height: 150px; margin-left: 8px;">
                      <table class="data-table" style="font-size: 10px;">
                        <thead><tr style="background: var(--gray-100);"><th style="min-width: 80px; position: sticky; left: 0; background: var(--gray-100);">Overlay</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th><th>May</th><th>Jun</th><th>Jul</th><th>Aug</th><th>Sep</th><th>Oct</th><th>Nov</th><th>Dec</th><th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th></tr></thead>
                        <tbody>
                          <tr><td style="position: sticky; left: 0; background: white;">TFIR (hrs)</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td class="anomaly-peak">72</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td>48</td><td class="anomaly-peak">72</td><td>48</td><td>48</td><td>48</td><td>48</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
              
            </div>
          </div>
        </div>
        
        <!-- ═══════════════════════════════════════════════════════════════
             VIEW: DASHBOARD (Charts & Visuals)
             ═══════════════════════════════════════════════════════════════ -->
        <div id="view-dashboard" class="view-container" style="display: none;">
          
          <!-- Dashboard Header -->
          <div style="display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-lg); flex-wrap: wrap;">
            <h2 style="display: flex; align-items: center; gap: var(--space-sm); margin: 0;">
              📈 Dashboard
            </h2>
            <span style="font-size: 12px; color: var(--gray-500);">Organization-wide insights & metrics</span>
            <button class="btn btn-secondary" style="margin-left: auto; font-size: 12px;">📤 Export Report</button>
                </div>
          
          <!-- Top Section: 3-Column Grid (like other views) -->
          <div class="dashboard-summary-grid" style="display: grid; grid-template-columns: 1fr 1.8fr 1fr; gap: 20px; margin-bottom: 24px; min-height: 220px;">
            
            <!-- SECTION 1: Filters & Controls -->
            <div class="summary-section" style="background: white; border-radius: 12px; padding: 20px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                <span style="font-size: 16px;">🎛️</span>
                <span style="font-weight: 600; font-size: 13px; color: var(--gray-700);">Filters</span>
              </div>
              
              <div style="flex: 1; display: flex; flex-direction: column; gap: 10px;">
                <div>
                  <label style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px; display: block;">Organization</label>
                  <select class="form-select" style="width: 100%; font-size: 12px; padding: 8px 10px;">
                    <option>🏢 All Pillars</option>
                    <option>👤 Accountant</option>
                    <option>🏥 Benefits</option>
                    <option>📞 PAC</option>
                    <option>💰 Payroll</option>
                    <option>⭐ Premier</option>
                  </select>
                </div>
                <div>
                  <label style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px; display: block;">Channel</label>
                  <select class="form-select" style="width: 100%; font-size: 12px; padding: 8px 10px;">
                    <option>All Channels</option>
                    <option>📞 Phone</option>
                    <option>💬 Chat</option>
                    <option>📧 Email</option>
                  </select>
                </div>
                <div>
                  <label style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px; display: block;">Time Range</label>
                  <select class="form-select" style="width: 100%; font-size: 12px; padding: 8px 10px;">
                <option>Last 6 Months</option>
                <option>Last 12 Months</option>
                <option>YTD</option>
                <option selected>Full Timeline (24 mo)</option>
              </select>
            </div>
              </div>
          </div>
          
            <!-- SECTION 2: Quick Stats -->
            <div class="summary-section" style="background: white; border-radius: 12px; padding: 20px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                <span style="font-size: 16px;">📊</span>
                <span style="font-weight: 600; font-size: 13px; color: var(--gray-700);">Key Metrics</span>
                <span style="font-size: 10px; color: var(--gray-400); margin-left: auto;">Dec 2024</span>
                </div>
              
              <div style="flex: 1; display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; align-content: center;">
                <div style="background: var(--gusto-teal-light); padding: 16px; border-radius: 10px; text-align: center;">
                  <div style="font-size: 11px; color: var(--gusto-teal-dark); text-transform: uppercase; margin-bottom: 4px;">Total HC</div>
                  <div style="font-size: 28px; font-weight: 700; color: var(--gusto-teal);">342</div>
                  <div style="font-size: 11px; color: var(--success); margin-top: 4px;">↑ 3% MoM</div>
              </div>
                <div style="background: var(--gusto-coral-light); padding: 16px; border-radius: 10px; text-align: center;">
                  <div style="font-size: 11px; color: #9A3412; text-transform: uppercase; margin-bottom: 4px;">Gap</div>
                  <div style="font-size: 28px; font-weight: 700; color: var(--gusto-coral);">-26</div>
                  <div style="font-size: 11px; color: #DC2626; margin-top: 4px;">Understaffed</div>
                </div>
                <div style="background: #EDE9FE; padding: 16px; border-radius: 10px; text-align: center;">
                  <div style="font-size: 11px; color: #5B21B6; text-transform: uppercase; margin-bottom: 4px;">Volume</div>
                  <div style="font-size: 28px; font-weight: 700; color: #7C3AED;">78K</div>
                  <div style="font-size: 11px; color: var(--gray-500); margin-top: 4px;">Contacts</div>
                </div>
                <div style="background: #FEF3C7; padding: 16px; border-radius: 10px; text-align: center;">
                  <div style="font-size: 28px; font-weight: 700; color: #D97706;">480</div>
                  <div style="font-size: 11px; color: #DC2626; margin-top: 4px;">↑ 12%</div>
                </div>
              </div>
            </div>
            
            <!-- SECTION 3: Trend Insights -->
            <div class="summary-section" style="background: linear-gradient(135deg, #EFF6FF 0%, #DBEAFE 100%); border-radius: 12px; padding: 16px; border: 1px solid #BFDBFE; display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
                <span style="font-size: 16px;">🔮</span>
                <span style="font-weight: 600; font-size: 13px; color: #1E40AF;">Trend Insights</span>
                <span style="font-size: 8px; background: #3B82F6; color: white; padding: 2px 5px; border-radius: 3px;">AUTO</span>
                </div>
              
              <div style="flex: 1; display: flex; flex-direction: column; gap: 6px; overflow-y: auto;">
                <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                  <span>📈</span>
                  <span style="color: var(--gray-700); line-height: 1.4;"><strong>Volume</strong> trending up 8% over 6 months.</span>
              </div>
                <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                  <span>⚠️</span>
                  <span style="color: var(--gray-700); line-height: 1.4;"><strong>Gap widening</strong> — Dec-Feb forecasted -30.</span>
                </div>
                <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                  <span>💡</span>
                  <span style="color: var(--gray-700); line-height: 1.4;"><strong>Phone</strong> driving 65% of gap increase.</span>
              </div>
            </div>
            
              <button class="btn btn-secondary" onclick="loadView('comparison')" style="margin-top: 8px; width: 100%; padding: 6px; font-size: 10px;">
                ⚖️ Compare Plans
              </button>
                </div>
              </div>
          
          <!-- Charts Grid - Modernized -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
            
            <!-- Chart 1: HC Need vs Actual Trend - MODERNIZED -->
            <div style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); overflow: hidden; border: 1px solid var(--gray-200);">
              <div style="padding: 14px 20px; background: linear-gradient(135deg, rgba(10,128,128,0.08) 0%, rgba(10,128,128,0.03) 100%); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                  <span style="font-size: 16px;">📈</span>
                  <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">HC Need vs Actual</span>
              </div>
                <div style="display: flex; gap: 12px; font-size: 10px;">
                  <span style="display: flex; align-items: center; gap: 4px; color: var(--gray-600);"><span style="width: 12px; height: 3px; background: var(--gusto-teal); border-radius: 2px;"></span>Need</span>
                  <span style="display: flex; align-items: center; gap: 4px; color: var(--gray-600);"><span style="width: 12px; height: 3px; background: #F59E0B; border-radius: 2px;"></span>Actual</span>
                </div>
              </div>
              <div style="padding: 24px;">
                <!-- Chart with proper axes -->
                <div style="position: relative; height: 200px; margin-left: 40px; margin-bottom: 32px;">
                  <!-- Y-axis -->
                  <div style="position: absolute; left: -35px; top: 0; bottom: 0; display: flex; flex-direction: column; justify-content: space-between; font-size: 9px; color: var(--gray-400); text-align: right; width: 30px;">
                    <span>400</span>
                    <span>350</span>
                    <span>300</span>
                    <span>250</span>
                    <span>200</span>
            </div>
            
                  <!-- Grid lines -->
                  <div style="position: absolute; inset: 0; display: flex; flex-direction: column; justify-content: space-between; pointer-events: none;">
                    <div style="border-bottom: 1px solid var(--gray-100);"></div>
                    <div style="border-bottom: 1px solid var(--gray-100);"></div>
                    <div style="border-bottom: 1px solid var(--gray-100);"></div>
                    <div style="border-bottom: 1px solid var(--gray-100);"></div>
                    <div style="border-bottom: 1px solid var(--gray-200);"></div>
                </div>
                  
                  <!-- SVG Chart - Smooth curves -->
                  <svg style="width: 100%; height: 100%; position: relative; z-index: 1; overflow: visible;" viewBox="0 0 280 100" preserveAspectRatio="none">
                    <defs>
                      <linearGradient id="needGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#0A8080;stop-opacity:0.15"/>
                        <stop offset="100%" style="stop-color:#0A8080;stop-opacity:0"/>
                      </linearGradient>
                      <linearGradient id="actualGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#F59E0B;stop-opacity:0.1"/>
                        <stop offset="100%" style="stop-color:#F59E0B;stop-opacity:0"/>
                      </linearGradient>
                      <filter id="glow">
                        <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                        <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
                      </filter>
                    </defs>
                    
                    <!-- Area fill - HC Need (smooth) -->
                    <path d="M0,50 C20,48 25,45 40,42 C55,39 60,36 80,38 C100,40 105,35 120,30 C135,25 145,22 160,20 C175,18 190,16 210,14 C230,12 260,10 280,8 L280,100 L0,100 Z" fill="url(#needGradient)"/>
                    
                    <!-- HC Need line (smooth bezier) -->
                    <path d="M0,50 C20,48 25,45 40,42 C55,39 60,36 80,38 C100,40 105,35 120,30 C135,25 145,22 160,20 C175,18 190,16 210,14 C230,12 260,10 280,8" 
                          fill="none" stroke="#0A8080" stroke-width="2" stroke-linecap="round" style="filter: url(#glow);"/>
                    
                    <!-- Actual HC line (smooth bezier, dashed) -->
                    <path d="M0,58 C20,56 25,54 40,52 C55,50 60,52 80,54 C100,52 105,48 120,45 C135,42 145,40 160,38 C175,36 190,36 210,34 C230,32 260,30 280,28"
                          fill="none" stroke="#F59E0B" stroke-width="2" stroke-linecap="round" stroke-dasharray="8,4" opacity="0.9"/>
                    
                    <!-- Data points - Need (smaller, cleaner) -->
                    <g fill="#0A8080">
                      <circle cx="0" cy="50" r="4" style="filter: url(#glow);"/>
                      <circle cx="40" cy="42" r="3"/>
                      <circle cx="80" cy="38" r="3"/>
                      <circle cx="120" cy="30" r="3"/>
                      <circle cx="160" cy="20" r="3"/>
                      <circle cx="210" cy="14" r="3"/>
                      <circle cx="280" cy="8" r="4" style="filter: url(#glow);"/>
                    </g>
                    
                    <!-- Data points - Actual (smaller) -->
                    <g fill="#F59E0B">
                      <circle cx="0" cy="58" r="3"/>
                      <circle cx="40" cy="52" r="2.5"/>
                      <circle cx="80" cy="54" r="2.5"/>
                      <circle cx="120" cy="45" r="2.5"/>
                      <circle cx="160" cy="38" r="2.5"/>
                      <circle cx="210" cy="34" r="2.5"/>
                      <circle cx="280" cy="28" r="3"/>
                    </g>
                    
                  </svg>
                  
                  <!-- X-axis months -->
                  <div style="position: absolute; bottom: -22px; left: 0; right: 0; display: flex; justify-content: space-between; font-size: 9px; color: var(--gray-400);">
                    <span>May</span>
                    <span>Jul</span>
                    <span>Sep</span>
                    <span>Nov</span>
                    <span>Jan</span>
                    <span>Mar</span>
                    <span>Apr</span>
              </div>
                </div>
              </div>
            </div>
            
            <!-- Chart 2: HC by Pillar - Stacked Bar Time Series - MODERNIZED -->
            <div style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); overflow: hidden; border: 1px solid var(--gray-200);">
              <div style="padding: 14px 20px; background: linear-gradient(135deg, rgba(124,58,237,0.08) 0%, rgba(124,58,237,0.03) 100%); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                  <span style="font-size: 16px;">📊</span>
                  <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">HC by Pillar (Trend)</span>
                </div>
              </div>
              <div style="padding: 24px;">
                <!-- Stacked bar chart -->
                <div style="position: relative; height: 200px; margin-left: 40px; margin-bottom: 32px;">
                  <!-- Y-axis -->
                  <div style="position: absolute; left: -40px; top: 0; bottom: 0; display: flex; flex-direction: column; justify-content: space-between; font-size: 10px; color: var(--gray-400); text-align: right; width: 35px;">
                    <span>400</span>
                    <span>300</span>
                    <span>200</span>
                    <span>100</span>
                    <span>0</span>
                  </div>
                  
                  <!-- Stacked bars -->
                  <div style="display: flex; align-items: flex-end; justify-content: space-around; height: 100%; gap: 4px; border-left: 1px solid var(--gray-200); border-bottom: 1px solid var(--gray-200); padding: 0 8px;">
                    <!-- Each month -->
                    <div style="flex: 1; display: flex; flex-direction: column; max-width: 28px;">
                      <div style="height: 32px; background: #10B981; border-radius: 2px 2px 0 0;"></div>
                      <div style="height: 28px; background: #D97706;"></div>
                      <div style="height: 22px; background: #7C3AED;"></div>
                      <div style="height: 28px; background: #F45D48;"></div>
                      <div style="height: 34px; background: #0A8080;"></div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; max-width: 28px;">
                      <div style="height: 33px; background: #10B981; border-radius: 2px 2px 0 0;"></div>
                      <div style="height: 29px; background: #D97706;"></div>
                      <div style="height: 23px; background: #7C3AED;"></div>
                      <div style="height: 29px; background: #F45D48;"></div>
                      <div style="height: 35px; background: #0A8080;"></div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; max-width: 28px;">
                      <div style="height: 34px; background: #10B981; border-radius: 2px 2px 0 0;"></div>
                      <div style="height: 30px; background: #D97706;"></div>
                      <div style="height: 24px; background: #7C3AED;"></div>
                      <div style="height: 30px; background: #F45D48;"></div>
                      <div style="height: 36px; background: #0A8080;"></div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; max-width: 28px;">
                      <div style="height: 35px; background: #10B981; border-radius: 2px 2px 0 0;"></div>
                      <div style="height: 31px; background: #D97706;"></div>
                      <div style="height: 25px; background: #7C3AED;"></div>
                      <div style="height: 31px; background: #F45D48;"></div>
                      <div style="height: 38px; background: #0A8080;"></div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; max-width: 28px;">
                      <div style="height: 36px; background: #10B981; border-radius: 2px 2px 0 0;"></div>
                      <div style="height: 32px; background: #D97706;"></div>
                      <div style="height: 26px; background: #7C3AED;"></div>
                      <div style="height: 32px; background: #F45D48;"></div>
                      <div style="height: 40px; background: #0A8080;"></div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; max-width: 28px;">
                      <div style="height: 37px; background: #10B981; border-radius: 2px 2px 0 0;"></div>
                      <div style="height: 33px; background: #D97706;"></div>
                      <div style="height: 27px; background: #7C3AED;"></div>
                      <div style="height: 33px; background: #F45D48;"></div>
                      <div style="height: 42px; background: #0A8080;"></div>
                    </div>
                  </div>
                  
                  <!-- X-axis months -->
                  <div style="position: absolute; bottom: -25px; left: 0; right: 0; display: flex; justify-content: space-around; font-size: 9px; color: var(--gray-500); padding: 0 8px;">
                    <span>Jul</span>
                    <span>Aug</span>
                    <span>Sep</span>
                    <span>Oct</span>
                    <span>Nov</span>
                    <span>Dec</span>
                  </div>
                </div>
                
                <!-- Legend -->
                <div style="display: flex; justify-content: center; gap: 12px; font-size: 10px; flex-wrap: wrap;">
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 10px; height: 10px; background: #0A8080; border-radius: 2px;"></span>Accountant</span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 10px; height: 10px; background: #F45D48; border-radius: 2px;"></span>Benefits</span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 10px; height: 10px; background: #7C3AED; border-radius: 2px;"></span>PAC</span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 10px; height: 10px; background: #D97706; border-radius: 2px;"></span>Payroll</span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 10px; height: 10px; background: #10B981; border-radius: 2px;"></span>Premier</span>
                </div>
              </div>
            </div>
            
            <!-- Chart 3: Staffing Gap Waterfall - MODERNIZED -->
            <div style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); overflow: hidden; border: 1px solid var(--gray-200);">
              <div style="padding: 14px 20px; background: linear-gradient(135deg, rgba(244,93,72,0.08) 0%, rgba(244,93,72,0.03) 100%); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                  <span style="font-size: 16px;">🏗️</span>
                  <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Gap Waterfall</span>
                </div>
                <select class="form-select" style="width: auto; font-size: 11px; padding: 6px 10px; background: white; border: 1px solid var(--gray-200); border-radius: 6px;">
                  <option selected>Dec-24</option>
                  <option>Jan-25</option>
                  <option>Feb-25</option>
                  <option>Mar-25</option>
                </select>
              </div>
              <div style="padding: 24px 20px 16px 20px;">
                <!-- Waterfall chart -->
                <div style="position: relative; height: 180px; margin-left: 45px; margin-bottom: 30px;">
                  <!-- Y-axis -->
                  <div style="position: absolute; left: -45px; top: 0; bottom: 0; display: flex; flex-direction: column; justify-content: space-between; font-size: 10px; color: var(--gray-400); text-align: right; width: 40px;">
                    <span>400</span>
                    <span>350</span>
                    <span>300</span>
                    <span>250</span>
                    <span>200</span>
                  </div>
                  
                  <!-- Grid lines -->
                  <div style="position: absolute; inset: 0; display: flex; flex-direction: column; justify-content: space-between; border-left: 1px solid var(--gray-200); border-bottom: 1px solid var(--gray-200);">
                    <div style="border-bottom: 1px dashed var(--gray-100);"></div>
                    <div style="border-bottom: 1px dashed var(--gray-100);"></div>
                    <div style="border-bottom: 1px dashed var(--gray-100);"></div>
                    <div style="border-bottom: 1px dashed var(--gray-100);"></div>
                    <div></div>
                  </div>
                  
                  <!-- Waterfall bars -->
                  <div style="position: relative; z-index: 1; display: flex; align-items: flex-end; justify-content: space-around; height: 100%; padding: 0 8px;">
                    <!-- HC Need -->
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer;" title="Starting HC Need based on forecast">
                      <span style="font-size: 10px; font-weight: 700; color: var(--gusto-teal);">368</span>
                      <div style="width: 40px; height: 150px; background: linear-gradient(180deg, #0D9999 0%, #0A8080 100%); border-radius: 4px 4px 0 0; box-shadow: 0 2px 8px rgba(10,128,128,0.3); transition: transform 0.2s;"></div>
                    </div>
                    <!-- Volume -->
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer;" title="Volume ↑8% = +12 HC">
                      <span style="font-size: 10px; font-weight: 700; color: #DC2626;">+12</span>
                      <div style="width: 40px; display: flex; flex-direction: column;">
                        <div style="height: 100px;"></div>
                        <div style="height: 20px; background: linear-gradient(180deg, #FECACA 0%, #FCA5A5 100%); border: 2px solid #EF4444; border-radius: 4px;"></div>
                      </div>
                    </div>
                    <!-- Hires -->
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer;" title="15 hires, 8 productive">
                      <span style="font-size: 10px; font-weight: 700; color: #10B981;">+8</span>
                      <div style="width: 40px; display: flex; flex-direction: column;">
                        <div style="height: 105px;"></div>
                        <div style="height: 14px; background: linear-gradient(180deg, #D1FAE5 0%, #A7F3D0 100%); border: 2px solid #10B981; border-radius: 4px;"></div>
                      </div>
                    </div>
                    <!-- Attrition -->
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer;" title="18 agents left">
                      <span style="font-size: 10px; font-weight: 700; color: #DC2626;">-18</span>
                      <div style="width: 40px; display: flex; flex-direction: column;">
                        <div style="height: 82px;"></div>
                        <div style="height: 30px; background: linear-gradient(180deg, #FECACA 0%, #FCA5A5 100%); border: 2px solid #EF4444; border-radius: 4px;"></div>
                      </div>
                    </div>
                    <!-- OT -->
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer;" title="OT = 8 FTE equivalent">
                      <span style="font-size: 10px; font-weight: 700; color: #D97706;">+8</span>
                      <div style="width: 40px; display: flex; flex-direction: column;">
                        <div style="height: 98px;"></div>
                        <div style="height: 14px; background: linear-gradient(180deg, #FEF3C7 0%, #FDE68A 100%); border: 2px solid #F59E0B; border-radius: 4px;"></div>
                      </div>
                    </div>
                    <!-- Final -->
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer;" title="Net gap = -26 HC">
                      <span style="font-size: 11px; font-weight: 800; color: #DC2626;">-26</span>
                      <div style="width: 40px; height: 140px; background: linear-gradient(180deg, #F45D48 0%, #DC2626 100%); border-radius: 4px 4px 0 0; box-shadow: 0 4px 12px rgba(220,38,38,0.4);"></div>
                    </div>
                  </div>
                  
                  <!-- X-axis labels -->
                  <div style="position: absolute; bottom: -25px; left: 0; right: 0; display: flex; justify-content: space-around; font-size: 9px; color: var(--gray-500); padding: 0 8px;">
                    <span>Need</span>
                    <span>Volume</span>
                    <span>Hires</span>
                    <span>Attrit</span>
                    <span>OT</span>
                    <span style="font-weight: 600; color: var(--gray-700);">Gap</span>
                  </div>
                </div>
                
                <!-- Legend -->
                <div style="display: flex; justify-content: center; gap: 16px; font-size: 10px; margin-top: 8px;">
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 12px; height: 12px; background: var(--gusto-teal); border-radius: 3px;"></span>Base</span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 12px; height: 12px; background: #A7F3D0; border: 2px solid #10B981; border-radius: 3px;"></span>+Add</span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 12px; height: 12px; background: #FCA5A5; border: 2px solid #EF4444; border-radius: 3px;"></span>-Subtract</span>
                  <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 12px; height: 12px; background: var(--gusto-coral); border-radius: 3px;"></span>Result</span>
                </div>
              </div>
            </div>
            
            <!-- Chart 4: Site-Level Breakdown - MODERNIZED -->
            <div style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); overflow: hidden; border: 1px solid var(--gray-200);">
              <div style="padding: 14px 20px; background: linear-gradient(135deg, rgba(217,119,6,0.08) 0%, rgba(217,119,6,0.03) 100%); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                  <span style="font-size: 16px;">🌎</span>
                  <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">HC by Site</span>
                </div>
                <select class="form-select" style="width: auto; font-size: 11px; padding: 6px 10px; background: white; border: 1px solid var(--gray-200); border-radius: 6px;">
                  <option selected>All Pillars</option>
                  <option>Accountant</option>
                  <option>Benefits</option>
                  <option>PAC</option>
                  <option>Payroll</option>
                  <option>Premier</option>
                </select>
              </div>
              <div style="padding: 16px;">
                <!-- Site breakdown -->
                <div style="display: flex; flex-direction: column; gap: 6px;">
                  <!-- Header -->
                  <div style="display: grid; grid-template-columns: 1.4fr 0.5fr 0.5fr 0.5fr 0.7fr; gap: 8px; padding: 10px 14px; background: linear-gradient(90deg, var(--gray-100) 0%, var(--gray-50) 100%); border-radius: 8px; font-size: 10px; font-weight: 700; color: var(--gray-600); text-transform: uppercase; letter-spacing: 0.5px;">
                    <span>Site</span>
                    <span style="text-align: center;">HC</span>
                    <span style="text-align: center;">Need</span>
                    <span style="text-align: center;">Gap</span>
                    <span style="text-align: right;">6mo Trend</span>
                  </div>
                  
                  <!-- Gusto (Internal) -->
                  <div style="display: grid; grid-template-columns: 1.4fr 0.5fr 0.5fr 0.5fr 0.7fr; gap: 8px; padding: 12px 14px; background: linear-gradient(90deg, rgba(10,128,128,0.08) 0%, white 100%); border: 1px solid rgba(10,128,128,0.15); border-radius: 10px; align-items: center; transition: all 0.2s;" onmouseover="this.style.transform='translateX(4px)'" onmouseout="this.style.transform='none'">
                    <div style="display: flex; align-items: center; gap: 10px;">
                      <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #0A8080 0%, #0D9999 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 16px;">🏢</span>
                      </div>
                      <div>
                        <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Gusto</div>
                        <div style="font-size: 9px; color: var(--gray-400);">Internal</div>
                      </div>
                    </div>
                    <div style="text-align: center; font-size: 16px; font-weight: 700; color: var(--gusto-teal);">142</div>
                    <div style="text-align: center; font-size: 13px; color: var(--gray-600);">156</div>
                    <div style="text-align: center; font-size: 13px; font-weight: 700; color: #DC2626;">-14</div>
                    <div style="display: flex; justify-content: flex-end;">
                      <svg width="60" height="24" viewBox="0 0 60 24" style="filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));">
                        <polyline points="2,18 12,15 22,16 32,12 42,10 52,8" fill="none" stroke="#0A8080" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="52" cy="8" r="3" fill="#0A8080"/>
                      </svg>
                    </div>
                  </div>
                  
                  <!-- Apex -->
                  <div style="display: grid; grid-template-columns: 1.4fr 0.5fr 0.5fr 0.5fr 0.7fr; gap: 8px; padding: 12px 14px; background: linear-gradient(90deg, rgba(124,58,237,0.08) 0%, white 100%); border: 1px solid rgba(124,58,237,0.15); border-radius: 10px; align-items: center; transition: all 0.2s;" onmouseover="this.style.transform='translateX(4px)'" onmouseout="this.style.transform='none'">
                    <div style="display: flex; align-items: center; gap: 10px;">
                      <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #7C3AED 0%, #9333EA 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 16px;">🔺</span>
                      </div>
                      <div>
                        <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Apex</div>
                        <div style="font-size: 9px; color: var(--gray-400);">BPO Partner</div>
                      </div>
                    </div>
                    <div style="text-align: center; font-size: 16px; font-weight: 700; color: #7C3AED;">68</div>
                    <div style="text-align: center; font-size: 13px; color: var(--gray-600);">72</div>
                    <div style="text-align: center; font-size: 13px; font-weight: 700; color: #DC2626;">-4</div>
                    <div style="display: flex; justify-content: flex-end;">
                      <svg width="60" height="24" viewBox="0 0 60 24" style="filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));">
                        <polyline points="2,14 12,12 22,14 32,10 42,12 52,10" fill="none" stroke="#7C3AED" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="52" cy="10" r="3" fill="#7C3AED"/>
                      </svg>
                    </div>
                  </div>
                  
                  <!-- TaskUs -->
                  <div style="display: grid; grid-template-columns: 1.4fr 0.5fr 0.5fr 0.5fr 0.7fr; gap: 8px; padding: 12px 14px; background: linear-gradient(90deg, rgba(244,93,72,0.08) 0%, white 100%); border: 1px solid rgba(244,93,72,0.15); border-radius: 10px; align-items: center; transition: all 0.2s;" onmouseover="this.style.transform='translateX(4px)'" onmouseout="this.style.transform='none'">
                    <div style="display: flex; align-items: center; gap: 10px;">
                      <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #F45D48 0%, #EF4444 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 16px;">⚡</span>
                      </div>
                      <div>
                        <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">TaskUs</div>
                        <div style="font-size: 9px; color: var(--gray-400);">BPO Partner</div>
                      </div>
                    </div>
                    <div style="text-align: center; font-size: 16px; font-weight: 700; color: #F45D48;">82</div>
                    <div style="text-align: center; font-size: 13px; color: var(--gray-600);">86</div>
                    <div style="text-align: center; font-size: 13px; font-weight: 700; color: #DC2626;">-4</div>
                    <div style="display: flex; justify-content: flex-end;">
                      <svg width="60" height="24" viewBox="0 0 60 24" style="filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));">
                        <polyline points="2,16 12,14 22,12 32,14 42,10 52,12" fill="none" stroke="#F45D48" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="52" cy="12" r="3" fill="#F45D48"/>
                      </svg>
                    </div>
                  </div>
                  
                  <!-- Teleperformance -->
                  <div style="display: grid; grid-template-columns: 1.4fr 0.5fr 0.5fr 0.5fr 0.7fr; gap: 8px; padding: 12px 14px; background: linear-gradient(90deg, rgba(16,185,129,0.08) 0%, white 100%); border: 1px solid rgba(16,185,129,0.15); border-radius: 10px; align-items: center; transition: all 0.2s;" onmouseover="this.style.transform='translateX(4px)'" onmouseout="this.style.transform='none'">
                    <div style="display: flex; align-items: center; gap: 10px;">
                      <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #10B981 0%, #059669 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 16px;">🌐</span>
                      </div>
                      <div>
                        <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Teleperformance</div>
                        <div style="font-size: 9px; color: var(--gray-400);">BPO Partner</div>
                      </div>
                    </div>
                    <div style="text-align: center; font-size: 16px; font-weight: 700; color: #10B981;">50</div>
                    <div style="text-align: center; font-size: 13px; color: var(--gray-600);">54</div>
                    <div style="text-align: center; font-size: 13px; font-weight: 700; color: #DC2626;">-4</div>
                    <div style="display: flex; justify-content: flex-end;">
                      <svg width="60" height="24" viewBox="0 0 60 24" style="filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));">
                        <polyline points="2,12 12,14 22,10 32,12 42,8 52,6" fill="none" stroke="#10B981" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="52" cy="6" r="3" fill="#10B981"/>
                      </svg>
                    </div>
                  </div>
                  
                  <!-- Total -->
                  <div style="display: grid; grid-template-columns: 1.4fr 0.5fr 0.5fr 0.5fr 0.7fr; gap: 8px; padding: 12px 14px; background: linear-gradient(135deg, var(--gray-800) 0%, var(--gray-700) 100%); border-radius: 10px; align-items: center; margin-top: 4px;">
                    <div style="font-weight: 700; font-size: 13px; color: white;">TOTAL</div>
                    <div style="text-align: center; font-size: 16px; font-weight: 800; color: white;">342</div>
                    <div style="text-align: center; font-size: 13px; font-weight: 600; color: rgba(255,255,255,0.8);">368</div>
                    <div style="text-align: center; font-size: 14px; font-weight: 800; color: #FCA5A5;">-26</div>
                    <div></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Second Row: Channel Performance + Hiring & Attrition - MODERNIZED -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
            
            <!-- Channel Performance - MODERNIZED -->
            <div style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); overflow: hidden; border: 1px solid var(--gray-200);">
              <div style="padding: 14px 20px; background: linear-gradient(135deg, rgba(99,102,241,0.08) 0%, rgba(99,102,241,0.03) 100%); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                  <span style="font-size: 16px;">📞</span>
                  <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Channel Performance</span>
                </div>
                <span style="font-size: 10px; color: var(--gray-500);">Dec 2024</span>
              </div>
              <div style="padding: 16px;">
                <div style="display: flex; flex-direction: column; gap: 10px;">
                  <!-- Phone -->
                  <div style="display: flex; align-items: center; gap: 14px; background: linear-gradient(90deg, rgba(99,102,241,0.08) 0%, white 100%); padding: 14px 16px; border-radius: 12px; border: 1px solid rgba(99,102,241,0.12); transition: all 0.2s;" onmouseover="this.style.transform='translateX(4px)'" onmouseout="this.style.transform='none'">
                    <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                      <span style="font-size: 20px;">📞</span>
                    </div>
                    <div style="flex: 1;">
                      <div style="font-weight: 600; font-size: 14px; color: var(--gray-800);">Phone</div>
                      <div style="font-size: 11px; color: var(--gray-500); margin-top: 2px;">
                        Gap: <span style="color: #DC2626; font-weight: 600;">-18</span> 
                        <span style="margin: 0 6px; color: var(--gray-300);">•</span>
                        SL: <span style="color: #D97706; font-weight: 600;">78%</span>
                      </div>
                    </div>
                    <div style="text-align: right;">
                      <div style="font-size: 22px; font-weight: 800; color: #3B82F6;">142</div>
                      <div style="font-size: 9px; color: var(--gray-400); text-transform: uppercase;">Headcount</div>
                    </div>
                  </div>
                  
                  <!-- Chat -->
                  <div style="display: flex; align-items: center; gap: 14px; background: linear-gradient(90deg, rgba(16,185,129,0.08) 0%, white 100%); padding: 14px 16px; border-radius: 12px; border: 1px solid rgba(16,185,129,0.12); transition: all 0.2s;" onmouseover="this.style.transform='translateX(4px)'" onmouseout="this.style.transform='none'">
                    <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #10B981 0%, #059669 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                      <span style="font-size: 20px;">💬</span>
                    </div>
                    <div style="flex: 1;">
                      <div style="font-weight: 600; font-size: 14px; color: var(--gray-800);">Chat</div>
                      <div style="font-size: 11px; color: var(--gray-500); margin-top: 2px;">
                        Gap: <span style="color: #10B981; font-weight: 600;">+3</span>
                        <span style="margin: 0 6px; color: var(--gray-300);">•</span>
                        SL: <span style="color: #10B981; font-weight: 600;">85%</span>
                      </div>
                    </div>
                    <div style="text-align: right;">
                      <div style="font-size: 22px; font-weight: 800; color: #10B981;">98</div>
                      <div style="font-size: 9px; color: var(--gray-400); text-transform: uppercase;">Headcount</div>
                    </div>
                  </div>
                  
                  <!-- Email -->
                  <div style="display: flex; align-items: center; gap: 14px; background: linear-gradient(90deg, rgba(244,93,72,0.08) 0%, white 100%); padding: 14px 16px; border-radius: 12px; border: 1px solid rgba(244,93,72,0.12); transition: all 0.2s;" onmouseover="this.style.transform='translateX(4px)'" onmouseout="this.style.transform='none'">
                    <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #F45D48 0%, #DC2626 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                      <span style="font-size: 20px;">📧</span>
                    </div>
                    <div style="flex: 1;">
                      <div style="font-weight: 600; font-size: 14px; color: var(--gray-800);">Email</div>
                      <div style="font-size: 11px; color: var(--gray-500); margin-top: 2px;">
                        Gap: <span style="color: #DC2626; font-weight: 600;">-11</span>
                        <span style="margin: 0 6px; color: var(--gray-300);">•</span>
                        SL: <span style="color: #10B981; font-weight: 600;">92%</span>
                      </div>
                    </div>
                    <div style="text-align: right;">
                      <div style="font-size: 22px; font-weight: 800; color: #F45D48;">102</div>
                      <div style="font-size: 9px; color: var(--gray-400); text-transform: uppercase;">Headcount</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Hiring & Attrition - MODERNIZED -->
            <div style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); overflow: hidden; border: 1px solid var(--gray-200);">
              <div style="padding: 14px 20px; background: linear-gradient(135deg, rgba(16,185,129,0.08) 0%, rgba(16,185,129,0.03) 100%); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                  <span style="font-size: 16px;">👥</span>
                  <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Hiring & Attrition</span>
                </div>
                <span style="background: var(--gusto-teal-light); padding: 4px 10px; border-radius: 12px; font-size: 10px; color: var(--gusto-teal-dark);">Rolling 3 mo</span>
              </div>
              <div style="padding: 16px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px;">
                  <!-- Hiring -->
                  <div style="background: linear-gradient(135deg, #ECFDF5 0%, #D1FAE5 100%); padding: 18px; border-radius: 14px; border-left: 5px solid #10B981; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: -10px; right: -10px; font-size: 60px; opacity: 0.1;">↗</div>
                    <div style="font-size: 10px; color: #065F46; text-transform: uppercase; font-weight: 600; letter-spacing: 0.5px;">New Hires</div>
                    <div style="font-size: 36px; font-weight: 800; color: #10B981; margin: 4px 0;">+42</div>
                    <div style="font-size: 11px; color: var(--gray-600);">
                      <span style="color: #10B981; font-weight: 600;">32</span> productive • <span style="color: #D97706;">10</span> training
                    </div>
                    <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(16,185,129,0.2); font-size: 10px; color: var(--gray-500);">
                      📋 Pipeline: <span style="font-weight: 600; color: #059669;">18 offers</span>
                    </div>
                  </div>
                  
                  <!-- Attrition -->
                  <div style="background: linear-gradient(135deg, #FEF2F2 0%, #FECACA 100%); padding: 18px; border-radius: 14px; border-left: 5px solid #DC2626; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: -10px; right: -10px; font-size: 60px; opacity: 0.1;">↘</div>
                    <div style="font-size: 10px; color: #991B1B; text-transform: uppercase; font-weight: 600; letter-spacing: 0.5px;">Attrition</div>
                    <div style="font-size: 36px; font-weight: 800; color: #DC2626; margin: 4px 0;">-38</div>
                    <div style="font-size: 11px; color: var(--gray-600);">
                      <span style="color: #DC2626; font-weight: 600;">8.2%</span> rolling rate
                    </div>
                    <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(220,38,38,0.2); font-size: 10px; color: var(--gray-500);">
                      🎯 Target: <span style="font-weight: 600; color: #DC2626;">&lt; 6%</span> monthly
                    </div>
                  </div>
                </div>
                
                <!-- Net Change -->
                <div style="margin-top: 14px; padding: 14px 18px; background: linear-gradient(135deg, var(--gray-800) 0%, var(--gray-700) 100%); border-radius: 12px; display: flex; justify-content: space-between; align-items: center;">
                  <span style="font-size: 12px; font-weight: 600; color: rgba(255,255,255,0.9);">Net HC Change (3 mo)</span>
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 22px; font-weight: 800; color: #4ADE80;">+4</span>
                    <span style="font-size: 16px;">📈</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ═══════════════════════════════════════════════════════════════
             VIEW: PLAN COMPARISON (Dedicated Tool)
             ═══════════════════════════════════════════════════════════════ -->
        <div id="view-comparison" class="view-container" style="display: none;">
          
          <!-- Plan Comparison Header -->
          <div style="display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-lg); flex-wrap: wrap;">
            <h2 style="display: flex; align-items: center; gap: var(--space-sm); margin: 0;">
              📊 Plan Comparison
            </h2>
            <span style="font-size: 12px; color: var(--gray-500);">Compare scenarios & published plans</span>
            <div style="margin-left: auto; display: flex; gap: 8px;">
              <button class="btn btn-secondary" style="font-size: 12px;">📤 Export Report</button>
            </div>
          </div>
          
          <!-- ═══ TOP SECTION: 3-Column Grid (like Pillar view) ═══ -->
          <div class="comparison-summary-grid" style="display: grid; grid-template-columns: 1fr 1.2fr 1fr; gap: 16px; margin-bottom: 16px; min-height: 200px;">
            
            <!-- SECTION 1: Plan Selector -->
            <div class="summary-section" style="background: white; border-radius: 12px; padding: 16px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                <span style="font-size: 16px;">⚖️</span>
                <span style="font-weight: 600; font-size: 13px; color: var(--gray-700);">Compare Plans</span>
              </div>
              
              <div style="flex: 1; display: flex; flex-direction: column; gap: 10px;">
                <!-- Pillar/Organization Selector (TOP) -->
                <div>
                  <label style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px; display: block;">Organization</label>
                  <select id="comparisonPillarSelect" class="form-select" style="width: 100%; font-size: 12px; padding: 8px 10px; border: 1px solid var(--gray-300); border-radius: 6px;" onchange="updateComparisonPlans()">
                    <option value="all">🏢 All Pillars (Org-Wide)</option>
                    <option value="accountant">👤 Accountant</option>
                    <option value="benefits">🏥 Benefits</option>
                    <option value="pac">📞 PAC</option>
                    <option value="payroll">💰 Payroll</option>
                    <option value="premier">⭐ Premier</option>
                  </select>
                </div>
                
                <!-- Base Plan -->
                <div>
                  <label style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px; display: block;">Base Plan</label>
                  <select id="comparisonBasePlan" class="form-select" style="width: 100%; font-size: 12px; padding: 8px 10px; border: 2px solid var(--gusto-teal); border-radius: 6px;">
                    <option value="published-3.2">📋 Published v3.2 (Current)</option>
                    <option value="published-3.1">📋 Published v3.1</option>
                    <option value="published-3.0">📋 Published v3.0</option>
                  </select>
                </div>
                
                <!-- Compare To -->
                <div>
                  <label style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px; display: block;">Compare To</label>
                  <select id="comparisonTarget" class="form-select" style="width: 100%; font-size: 12px; padding: 8px 10px; border: 2px solid var(--gusto-coral); border-radius: 6px;">
                    <option value="working">✏️ Working Draft</option>
                    <option value="scenario-volume" selected>💾 +10% Volume</option>
                    <option value="scenario-attrition">💾 High Attrition</option>
                    <option value="scenario-shrink">💾 Reduced Shrink</option>
                  </select>
                </div>
                
                <!-- Compare Button -->
                <button class="btn btn-primary" onclick="runComparison()" style="width: 100%; padding: 10px; font-size: 12px; margin-top: auto;">
                  ⚖️ Compare Plans
                </button>
              </div>
            </div>
            
            <!-- SECTION 2: Key Metrics (2x3 grid) -->
            <div class="summary-section" style="background: white; border-radius: 12px; padding: 16px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                <span style="font-size: 16px;">📊</span>
                <span style="font-weight: 600; font-size: 13px; color: var(--gray-700);">Impact Summary</span>
                <span style="font-size: 10px; color: var(--gray-400); margin-left: auto;">May-25 → Apr-26</span>
              </div>
              
              <div style="flex: 1; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; align-content: center;">
                <div style="background: var(--gray-50); padding: 14px 10px; border-radius: 8px; text-align: center; border-left: 3px solid var(--gusto-teal);">
                  <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">Volume Δ</div>
                  <div style="font-size: 24px; font-weight: 700; color: var(--gusto-teal);">+10%</div>
                  <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">19K → 21K</div>
                </div>
                <div style="background: var(--gray-50); padding: 14px 10px; border-radius: 8px; text-align: center; border-left: 3px solid #7C3AED;">
                  <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">HC Need Δ</div>
                  <div style="font-size: 24px; font-weight: 700; color: #DC2626;">+5</div>
                  <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">51 → 56 HC</div>
                </div>
                <div style="background: var(--gray-50); padding: 14px 10px; border-radius: 8px; text-align: center; border-left: 3px solid var(--gusto-coral);">
                  <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">Gap Δ</div>
                  <div style="font-size: 24px; font-weight: 700; color: #DC2626;">-5</div>
                  <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">-30 → -35</div>
                </div>
                <div style="background: var(--gray-50); padding: 14px 10px; border-radius: 8px; text-align: center; border-left: 3px solid #D97706;">
                  <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">OT Hours Δ</div>
                  <div style="font-size: 24px; font-weight: 700; color: #DC2626;">+55</div>
                  <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">225 → 280 hrs</div>
                </div>
                <div style="background: var(--gray-50); padding: 14px 10px; border-radius: 8px; text-align: center; border-left: 3px solid #10B981;">
                  <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">Final Gap</div>
                  <div style="font-size: 24px; font-weight: 700; color: #DC2626;">-27</div>
                  <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">after OT</div>
                </div>
                <div style="background: var(--gray-50); padding: 14px 10px; border-radius: 8px; text-align: center; border-left: 3px solid var(--gray-400);">
                  <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">Peak Month</div>
                  <div style="font-size: 24px; font-weight: 700; color: var(--gray-700);">Dec</div>
                  <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">-42 gap</div>
                </div>
              </div>
            </div>
            
            <!-- SECTION 3: Key Insights -->
            <div class="summary-section" style="background: linear-gradient(135deg, #F5F3FF 0%, #EDE9FE 100%); border-radius: 12px; padding: 16px; border: 1px solid #DDD6FE; display: flex; flex-direction: column;">
              <div class="summary-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                <span style="font-size: 16px;">🔮</span>
                <span style="font-weight: 600; font-size: 13px; color: #5B21B6;">Key Insights</span>
                <span style="font-size: 8px; background: #8B5CF6; color: white; padding: 2px 5px; border-radius: 3px;">AUTO</span>
                <div style="margin-left: auto; display: flex; gap: 4px;">
                  <button class="table-action-btn" data-tooltip="Pop out" onclick="popOutInsights()" style="font-size: 10px; padding: 4px;">⤢</button>
                  <button class="table-action-btn" data-tooltip="Save" style="font-size: 10px; padding: 4px;">💾</button>
                </div>
              </div>
              
              <div style="flex: 1; display: flex; flex-direction: column; gap: 8px; overflow-y: auto;" id="comparisonInsights">
                <div style="display: flex; align-items: flex-start; gap: 8px; background: white; padding: 10px 12px; border-radius: 6px; font-size: 12px;">
                  <span>📈</span>
                  <span style="color: var(--gray-700); line-height: 1.5;" contenteditable="true">Volume +10% is the <strong>primary driver</strong> of HC gap widening.</span>
                </div>
                <div style="display: flex; align-items: flex-start; gap: 8px; background: white; padding: 10px 12px; border-radius: 6px; font-size: 12px;">
                  <span>⚠️</span>
                  <span style="color: var(--gray-700); line-height: 1.5;" contenteditable="true"><strong>Dec-25</strong> peak gap: -42 HC (highest in period).</span>
                </div>
                <div style="display: flex; align-items: flex-start; gap: 8px; background: white; padding: 10px 12px; border-radius: 6px; font-size: 12px;">
                  <span>⏰</span>
                  <span style="color: var(--gray-700); line-height: 1.5;" contenteditable="true">OT up <strong>24%</strong> — sustainability concern.</span>
                </div>
                <div style="display: flex; align-items: flex-start; gap: 8px; background: white; padding: 10px 12px; border-radius: 6px; font-size: 12px;">
                  <span>💡</span>
                  <span style="color: var(--gray-700); line-height: 1.5;" contenteditable="true"><strong>Rec:</strong> Hire 5 FTE by Oct-25.</span>
                </div>
              </div>
              
              <div style="margin-top: 10px; display: flex; gap: 8px;">
                <button onclick="addComparisonInsight()" style="flex: 1; background: none; border: 1px dashed #8B5CF6; border-radius: 4px; padding: 6px 10px; font-size: 11px; color: #7C3AED; cursor: pointer;">
                  + Add
                </button>
                <button onclick="popOutInsights()" style="flex: 1; background: #8B5CF6; border: none; border-radius: 4px; padding: 6px 10px; font-size: 11px; color: white; cursor: pointer;">
                  ⤢ Expand
                </button>
              </div>
            </div>
          </div>
          
          <!-- View Toggle + Actions Row -->
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px; padding: 10px 16px; background: white; border-radius: 8px; box-shadow: var(--shadow-sm);">
            <span style="font-size: 11px; color: var(--gray-500); font-weight: 600;">VIEW:</span>
            <div style="display: flex; background: var(--gray-100); border-radius: 6px; padding: 2px;">
              <button onclick="setComparisonView('story')" class="comparison-view-btn active" style="padding: 6px 14px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; background: white; box-shadow: var(--shadow-sm); font-weight: 500;">📖 Story</button>
              <button onclick="setComparisonView('table')" class="comparison-view-btn" style="padding: 6px 14px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; background: transparent;">📊 Table</button>
              <button onclick="setComparisonView('graph')" class="comparison-view-btn" style="padding: 6px 14px; font-size: 11px; border-radius: 4px; border: none; cursor: pointer; background: transparent;">📈 Graph</button>
            </div>
            <div style="margin-left: auto; display: flex; align-items: center; gap: 8px;">
              <span style="font-size: 11px; color: var(--gray-500);">📈 Volume Adj: 0% → +10%</span>
              <span style="font-size: 10px; color: var(--gray-400);">✓ Other overlays unchanged</span>
              <button class="table-action-btn" data-tooltip="Export data">📥</button>
              <button class="table-action-btn" data-tooltip="PDF report">📄</button>
            </div>
          </div>
          
          <!-- Story View Content -->
          <div id="comparisonStoryView">
          
          <!-- 1️⃣ VOLUME IMPACT -->
          <div class="table-section" style="margin-bottom: 12px;">
            <div class="table-header" style="background: var(--gusto-teal-light); padding: 8px 12px;">
              <div class="table-title">
                <div class="table-title-icon">1️⃣</div>
                <span>Volume Impact</span>
                <span style="font-size: 11px; color: var(--gray-500); font-weight: normal; margin-left: 8px;">How demand changed</span>
              </div>
            </div>
            <div class="data-grid">
              <table class="data-table" style="font-size: 12px;">
                <thead>
                  <tr style="background: var(--gusto-teal); color: white;">
                    <th style="min-width: 100px; position: sticky; left: 0; background: var(--gusto-teal); z-index: 2; color: white; font-weight: 700; font-size: 12px;">Plan</th>
                    <th style="font-weight: 600; text-align: center;">May-25</th><th style="font-weight: 600; text-align: center;">Jun-25</th><th style="font-weight: 600; text-align: center;">Jul-25</th><th style="font-weight: 600; text-align: center;">Aug-25</th><th style="font-weight: 600; text-align: center;">Sep-25</th><th style="font-weight: 600; text-align: center;">Oct-25</th><th style="font-weight: 600; text-align: center;">Nov-25</th><th style="font-weight: 600; text-align: center;">Dec-25</th><th style="font-weight: 600; text-align: center;">Jan-26</th><th style="font-weight: 600; text-align: center;">Feb-26</th><th style="font-weight: 600; text-align: center;">Mar-26</th><th style="font-weight: 600; text-align: center;">Apr-26</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 500;">📋 Base</td><td style="text-align: center;">19,363</td><td style="text-align: center;">18,500</td><td style="text-align: center;">20,100</td><td style="text-align: center;">21,200</td><td style="text-align: center;">19,800</td><td style="text-align: center;">18,900</td><td style="text-align: center;">17,600</td><td style="text-align: center;">18,200</td><td style="text-align: center;">19,100</td><td style="text-align: center;">20,500</td><td style="text-align: center;">21,800</td><td style="text-align: center;">22,400</td></tr>
                  <tr style="background: var(--gray-50);"><td style="position: sticky; left: 0; background: var(--gray-50); font-weight: 500;">💾 Scenario</td><td style="text-align: center;">21,299</td><td style="text-align: center;">20,350</td><td style="text-align: center;">22,110</td><td style="text-align: center;">23,320</td><td style="text-align: center;">21,780</td><td style="text-align: center;">20,790</td><td style="text-align: center;">19,360</td><td style="text-align: center;">20,020</td><td style="text-align: center;">21,010</td><td style="text-align: center;">22,550</td><td style="text-align: center;">23,980</td><td style="text-align: center;">24,640</td></tr>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 600;">Δ Change</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td><td style="text-align: center; color: var(--gusto-teal); font-weight: 600;">+10%</td></tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- 2️⃣ HC NEED -->
          <div class="table-section" style="margin-bottom: 12px;">
            <div class="table-header" style="background: #EDE9FE; padding: 8px 12px;">
              <div class="table-title">
                <div class="table-title-icon">2️⃣</div>
                <span>HC Need</span>
                <span style="font-size: 11px; color: var(--gray-500); font-weight: normal; margin-left: 8px;">Staff required to meet demand</span>
              </div>
            </div>
            <div class="data-grid">
              <table class="data-table" style="font-size: 12px;">
                <thead>
                  <tr style="background: #7C3AED; color: white;">
                    <th style="min-width: 100px; position: sticky; left: 0; background: #7C3AED; z-index: 2; color: white; font-weight: 700; font-size: 12px;">Plan</th>
                    <th style="font-weight: 600; text-align: center;">May-25</th><th style="font-weight: 600; text-align: center;">Jun-25</th><th style="font-weight: 600; text-align: center;">Jul-25</th><th style="font-weight: 600; text-align: center;">Aug-25</th><th style="font-weight: 600; text-align: center;">Sep-25</th><th style="font-weight: 600; text-align: center;">Oct-25</th><th style="font-weight: 600; text-align: center;">Nov-25</th><th style="font-weight: 600; text-align: center;">Dec-25</th><th style="font-weight: 600; text-align: center;">Jan-26</th><th style="font-weight: 600; text-align: center;">Feb-26</th><th style="font-weight: 600; text-align: center;">Mar-26</th><th style="font-weight: 600; text-align: center;">Apr-26</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 500;">📋 Base</td><td style="text-align: center;">51</td><td style="text-align: center;">50</td><td style="text-align: center;">54</td><td style="text-align: center;">55</td><td style="text-align: center;">52</td><td style="text-align: center;">50</td><td style="text-align: center;">48</td><td style="text-align: center;">49</td><td style="text-align: center;">51</td><td style="text-align: center;">54</td><td style="text-align: center;">57</td><td style="text-align: center;">58</td></tr>
                  <tr style="background: var(--gray-50);"><td style="position: sticky; left: 0; background: var(--gray-50); font-weight: 500;">💾 Scenario</td><td style="text-align: center;">56</td><td style="text-align: center;">55</td><td style="text-align: center;">59</td><td style="text-align: center;">61</td><td style="text-align: center;">57</td><td style="text-align: center;">55</td><td style="text-align: center;">53</td><td style="text-align: center;">54</td><td style="text-align: center;">56</td><td style="text-align: center;">59</td><td style="text-align: center;">63</td><td style="text-align: center;">64</td></tr>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 600;">Δ Change</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+6</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+5</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+6</td><td style="text-align: center; color: #DC2626; font-weight: 600;">+6</td></tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- 3️⃣ STAFFING GAP -->
          <div class="table-section" style="margin-bottom: 12px;">
            <div class="table-header" style="background: var(--gusto-coral-light); padding: 8px 12px;">
              <div class="table-title">
                <div class="table-title-icon">3️⃣</div>
                <span>Staffing Gap</span>
                <span style="font-size: 11px; color: var(--gray-500); font-weight: normal; margin-left: 8px;">Current HC vs Need (negative = short)</span>
              </div>
            </div>
            <div class="data-grid">
              <table class="data-table" style="font-size: 12px;">
                <thead>
                  <tr style="background: var(--gusto-coral); color: white;">
                    <th style="min-width: 100px; position: sticky; left: 0; background: var(--gusto-coral); z-index: 2; color: white; font-weight: 700; font-size: 12px;">Plan</th>
                    <th style="font-weight: 600; text-align: center;">May-25</th><th style="font-weight: 600; text-align: center;">Jun-25</th><th style="font-weight: 600; text-align: center;">Jul-25</th><th style="font-weight: 600; text-align: center;">Aug-25</th><th style="font-weight: 600; text-align: center;">Sep-25</th><th style="font-weight: 600; text-align: center;">Oct-25</th><th style="font-weight: 600; text-align: center;">Nov-25</th><th style="font-weight: 600; text-align: center;">Dec-25</th><th style="font-weight: 600; text-align: center;">Jan-26</th><th style="font-weight: 600; text-align: center;">Feb-26</th><th style="font-weight: 600; text-align: center;">Mar-26</th><th style="font-weight: 600; text-align: center;">Apr-26</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 500;">📋 Base</td><td style="text-align: center; color: #DC2626;">-30</td><td style="text-align: center; color: #DC2626;">-28</td><td style="text-align: center; color: #DC2626;">-32</td><td style="text-align: center; color: #DC2626;">-33</td><td style="text-align: center; color: #DC2626;">-30</td><td style="text-align: center; color: #DC2626;">-28</td><td style="text-align: center; color: #DC2626;">-26</td><td style="text-align: center; color: #DC2626;">-27</td><td style="text-align: center; color: #DC2626;">-29</td><td style="text-align: center; color: #DC2626;">-32</td><td style="text-align: center; color: #DC2626;">-35</td><td style="text-align: center; color: #DC2626;">-36</td></tr>
                  <tr style="background: var(--gray-50);"><td style="position: sticky; left: 0; background: var(--gray-50); font-weight: 500;">💾 Scenario</td><td style="text-align: center; color: #DC2626;">-35</td><td style="text-align: center; color: #DC2626;">-33</td><td style="text-align: center; color: #DC2626;">-37</td><td style="text-align: center; color: #DC2626;">-39</td><td style="text-align: center; color: #DC2626;">-35</td><td style="text-align: center; color: #DC2626;">-33</td><td style="text-align: center; color: #DC2626;">-31</td><td style="text-align: center; color: #DC2626;">-32</td><td style="text-align: center; color: #DC2626;">-34</td><td style="text-align: center; color: #DC2626;">-37</td><td style="text-align: center; color: #DC2626;">-41</td><td style="text-align: center; color: #DC2626;">-42</td></tr>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 600;">Δ Change</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-6</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-5</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-6</td><td style="text-align: center; color: #DC2626; font-weight: 700;">-6</td></tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- 4️⃣ OT COVERAGE -->
          <div class="table-section" style="margin-bottom: 12px;">
            <div class="table-header" style="background: #FEF3C7; padding: 8px 12px;">
              <div class="table-title">
                <div class="table-title-icon">4️⃣</div>
                <span>OT Coverage</span>
                <span style="font-size: 11px; color: var(--gray-500); font-weight: normal; margin-left: 8px;">Hours to cover the gap</span>
              </div>
            </div>
            <div class="data-grid">
              <table class="data-table" style="font-size: 12px;">
                <thead>
                  <tr style="background: #D97706; color: white;">
                    <th style="min-width: 100px; position: sticky; left: 0; background: #D97706; z-index: 2; color: white; font-weight: 700; font-size: 12px;">Plan</th>
                    <th style="font-weight: 600; text-align: center;">May-25</th><th style="font-weight: 600; text-align: center;">Jun-25</th><th style="font-weight: 600; text-align: center;">Jul-25</th><th style="font-weight: 600; text-align: center;">Aug-25</th><th style="font-weight: 600; text-align: center;">Sep-25</th><th style="font-weight: 600; text-align: center;">Oct-25</th><th style="font-weight: 600; text-align: center;">Nov-25</th><th style="font-weight: 600; text-align: center;">Dec-25</th><th style="font-weight: 600; text-align: center;">Jan-26</th><th style="font-weight: 600; text-align: center;">Feb-26</th><th style="font-weight: 600; text-align: center;">Mar-26</th><th style="font-weight: 600; text-align: center;">Apr-26</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 500;">📋 Base</td><td style="text-align: center;">225</td><td style="text-align: center;">210</td><td style="text-align: center;">240</td><td style="text-align: center;">248</td><td style="text-align: center;">225</td><td style="text-align: center;">210</td><td style="text-align: center;">195</td><td style="text-align: center;">203</td><td style="text-align: center;">218</td><td style="text-align: center;">240</td><td style="text-align: center;">263</td><td style="text-align: center;">270</td></tr>
                  <tr style="background: var(--gray-50);"><td style="position: sticky; left: 0; background: var(--gray-50); font-weight: 500;">💾 Scenario</td><td style="text-align: center;">280</td><td style="text-align: center;">262</td><td style="text-align: center;">295</td><td style="text-align: center;">310</td><td style="text-align: center;">280</td><td style="text-align: center;">262</td><td style="text-align: center;">247</td><td style="text-align: center;">255</td><td style="text-align: center;">272</td><td style="text-align: center;">295</td><td style="text-align: center;">325</td><td style="text-align: center;">335</td></tr>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 600;">Δ Change</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+55</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+52</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+55</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+62</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+55</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+52</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+52</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+52</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+54</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+55</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+62</td><td style="text-align: center; color: #DC2626; font-weight: 700;">+65</td></tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- 5️⃣ FINAL POSITION - THE BOTTOM LINE -->
          <div class="table-section" style="margin-bottom: 12px; border: 3px solid #10B981;">
            <div class="table-header" style="background: #D1FAE5; padding: 8px 12px;">
              <div class="table-title">
                <div class="table-title-icon">5️⃣</div>
                <span>Final Position</span>
                <span style="background: #10B981; color: white; padding: 3px 10px; border-radius: 10px; font-size: 10px; margin-left: 8px;">THE BOTTOM LINE</span>
                <span style="font-size: 11px; color: var(--gray-500); font-weight: normal; margin-left: 8px;">Gap after OT • Closer to 0 = better</span>
              </div>
            </div>
            <div class="data-grid">
              <table class="data-table" style="font-size: 13px;">
                <thead>
                  <tr style="background: #10B981; color: white;">
                    <th style="min-width: 100px; position: sticky; left: 0; background: #10B981; z-index: 2; color: white; font-weight: 700; font-size: 13px;">Plan</th>
                    <th style="font-weight: 700; text-align: center;">May-25</th><th style="font-weight: 700; text-align: center;">Jun-25</th><th style="font-weight: 700; text-align: center;">Jul-25</th><th style="font-weight: 700; text-align: center;">Aug-25</th><th style="font-weight: 700; text-align: center;">Sep-25</th><th style="font-weight: 700; text-align: center;">Oct-25</th><th style="font-weight: 700; text-align: center;">Nov-25</th><th style="font-weight: 700; text-align: center;">Dec-25</th><th style="font-weight: 700; text-align: center;">Jan-26</th><th style="font-weight: 700; text-align: center;">Feb-26</th><th style="font-weight: 700; text-align: center;">Mar-26</th><th style="font-weight: 700; text-align: center;">Apr-26</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style="position: sticky; left: 0; background: white; font-weight: 600;">📋 Base</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-22</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-21</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-24</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-25</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-22</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-21</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-19</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-20</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-22</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-24</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-27</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-28</td></tr>
                  <tr style="background: var(--gray-50);"><td style="position: sticky; left: 0; background: var(--gray-50); font-weight: 600;">💾 Scenario</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-27</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-26</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-29</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-31</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-27</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-26</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-24</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-25</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-27</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-29</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-33</td><td style="text-align: center; color: #DC2626; font-weight: 700; font-size: 14px;">-34</td></tr>
                  <tr style="background: #FEE2E2;"><td style="position: sticky; left: 0; background: #FEE2E2; font-weight: 700;">Δ Impact</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-6</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-5</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-6</td><td style="text-align: center; color: #991B1B; font-weight: 800; font-size: 14px;">-6</td></tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- Full 24-Month Detail Table (Collapsible) -->
          <div class="table-section">
            <div class="table-header" style="cursor: pointer; background: var(--gray-100);" onclick="const content = this.nextElementSibling; const arrow = this.querySelector('.expand-arrow'); const isHidden = content.style.display === 'none'; content.style.display = isHidden ? 'block' : 'none'; arrow.textContent = isHidden ? '▼' : '▶';">
              <div class="table-title">
                <span class="expand-arrow" style="margin-right: 8px; font-size: 12px;">▼</span>
                <div class="table-title-icon">📋</div>
                <span>Full 24-Month Detailed View</span>
                <span style="font-size: 11px; color: var(--gray-500); font-weight: normal; margin-left: 8px;">Click to expand/collapse</span>
              </div>
            </div>
            <div class="data-grid scrollable" style="max-height: 400px;">
              <table class="data-table" style="font-size: 12px;">
                <thead>
                  <tr style="background: var(--gusto-teal); color: white; font-size: 12px;">
                    <th style="min-width: 180px; position: sticky; left: 0; background: var(--gusto-teal); z-index: 11; color: white; padding: 10px 12px;">Metric</th>
                    <th style="padding: 10px 8px;">May-25</th><th style="padding: 10px 8px;">Jun-25</th><th style="padding: 10px 8px;">Jul-25</th><th style="padding: 10px 8px;">Aug-25</th><th style="padding: 10px 8px;">Sep-25</th><th style="padding: 10px 8px;">Oct-25</th>
                    <th style="padding: 10px 8px;">Nov-25</th><th style="padding: 10px 8px;">Dec-25</th><th style="padding: 10px 8px;">Jan-26</th><th style="padding: 10px 8px;">Feb-26</th><th style="padding: 10px 8px;">Mar-26</th><th style="padding: 10px 8px;">Apr-26</th>
                    <th style="padding: 10px 8px;">May-26</th><th style="padding: 10px 8px;">Jun-26</th><th style="padding: 10px 8px;">Jul-26</th><th style="padding: 10px 8px;">Aug-26</th><th style="padding: 10px 8px;">Sep-26</th><th style="padding: 10px 8px;">Oct-26</th>
                    <th style="padding: 10px 8px;">Nov-26</th><th style="padding: 10px 8px;">Dec-26</th><th style="padding: 10px 8px;">Jan-27</th><th style="padding: 10px 8px;">Feb-27</th><th style="padding: 10px 8px;">Mar-27</th><th style="padding: 10px 8px;">Apr-27</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- VOLUME SECTION -->
                  <tr class="row-section-header" style="cursor: pointer;" onclick="toggleComparisonSection(this)">
                    <td colspan="25" style="position: sticky; left: 0; background: var(--gray-100); padding: 10px 12px; font-size: 13px;"><span style="margin-right: 8px;">▼</span>📈 Volume - Active</td>
                  </tr>
                  <tr>
                    <td style="position: sticky; left: 0; background: white; font-weight: 500; min-width: 180px; padding: 8px 12px;">📋 Published v3.2</td>
                    <td>19,363</td><td>18,500</td><td>20,100</td><td>21,200</td><td>19,800</td><td>18,900</td>
                    <td>17,600</td><td>18,200</td><td>19,100</td><td>20,500</td><td>21,800</td><td>22,400</td>
                    <td>19,800</td><td>19,000</td><td>20,600</td><td>21,800</td><td>20,300</td><td>19,400</td>
                    <td>18,100</td><td>18,700</td><td>19,600</td><td>21,000</td><td>22,300</td><td>22,900</td>
                  </tr>
                  <tr style="background: #EEF2FF;">
                    <td style="position: sticky; left: 0; background: #EEF2FF; font-weight: 500; min-width: 180px; padding: 8px 12px;">💾 +10% Vol Scenario</td>
                    <td>21,299</td><td>20,350</td><td>22,110</td><td>23,320</td><td>21,780</td><td>20,790</td>
                    <td>19,360</td><td>20,020</td><td>21,010</td><td>22,550</td><td>23,980</td><td>24,640</td>
                    <td>21,780</td><td>20,900</td><td>22,660</td><td>23,980</td><td>22,330</td><td>21,340</td>
                    <td>19,910</td><td>20,570</td><td>21,560</td><td>23,100</td><td>24,530</td><td>25,190</td>
                  </tr>
                  <tr style="font-weight: 600; background: #FEE2E2;">
                    <td style="position: sticky; left: 0; background: #FEE2E2; color: #991B1B; min-width: 180px; padding: 8px 12px;">Δ Difference ↑</td>
                    <td>+1,936</td><td>+1,850</td><td>+2,010</td><td>+2,120</td><td>+1,980</td><td>+1,890</td>
                    <td>+1,760</td><td>+1,820</td><td>+1,910</td><td>+2,050</td><td>+2,180</td><td>+2,240</td>
                    <td>+1,980</td><td>+1,900</td><td>+2,060</td><td>+2,180</td><td>+2,030</td><td>+1,940</td>
                    <td>+1,810</td><td>+1,870</td><td>+1,960</td><td>+2,100</td><td>+2,230</td><td>+2,290</td>
                  </tr>
                  
                  <!-- HC NEED SECTION -->
                  <tr class="row-section-header" style="cursor: pointer;" onclick="toggleComparisonSection(this)">
                    <td colspan="25" style="position: sticky; left: 0; background: var(--gray-100); padding: 10px 12px; font-size: 13px;"><span style="margin-right: 8px;">▼</span>🎯 HC Need (Active)</td>
                  </tr>
                  <tr>
                    <td style="position: sticky; left: 0; background: white; font-weight: 500; min-width: 180px; padding: 8px 12px;">📋 Published v3.2</td>
                    <td>51</td><td>50</td><td>54</td><td>55</td><td>52</td><td>50</td>
                    <td>48</td><td>49</td><td>51</td><td>54</td><td>57</td><td>58</td>
                    <td>52</td><td>51</td><td>55</td><td>56</td><td>53</td><td>51</td>
                    <td>49</td><td>50</td><td>52</td><td>55</td><td>58</td><td>59</td>
                  </tr>
                  <tr style="background: #EEF2FF;">
                    <td style="position: sticky; left: 0; background: #EEF2FF; font-weight: 500; min-width: 180px; padding: 8px 12px;">💾 +10% Vol Scenario</td>
                    <td>56</td><td>55</td><td>59</td><td>61</td><td>57</td><td>55</td>
                    <td>53</td><td>54</td><td>56</td><td>59</td><td>63</td><td>64</td>
                    <td>57</td><td>56</td><td>61</td><td>62</td><td>58</td><td>56</td>
                    <td>54</td><td>55</td><td>57</td><td>61</td><td>64</td><td>65</td>
                  </tr>
                  <tr style="font-weight: 600; background: #FEE2E2;">
                    <td style="position: sticky; left: 0; background: #FEE2E2; color: #991B1B; min-width: 180px; padding: 8px 12px;">Δ Difference ↑</td>
                    <td>+5</td><td>+5</td><td>+5</td><td>+6</td><td>+5</td><td>+5</td>
                    <td>+5</td><td>+5</td><td>+5</td><td>+5</td><td>+6</td><td>+6</td>
                    <td>+5</td><td>+5</td><td>+6</td><td>+6</td><td>+5</td><td>+5</td>
                    <td>+5</td><td>+5</td><td>+5</td><td>+6</td><td>+6</td><td>+6</td>
                  </tr>
                  
                  <!-- NET STAFFING SECTION -->
                  <tr class="row-section-header" style="cursor: pointer;" onclick="toggleComparisonSection(this)">
                    <td colspan="25" style="position: sticky; left: 0; background: var(--gray-100); padding: 10px 12px; font-size: 13px;"><span style="margin-right: 8px;">▼</span>📊 Net Staffing Gap</td>
                  </tr>
                  <tr>
                    <td style="position: sticky; left: 0; background: white; font-weight: 500; min-width: 180px; padding: 8px 12px;">📋 Published v3.2</td>
                    <td class="gap-negative">-30</td><td class="gap-negative">-28</td><td class="gap-negative">-32</td><td class="gap-negative">-33</td><td class="gap-negative">-30</td><td class="gap-negative">-28</td>
                    <td class="gap-negative">-26</td><td class="gap-negative">-27</td><td class="gap-negative">-29</td><td class="gap-negative">-32</td><td class="gap-negative">-35</td><td class="gap-negative">-36</td>
                    <td class="gap-negative">-30</td><td class="gap-negative">-29</td><td class="gap-negative">-33</td><td class="gap-negative">-34</td><td class="gap-negative">-31</td><td class="gap-negative">-29</td>
                    <td class="gap-negative">-27</td><td class="gap-negative">-28</td><td class="gap-negative">-30</td><td class="gap-negative">-33</td><td class="gap-negative">-36</td><td class="gap-negative">-37</td>
                  </tr>
                  <tr style="background: #EEF2FF;">
                    <td style="position: sticky; left: 0; background: #EEF2FF; font-weight: 500; min-width: 180px; padding: 8px 12px;">💾 +10% Vol Scenario</td>
                    <td class="gap-negative">-35</td><td class="gap-negative">-33</td><td class="gap-negative">-37</td><td class="gap-negative">-39</td><td class="gap-negative">-35</td><td class="gap-negative">-33</td>
                    <td class="gap-negative">-31</td><td class="gap-negative">-32</td><td class="gap-negative">-34</td><td class="gap-negative">-37</td><td class="gap-negative">-41</td><td class="gap-negative">-42</td>
                    <td class="gap-negative">-35</td><td class="gap-negative">-34</td><td class="gap-negative">-39</td><td class="gap-negative">-40</td><td class="gap-negative">-36</td><td class="gap-negative">-34</td>
                    <td class="gap-negative">-32</td><td class="gap-negative">-33</td><td class="gap-negative">-35</td><td class="gap-negative">-39</td><td class="gap-negative">-42</td><td class="gap-negative">-43</td>
                  </tr>
                  <tr style="font-weight: 600; background: #FEE2E2;">
                    <td style="position: sticky; left: 0; background: #FEE2E2; color: #991B1B; min-width: 180px; padding: 8px 12px;">Δ Difference ↓</td>
                    <td>-5</td><td>-5</td><td>-5</td><td>-6</td><td>-5</td><td>-5</td>
                    <td>-5</td><td>-5</td><td>-5</td><td>-5</td><td>-6</td><td>-6</td>
                    <td>-5</td><td>-5</td><td>-6</td><td>-6</td><td>-5</td><td>-5</td>
                    <td>-5</td><td>-5</td><td>-5</td><td>-6</td><td>-6</td><td>-6</td>
                  </tr>
                  
                  <!-- REQUIRED OT SECTION -->
                  <tr class="row-section-header" style="cursor: pointer;" onclick="toggleComparisonSection(this)">
                    <td colspan="25" style="position: sticky; left: 0; background: var(--gray-100); padding: 10px 12px; font-size: 13px;"><span style="margin-right: 8px;">▼</span>⏰ Required OT Hours</td>
                  </tr>
                  <tr>
                    <td style="position: sticky; left: 0; background: white; font-weight: 500; min-width: 180px; padding: 8px 12px;">📋 Published v3.2</td>
                    <td>225</td><td>210</td><td>240</td><td>248</td><td>225</td><td>210</td>
                    <td>195</td><td>203</td><td>218</td><td>240</td><td>263</td><td>270</td>
                    <td>225</td><td>218</td><td>248</td><td>255</td><td>233</td><td>218</td>
                    <td>203</td><td>210</td><td>225</td><td>248</td><td>270</td><td>278</td>
                  </tr>
                  <tr style="background: #EEF2FF;">
                    <td style="position: sticky; left: 0; background: #EEF2FF; font-weight: 500; min-width: 180px; padding: 8px 12px;">💾 +10% Vol Scenario</td>
                    <td>280</td><td>262</td><td>295</td><td>310</td><td>280</td><td>262</td>
                    <td>247</td><td>255</td><td>272</td><td>295</td><td>325</td><td>335</td>
                    <td>280</td><td>270</td><td>308</td><td>318</td><td>290</td><td>272</td>
                    <td>255</td><td>263</td><td>280</td><td>308</td><td>335</td><td>345</td>
                  </tr>
                  <tr style="font-weight: 600; background: #FEE2E2;">
                    <td style="position: sticky; left: 0; background: #FEE2E2; color: #991B1B; min-width: 180px; padding: 8px 12px;">Δ Difference ↑</td>
                    <td>+55</td><td>+52</td><td>+55</td><td>+62</td><td>+55</td><td>+52</td>
                    <td>+52</td><td>+52</td><td>+54</td><td>+55</td><td>+62</td><td>+65</td>
                    <td>+55</td><td>+52</td><td>+60</td><td>+63</td><td>+57</td><td>+54</td>
                    <td>+52</td><td>+53</td><td>+55</td><td>+60</td><td>+65</td><td>+67</td>
                  </tr>
                  
                  <!-- NET + OT SECTION -->
                  <tr class="row-section-header" style="cursor: pointer;" onclick="toggleComparisonSection(this)">
                    <td colspan="25" style="position: sticky; left: 0; background: var(--gray-100); padding: 10px 12px; font-size: 13px;"><span style="margin-right: 8px;">▼</span>📊 Net Staffing + OT</td>
                  </tr>
                  <tr>
                    <td style="position: sticky; left: 0; background: white; font-weight: 500; min-width: 180px; padding: 8px 12px;">📋 Published v3.2</td>
                    <td class="gap-negative">-22</td><td class="gap-negative">-21</td><td class="gap-negative">-24</td><td class="gap-negative">-25</td><td class="gap-negative">-22</td><td class="gap-negative">-21</td>
                    <td class="gap-negative">-19</td><td class="gap-negative">-20</td><td class="gap-negative">-22</td><td class="gap-negative">-24</td><td class="gap-negative">-27</td><td class="gap-negative">-28</td>
                    <td class="gap-negative">-22</td><td class="gap-negative">-21</td><td class="gap-negative">-25</td><td class="gap-negative">-26</td><td class="gap-negative">-23</td><td class="gap-negative">-21</td>
                    <td class="gap-negative">-20</td><td class="gap-negative">-21</td><td class="gap-negative">-22</td><td class="gap-negative">-25</td><td class="gap-negative">-28</td><td class="gap-negative">-29</td>
                  </tr>
                  <tr style="background: #EEF2FF;">
                    <td style="position: sticky; left: 0; background: #EEF2FF; font-weight: 500; min-width: 180px; padding: 8px 12px;">💾 +10% Vol Scenario</td>
                    <td class="gap-negative">-27</td><td class="gap-negative">-26</td><td class="gap-negative">-29</td><td class="gap-negative">-31</td><td class="gap-negative">-27</td><td class="gap-negative">-26</td>
                    <td class="gap-negative">-24</td><td class="gap-negative">-25</td><td class="gap-negative">-27</td><td class="gap-negative">-29</td><td class="gap-negative">-33</td><td class="gap-negative">-34</td>
                    <td class="gap-negative">-27</td><td class="gap-negative">-26</td><td class="gap-negative">-31</td><td class="gap-negative">-32</td><td class="gap-negative">-28</td><td class="gap-negative">-26</td>
                    <td class="gap-negative">-25</td><td class="gap-negative">-26</td><td class="gap-negative">-27</td><td class="gap-negative">-31</td><td class="gap-negative">-34</td><td class="gap-negative">-35</td>
                  </tr>
                  <tr style="font-weight: 600; background: #FEE2E2;">
                    <td style="position: sticky; left: 0; background: #FEE2E2; color: #991B1B; min-width: 180px; padding: 8px 12px;">Δ Difference ↓</td>
                    <td>-5</td><td>-5</td><td>-5</td><td>-6</td><td>-5</td><td>-5</td>
                    <td>-5</td><td>-5</td><td>-5</td><td>-5</td><td>-6</td><td>-6</td>
                    <td>-5</td><td>-5</td><td>-6</td><td>-6</td><td>-5</td><td>-5</td>
                    <td>-5</td><td>-5</td><td>-5</td><td>-6</td><td>-6</td><td>-6</td>
                  </tr>
                  
                  <!-- OVERLAY COMPARISON SECTION -->
                  <tr class="row-section-header" style="cursor: pointer;" onclick="toggleComparisonSection(this)">
                    <td colspan="25" style="position: sticky; left: 0; background: var(--gray-100); padding: 10px 12px; font-size: 13px;"><span style="margin-right: 8px;">▼</span>🎚️ Overlay Settings Comparison</td>
                  </tr>
                  <tr>
                    <td style="position: sticky; left: 0; background: white; min-width: 180px; padding: 8px 12px;">Volume Adj - Base</td>
                    <td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td>
                    <td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td>
                    <td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td>
                    <td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td><td>0%</td>
                  </tr>
                  <tr style="background: #EEF2FF;">
                    <td style="position: sticky; left: 0; background: #EEF2FF; min-width: 180px; padding: 8px 12px;">Volume Adj - Scenario</td>
                    <td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td>
                    <td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td>
                    <td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td>
                    <td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td><td>+10%</td>
                  </tr>
                  <tr>
                    <td style="position: sticky; left: 0; background: white; min-width: 180px; padding: 8px 12px;">Shrink % - Base</td>
                    <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                    <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                    <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                    <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                  </tr>
                  <tr style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50); min-width: 180px; padding: 8px 12px;">Shrink % - Scenario</td>
                    <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                    <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                    <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                    <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                  </tr>
                  <tr>
                    <td style="position: sticky; left: 0; background: white; min-width: 180px; padding: 8px 12px;">SL Target - Base</td>
                    <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                    <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                    <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                    <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                  </tr>
                  <tr style="background: var(--gray-50);">
                    <td style="position: sticky; left: 0; background: var(--gray-50); min-width: 180px; padding: 8px 12px;">SL Target - Scenario</td>
                    <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                    <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                    <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                    <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          </div><!-- End Story View -->
          
          <!-- Table View (shown when Table is selected) -->
          <div id="comparisonTableView" style="display: none;">
            <div class="table-section">
              <div class="table-header" style="background: var(--gray-100);">
                <div class="table-title">
                  <div class="table-title-icon">📊</div>
                  <span>Full Comparison Table</span>
                  <span style="font-size: 11px; color: var(--gray-500); font-weight: normal; margin-left: 8px;">All metrics in one view</span>
                </div>
              </div>
              <div style="padding: 40px; text-align: center; color: var(--gray-500);">
                <div style="font-size: 48px; margin-bottom: 16px;">📊</div>
                <p style="font-size: 14px;">Table View shows all comparison data in a single comprehensive spreadsheet.</p>
                <p style="font-size: 12px; color: var(--gray-400);">Full implementation coming in production build.</p>
              </div>
            </div>
          </div>
          
          <!-- Graph View (shown when Graph is selected) -->
          <div id="comparisonGraphView" style="display: none;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
              <div class="table-section">
                <div class="table-header" style="background: var(--gusto-teal-light);">
                  <div class="table-title">
                    <div class="table-title-icon">📈</div>
                    <span>Volume Comparison</span>
                  </div>
                </div>
                <div style="padding: 24px; text-align: center;">
                  <div style="background: var(--gray-50); border-radius: 8px; height: 200px; display: flex; align-items: center; justify-content: center; color: var(--gray-400);">
                    [Volume Line Chart: Base vs Scenario]
                  </div>
                </div>
              </div>
              <div class="table-section">
                <div class="table-header" style="background: #EDE9FE;">
                  <div class="table-title">
                    <div class="table-title-icon">📈</div>
                    <span>HC Need Comparison</span>
                  </div>
                </div>
                <div style="padding: 24px; text-align: center;">
                  <div style="background: var(--gray-50); border-radius: 8px; height: 200px; display: flex; align-items: center; justify-content: center; color: var(--gray-400);">
                    [HC Need Line Chart: Base vs Scenario]
                  </div>
                </div>
              </div>
              <div class="table-section">
                <div class="table-header" style="background: var(--gusto-coral-light);">
                  <div class="table-title">
                    <div class="table-title-icon">📈</div>
                    <span>Staffing Gap Trend</span>
                  </div>
                </div>
                <div style="padding: 24px; text-align: center;">
                  <div style="background: var(--gray-50); border-radius: 8px; height: 200px; display: flex; align-items: center; justify-content: center; color: var(--gray-400);">
                    [Gap Area Chart: Base vs Scenario]
                  </div>
                </div>
              </div>
              <div class="table-section">
                <div class="table-header" style="background: #FEF3C7;">
                  <div class="table-title">
                    <div class="table-title-icon">📈</div>
                    <span>OT Hours Required</span>
                  </div>
                </div>
                <div style="padding: 24px; text-align: center;">
                  <div style="background: var(--gray-50); border-radius: 8px; height: 200px; display: flex; align-items: center; justify-content: center; color: var(--gray-400);">
                    [OT Bar Chart: Base vs Scenario]
                  </div>
                </div>
              </div>
            </div>
          </div>
          
        </div>
        
        <!-- ═══════════════════════════════════════════════════════════════
             VIEW: PILLAR EDITOR (Current content)
             ═══════════════════════════════════════════════════════════════ -->
        <div id="view-pillar" class="view-container" style="display: none;">
        
        <!-- Pillar Header -->
        <div style="display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-lg); flex-wrap: wrap;">
          <h2 id="pillarViewTitle" style="display: flex; align-items: center; gap: var(--space-sm); margin: 0;">
            🏛️ <span id="pillarNameDisplay">Accountant</span> Pillar
          </h2>
          <span class="badge" style="background: var(--success-bg); color: var(--success); font-size: 11px; padding: 4px 10px; border-radius: 12px;">Ready</span>
          <span style="font-size: 12px; color: var(--gray-500);">On-Demand • 3 channels</span>
          <button class="btn btn-secondary" style="margin-left: auto; font-size: 12px;" onclick="openEditPillarModal(currentPillar, 'On-Demand')" data-tooltip="Edit name, org, channels & owner">⚙️ Settings</button>
        </div>
        
        <!-- Loading Overlay -->
        <div id="pillarLoadingOverlay" class="loading-overlay" style="display: none;">
          <div class="loading-spinner"></div>
          <div class="loading-text">Loading pillar data...</div>
        </div>
        
        <!-- ═══════════════════════════════════════════════════════════════
             PILLAR SUMMARY - Quad Layout with Stats & Graph
             ═══════════════════════════════════════════════════════════════ -->
        <div class="pillar-summary-grid">
          <!-- LEFT: Key Metrics Quad -->
          <div class="summary-section" style="display: flex; flex-direction: column;">
            <div class="summary-header" style="display: flex; align-items: center; gap: 10px;">
              <h3 style="font-size: 14px; margin: 0;">📊 Key Metrics</h3>
              <select id="statCardMonth" onchange="updateAllStatCardMonths(this.value)" class="month-select" style="font-size: 11px; padding: 3px 8px;">
                <option value="dec24">Dec-24</option>
                <option value="jan25" selected>Jan-25</option>
                <option value="feb25">Feb-25</option>
                <option value="mar25">Mar-25</option>
                <option value="apr25">Apr-25</option>
                <option value="may25">May-25</option>
                <option value="jun25">Jun-25</option>
                <option value="jul25">Jul-25</option>
                <option value="aug25">Aug-25</option>
                <option value="sep25">Sep-25</option>
                <option value="oct25">Oct-25</option>
                <option value="nov25">Nov-25</option>
                <option value="dec25">Dec-25</option>
                <option value="jan26">Jan-26</option>
                <option value="feb26">Feb-26</option>
                <option value="mar26">Mar-26</option>
                <option value="apr26">Apr-26</option>
                <option value="may26">May-26</option>
                <option value="jun26">Jun-26</option>
                <option value="jul26">Jul-26</option>
                <option value="aug26">Aug-26</option>
                <option value="sep26">Sep-26</option>
                <option value="oct26">Oct-26</option>
                <option value="nov26">Nov-26</option>
              </select>
            </div>
            <div class="metrics-quad">
              <div class="metric-tile teal">
                <div class="metric-label">Active HC Need</div>
                <div class="metric-value">51</div>
                <div class="metric-delta positive">+2 overlays</div>
              </div>
              <div class="metric-tile coral">
                <div class="metric-label">Net Staffing</div>
                <div class="metric-value">-26</div>
                <div class="metric-delta negative">Understaffed</div>
              </div>
              <div class="metric-tile green">
                <div class="metric-label">Net + OT</div>
                <div class="metric-value">-18</div>
                <div class="metric-delta positive">+8 from OT</div>
              </div>
              <div class="metric-tile gray">
                <div class="metric-label">New Hires</div>
                <div class="metric-value">4</div>
                <div class="metric-delta">Productive next mo</div>
              </div>
            </div>
          </div>
          
          <!-- CENTER: Trend Chart -->
          <div class="summary-section" style="display: flex; flex-direction: column;">
            <div class="summary-header" style="display: flex; align-items: center; gap: 10px;">
              <h3 style="font-size: 14px; margin: 0;">📈 Trend</h3>
              <select id="trendMetric" onchange="updateTrendChart(this.value)" class="month-select" style="font-size: 11px; padding: 3px 8px;">
                <option value="hc_need" selected>HC Need</option>
                <option value="net_staffing">Net Staffing</option>
                <option value="volume">Volume</option>
                <option value="aht">AHT</option>
                <option value="productive_hc">Productive HC</option>
              </select>
              <button class="expand-btn" onclick="expandChart()" data-tooltip="Expand chart" style="font-size: 14px; margin-left: auto;">⛶</button>
            </div>
            <div class="trend-chart-container" id="trendChartContainer">
              <!-- Dynamic SVG Chart - Fills container with minimal margins -->
              <svg viewBox="0 0 500 150" class="trend-chart" id="trendChartSvg" preserveAspectRatio="xMidYMid meet">
                <!-- Grid background -->
                <rect x="35" y="8" width="455" height="110" fill="#fafafa"/>
                
                <!-- Horizontal grid lines (evenly spaced) -->
                <line x1="35" y1="8" x2="490" y2="8" stroke="#e0e0e0" stroke-width="1"/>
                <line x1="35" y1="35" x2="490" y2="35" stroke="#e8e8e8" stroke-width="1" stroke-dasharray="3"/>
                <line x1="35" y1="63" x2="490" y2="63" stroke="#e8e8e8" stroke-width="1" stroke-dasharray="3"/>
                <line x1="35" y1="90" x2="490" y2="90" stroke="#e8e8e8" stroke-width="1" stroke-dasharray="3"/>
                <line x1="35" y1="118" x2="490" y2="118" stroke="#e0e0e0" stroke-width="1"/>
                
                <!-- Y-axis line -->
                <line x1="35" y1="8" x2="35" y2="118" stroke="#ccc" stroke-width="1"/>
                
                <!-- HC Need line (teal) - maps HC 20-60 to Y 118-8 -->
                <polyline id="chartLine1"
                  fill="none" 
                  stroke="#0a8080" 
                  stroke-width="2.5"
                  points="45,33 85,38 125,27 165,19 205,30 245,36 285,41 325,36 365,30 405,22 445,14 485,8"
                />
                
                <!-- Actual HC line (coral) - maps HC 20-60 to Y 118-8 -->
                <polyline id="chartLine2"
                  fill="none" 
                  stroke="#f45d48" 
                  stroke-width="2"
                  stroke-dasharray="5,2"
                  points="45,115 85,110 125,99 165,91 205,82 245,77 285,72 325,66 365,58 405,49 445,44 485,38"
                />
                
                <!-- Data points for HC Need line -->
                <g id="chartPoints1" fill="#0a8080">
                  <circle cx="45" cy="33" r="3.5"/><circle cx="85" cy="38" r="3.5"/><circle cx="125" cy="27" r="3.5"/>
                  <circle cx="165" cy="19" r="3.5"/><circle cx="205" cy="30" r="3.5"/><circle cx="245" cy="36" r="3.5"/>
                  <circle cx="285" cy="41" r="3.5"/><circle cx="325" cy="36" r="3.5"/><circle cx="365" cy="30" r="3.5"/>
                  <circle cx="405" cy="22" r="3.5"/><circle cx="445" cy="14" r="3.5"/><circle cx="485" cy="8" r="3.5"/>
                </g>
                
                <!-- Y-axis labels (evenly spaced: 60, 50, 40, 30, 20) -->
                <text x="32" y="12" text-anchor="end" font-size="8" fill="#888">60</text>
                <text x="32" y="39" text-anchor="end" font-size="8" fill="#888">50</text>
                <text x="32" y="67" text-anchor="end" font-size="8" fill="#888">40</text>
                <text x="32" y="94" text-anchor="end" font-size="8" fill="#888">30</text>
                <text x="32" y="121" text-anchor="end" font-size="8" fill="#888">20</text>
                
                <!-- X-axis month labels -->
                <g font-size="7" fill="#888" text-anchor="middle">
                  <text x="45" y="130">Dec</text>
                  <text x="85" y="130">Jan</text>
                  <text x="125" y="130">Feb</text>
                  <text x="165" y="130">Mar</text>
                  <text x="205" y="130">Apr</text>
                  <text x="245" y="130">May</text>
                  <text x="285" y="130">Jun</text>
                  <text x="325" y="130">Jul</text>
                  <text x="365" y="130">Aug</text>
                  <text x="405" y="130">Sep</text>
                  <text x="445" y="130">Oct</text>
                  <text x="485" y="130">Nov</text>
                </g>
                
                <!-- Chart title -->
                <text id="chartTitle" x="265" y="145" text-anchor="middle" font-size="9" fill="#666" font-weight="500">
                  HC Need vs Actual HC
                </text>
              </svg>
              
              <!-- Dynamic Legend -->
              <div class="chart-legend" id="chartLegend">
                <div class="legend-item">
                  <span class="legend-line teal"></span>
                  <span id="legend1Text">HC Need</span>
                </div>
                <div class="legend-item">
                  <span class="legend-line coral dashed"></span>
                  <span id="legend2Text">Actual HC</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- RIGHT: Pillar Insights (Auto-Generated) -->
          <div class="summary-section" style="background: linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%); border-radius: 12px; padding: 12px; border: 1px solid #FED7AA; display: flex; flex-direction: column;">
            <div class="summary-header" style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
              <span style="font-size: 14px;">🔮</span>
              <span style="font-weight: 600; font-size: 12px; color: #9A3412;">Pillar Insights</span>
              <span style="font-size: 8px; background: #F97316; color: white; padding: 2px 5px; border-radius: 3px;">AUTO</span>
              <div style="margin-left: auto; display: flex; gap: 4px;">
                <button class="table-action-btn" data-tooltip="Pop out" onclick="popOutPillarInsights()" style="font-size: 10px; padding: 4px;">⤢</button>
                <button class="table-action-btn" data-tooltip="Save" style="font-size: 10px; padding: 4px;">💾</button>
            </div>
                  </div>
            
            <div style="flex: 1; display: flex; flex-direction: column; gap: 6px; overflow-y: auto;" id="pillarInsights">
              <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                <span>📈</span>
                <span style="color: var(--gray-700); line-height: 1.4;" contenteditable="true"><strong>Jan-25</strong> peak: 5 additional HC needed for tax season.</span>
                </div>
              <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                <span>⚠️</span>
                <span style="color: var(--gray-700); line-height: 1.4;" contenteditable="true"><strong>AHT</strong> trending up 3% — monitor training effectiveness.</span>
                  </div>
              <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                <span>📞</span>
                <span style="color: var(--gray-700); line-height: 1.4;" contenteditable="true"><strong>Phone</strong> SL at risk in Dec — consider OT approval.</span>
                </div>
              <div style="display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px;">
                <span>💡</span>
                <span style="color: var(--gray-700); line-height: 1.4;" contenteditable="true"><strong>Rec:</strong> Start hiring process by Oct for Dec readiness.</span>
              </div>
                    </div>
            
            <div style="margin-top: 8px; display: flex; gap: 6px;">
              <button onclick="addPillarInsight()" style="flex: 1; background: none; border: 1px dashed #F97316; border-radius: 4px; padding: 5px 8px; font-size: 10px; color: #9A3412; cursor: pointer;">
                + Add
              </button>
              <button onclick="popOutPillarInsights()" style="flex: 1; background: #F97316; border: none; border-radius: 4px; padding: 5px 8px; font-size: 10px; color: white; cursor: pointer;">
                ⤢ Expand
              </button>
            </div>
          </div>
        </div>
        
        <!-- Plan Status Footer Bar -->
        <div class="plan-status-footer" style="display: flex; justify-content: space-between; align-items: center; padding: 6px 12px; background: var(--gray-50); border-radius: var(--radius-sm); margin-bottom: var(--space-sm); font-size: 10px; border: 1px solid var(--gray-100);">
          <div style="display: flex; gap: 16px; align-items: center;">
            <span style="color: var(--gray-500);">💾 Last Saved: <strong style="color: var(--gray-700);">Today 2:15 PM</strong></span>
            <span style="color: var(--gray-500);">📋 Published: <strong style="color: var(--success);">Dec 5</strong></span>
            <span style="color: var(--gray-500);">📚 Scenarios: <strong style="color: var(--gray-700);">3 saved</strong></span>
          </div>
          <div style="display: flex; gap: 8px; align-items: center;">
            <span style="color: var(--gusto-coral); font-weight: 500;">⚠️ 5 unsaved changes</span>
            <button style="padding: 4px 10px; font-size: 9px; background: var(--gusto-teal); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">💾 Save</button>
            <button style="padding: 4px 10px; font-size: 9px; background: var(--gray-200); color: var(--gray-600); border: none; border-radius: 4px; cursor: pointer;">↩️ Reset</button>
          </div>
        </div>
        
        <!-- Pillar Staffing Model Table - RESTRUCTURED -->
        <section class="table-section collapsible-section" id="staffingModelSection">
          <div class="table-header">
            <div class="table-title collapse-toggle" onclick="toggleSection('staffingModelSection')" style="gap: 12px;">
              <div class="table-title-icon">📊</div>
              <span>Pillar Staffing Model</span>
              <!-- Ramp Period Setting - inline with title -->
              <div style="display: flex; align-items: center; gap: 6px; padding: 4px 8px; background: var(--info-bg); border-radius: var(--radius-sm); margin-left: 8px;" onclick="event.stopPropagation()">
                <span style="font-size: 10px; color: var(--gray-600);">⏱️ Ramp:</span>
                <select style="font-size: 11px; padding: 2px 4px; border: 1px solid var(--gray-200); border-radius: 4px;">
                  <option value="1">1 mo</option>
                  <option value="2" selected>2 mo</option>
                  <option value="3">3 mo</option>
                </select>
              </div>
            </div>
            <div class="table-actions">
              <button class="table-action-btn" data-tooltip="Show who's currently editing this pillar" onclick="toggleActivityPanel()">👥</button>
              <button class="table-action-btn" data-tooltip="View version history, scenarios, and published plans" onclick="toggleVersionPanel()">📚</button>
              <button class="table-action-btn" data-tooltip="Export pillar data to CSV or PDF" onclick="toggleExportPanel()">📥</button>
            </div>
          </div>
          
          <div class="data-grid table-body" style="overflow-x: auto; position: relative;">
            <table class="data-table" style="border-collapse: separate; border-spacing: 0;">
              <thead>
                <tr style="background: var(--gray-200); position: sticky; top: 0; z-index: 50;">
                  <th style="min-width: 200px; position: sticky; left: 0; top: 0; background: var(--gusto-teal-dark); color: white; z-index: 60;">Metric</th>
                  <th style="background: var(--gray-200);">Dec-24</th><th style="background: var(--gray-200);">Jan-25</th><th style="background: var(--gray-200);">Feb-25</th><th style="background: var(--gray-200);">Mar-25</th><th style="background: var(--gray-200);">Apr-25</th><th style="background: var(--gray-200);">May-25</th>
                  <th style="background: var(--gray-200);">Jun-25</th><th style="background: var(--gray-200);">Jul-25</th><th style="background: var(--gray-200);">Aug-25</th><th style="background: var(--gray-200);">Sep-25</th><th style="background: var(--gray-200);">Oct-25</th><th style="background: var(--gray-200);">Nov-25</th>
                  <th style="background: var(--gray-200);">Dec-25</th><th style="background: var(--gray-200);">Jan-26</th><th style="background: var(--gray-200);">Feb-26</th><th style="background: var(--gray-200);">Mar-26</th><th style="background: var(--gray-200);">Apr-26</th><th style="background: var(--gray-200);">May-26</th>
                  <th style="background: var(--gray-200);">Jun-26</th><th style="background: var(--gray-200);">Jul-26</th><th style="background: var(--gray-200);">Aug-26</th><th style="background: var(--gray-200);">Sep-26</th><th style="background: var(--gray-200);">Oct-26</th><th style="background: var(--gray-200);">Nov-26</th>
                </tr>
              </thead>
              <tbody>
                
                <!-- ═══════════════════════════════════════════════════════════
                     SECTION 1: WORKLOAD ANALYSIS (Volume & AHT)
                     ═══════════════════════════════════════════════════════════ -->
                <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'workload-section')" style="background: var(--success-bg) !important;">
                  <td colspan="25" style="font-weight: 700; color: var(--gray-800);">📈 WORKLOAD ANALYSIS <span class="collapse-icon" style="float: right;">▼</span></td>
                </tr>
                <tr class="subsection-row workload-section" style="font-weight: 700; background: var(--white);">
                  <td style="position: sticky; left: 0; background: white;"><strong>Total Volume</strong></td>
                  <td>24,563</td><td>23,891</td><td>25,234</td><td>26,100</td><td>24,800</td><td>24,200</td><td>23,500</td><td>24,100</td><td>25,000</td><td>25,800</td><td>26,500</td><td>27,200</td>
                  <td>27,800</td><td>25,100</td><td>26,400</td><td>27,500</td><td>26,200</td><td>25,600</td><td>24,900</td><td>25,500</td><td>26,400</td><td>27,200</td><td>28,000</td><td>28,800</td>
                </tr>
                <tr class="subsection-row workload-section by-channel-header collapsible-row" onclick="toggleSubsection(this, 'volume-channels')">
                  <td colspan="25" style="padding-left: 24px;">└ By Channel ▼</td>
                </tr>
                <tr class="subsection-row workload-section volume-channels channel-sub">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Phone</td>
                  <td>9,696</td><td>9,424</td><td>9,961</td><td>10,300</td><td>9,800</td><td>9,600</td><td>9,300</td><td>9,500</td><td>9,900</td><td>10,200</td><td>10,500</td><td>10,800</td>
                  <td>11,100</td><td>10,000</td><td>10,500</td><td>10,900</td><td>10,400</td><td>10,100</td><td>9,900</td><td>10,100</td><td>10,500</td><td>10,800</td><td>11,100</td><td>11,400</td>
                </tr>
                <tr class="subsection-row workload-section volume-channels channel-sub">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Email</td>
                  <td>9,667</td><td>9,398</td><td>9,934</td><td>10,300</td><td>9,800</td><td>9,500</td><td>9,200</td><td>9,500</td><td>9,900</td><td>10,300</td><td>10,600</td><td>10,900</td>
                  <td>11,200</td><td>10,100</td><td>10,600</td><td>11,000</td><td>10,500</td><td>10,200</td><td>10,000</td><td>10,200</td><td>10,600</td><td>10,900</td><td>11,200</td><td>11,500</td>
                </tr>
                <tr class="subsection-row workload-section volume-channels channel-sub">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Chat</td>
                  <td>5,200</td><td>5,069</td><td>5,339</td><td>5,500</td><td>5,200</td><td>5,100</td><td>5,000</td><td>5,100</td><td>5,200</td><td>5,300</td><td>5,400</td><td>5,500</td>
                  <td>5,500</td><td>5,000</td><td>5,300</td><td>5,600</td><td>5,300</td><td>5,300</td><td>5,000</td><td>5,200</td><td>5,300</td><td>5,500</td><td>5,700</td><td>5,900</td>
                </tr>
                <tr class="subsection-row workload-section" style="font-weight: 700; background: var(--white);">
                  <td style="position: sticky; left: 0; background: white;"><strong>Weighted AHT (sec)</strong></td>
                  <td>912</td><td>908</td><td>915</td><td>920</td><td>910</td><td>905</td><td>900</td><td>905</td><td>910</td><td>915</td><td>918</td><td>920</td>
                  <td>922</td><td>910</td><td>918</td><td>925</td><td>915</td><td>908</td><td>902</td><td>908</td><td>912</td><td>918</td><td>920</td><td>924</td>
                </tr>
                <tr class="subsection-row workload-section by-channel-header collapsible-row" onclick="toggleSubsection(this, 'aht-channels')">
                  <td colspan="25" style="padding-left: 24px;">└ By Channel ▼</td>
                </tr>
                <tr class="subsection-row workload-section aht-channels channel-sub">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Phone AHT</td>
                  <td>828</td><td>825</td><td>830</td><td>835</td><td>830</td><td>825</td><td>820</td><td>825</td><td>828</td><td>830</td><td>832</td><td>835</td>
                  <td>838</td><td>826</td><td>832</td><td>840</td><td>833</td><td>828</td><td>822</td><td>827</td><td>830</td><td>833</td><td>836</td><td>840</td>
                </tr>
                <tr class="subsection-row workload-section aht-channels channel-sub">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Email AHT</td>
                  <td>1,122</td><td>1,118</td><td>1,125</td><td>1,130</td><td>1,120</td><td>1,115</td><td>1,110</td><td>1,115</td><td>1,120</td><td>1,125</td><td>1,128</td><td>1,130</td>
                  <td>1,132</td><td>1,120</td><td>1,128</td><td>1,135</td><td>1,125</td><td>1,118</td><td>1,112</td><td>1,118</td><td>1,122</td><td>1,128</td><td>1,132</td><td>1,135</td>
                </tr>
                <tr class="subsection-row workload-section aht-channels channel-sub">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Chat AHT</td>
                  <td>1,100</td><td>1,095</td><td>1,102</td><td>1,108</td><td>1,100</td><td>1,095</td><td>1,090</td><td>1,095</td><td>1,100</td><td>1,105</td><td>1,108</td><td>1,110</td>
                  <td>1,112</td><td>1,098</td><td>1,105</td><td>1,112</td><td>1,104</td><td>1,098</td><td>1,092</td><td>1,098</td><td>1,102</td><td>1,108</td><td>1,112</td><td>1,115</td>
                </tr>
                
                <!-- ═══════════════════════════════════════════════════════════
                     SECTION 2: STAFFING ANALYSIS (HC Need → Actual → Gaps)
                     ═══════════════════════════════════════════════════════════ -->
                <tr class="row-section-header" style="background: var(--gusto-teal) !important; color: white;">
                  <td colspan="25">👥 STAFFING ANALYSIS</td>
                </tr>
                
                <!-- Active HC Need -->
                <tr style="font-weight: 700; background: var(--white);">
                  <td style="position: sticky; left: 0; background: white; color: var(--gusto-teal);"><strong>🎯 Active HC Need</strong></td>
                  <td>51</td><td>49</td><td>53</td><td>56</td><td>52</td><td>50</td><td>48</td><td>50</td><td>52</td><td>55</td><td>58</td><td>60</td>
                  <td>62</td><td>54</td><td>57</td><td>61</td><td>56</td><td>53</td><td>51</td><td>53</td><td>56</td><td>59</td><td>62</td><td>65</td>
                </tr>
                <tr class="by-channel-header collapsible-row" onclick="toggleSubsection(this, 'hcneed-channels')">
                  <td colspan="25">└ By Channel ▼</td>
                </tr>
                <tr class="subsection-row hcneed-channels channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Phone HC Need</td>
                  <td>25</td><td>24</td><td>26</td><td>28</td><td>26</td><td>25</td><td>24</td><td>25</td><td>26</td><td>27</td><td>29</td><td>30</td>
                  <td>31</td><td>27</td><td>28</td><td>30</td><td>28</td><td>26</td><td>25</td><td>26</td><td>28</td><td>29</td><td>31</td><td>32</td>
                </tr>
                <tr class="subsection-row hcneed-channels channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Email HC Need</td>
                  <td>18</td><td>17</td><td>18</td><td>19</td><td>18</td><td>17</td><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td><td>21</td>
                  <td>22</td><td>18</td><td>20</td><td>21</td><td>19</td><td>18</td><td>17</td><td>18</td><td>19</td><td>20</td><td>21</td><td>22</td>
                </tr>
                <tr class="subsection-row hcneed-channels channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Chat HC Need</td>
                  <td>8</td><td>8</td><td>9</td><td>9</td><td>8</td><td>8</td><td>8</td><td>8</td><td>8</td><td>9</td><td>9</td><td>9</td>
                  <td>9</td><td>9</td><td>9</td><td>10</td><td>9</td><td>9</td><td>9</td><td>9</td><td>9</td><td>10</td><td>10</td><td>11</td>
                </tr>
                
                <!-- Actual Headcount -->
                <tr style="font-weight: 700; background: var(--white);">
                  <td style="position: sticky; left: 0; background: white;"><strong>👤 Actual Headcount</strong></td>
                  <td>21</td><td>23</td><td>27</td><td>30</td><td>33</td><td>35</td><td>37</td><td>39</td><td>42</td><td>45</td><td>47</td><td>49</td>
                  <td>50</td><td>52</td><td>54</td><td>55</td><td>57</td><td>58</td><td>59</td><td>60</td><td>61</td><td>62</td><td>63</td><td>64</td>
                </tr>
                <tr class="by-channel-header collapsible-row" onclick="toggleSubsection(this, 'actual-sites')">
                  <td colspan="25">└ By Site ▼</td>
                </tr>
                <tr class="subsection-row actual-sites channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Gusto</td>
                  <td>12</td><td>13</td><td>15</td><td>17</td><td>19</td><td>20</td><td>21</td><td>22</td><td>24</td><td>26</td><td>27</td><td>28</td>
                  <td>29</td><td>30</td><td>31</td><td>32</td><td>33</td><td>34</td><td>34</td><td>35</td><td>35</td><td>36</td><td>37</td><td>37</td>
                </tr>
                <tr class="subsection-row actual-sites channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Teleperformance</td>
                  <td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td>
                  <td>16</td><td>17</td><td>18</td><td>18</td><td>19</td><td>19</td><td>20</td><td>20</td><td>21</td><td>21</td><td>21</td><td>22</td>
                </tr>
                <tr class="subsection-row actual-sites channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ TaskUs</td>
                  <td>3</td><td>3</td><td>4</td><td>4</td><td>4</td><td>4</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td>
                  <td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td>
                </tr>
                
                <!-- New Hires Productive -->
                <tr style="color: var(--gusto-teal);">
                  <td style="position: sticky; left: 0; background: white;">📥 New Hires (Productive after ramp)</td>
                  <td>—</td><td>—</td><td>+3</td><td>+4</td><td>+5</td><td>+3</td><td>+4</td><td>+3</td><td>+2</td><td>+3</td><td>+4</td><td>+3</td>
                  <td>+2</td><td>+3</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td>
                </tr>
                
                <!-- Planned OT HC Equivalent -->
                <tr style="color: var(--info);">
                  <td style="position: sticky; left: 0; background: white;">⏰ Planned OT HC Equivalent</td>
                  <td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td>
                  <td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td><td>+8</td>
                </tr>
                
                <!-- Attrition -->
                <tr style="color: var(--error);">
                  <td style="position: sticky; left: 0; background: white;">📉 Attrition (Calculated)</td>
                  <td>-1</td><td>-1</td><td>-1</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td>
                  <td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td>
                </tr>
                
                <!-- ═══════════════════════════════════════════════════════════
                     SECTION 3: STAFFING GAPS (The Bottom Line)
                     ═══════════════════════════════════════════════════════════ -->
                <tr class="row-section-header" style="background: var(--gray-700) !important; color: white;">
                  <td colspan="25">📉 STAFFING GAPS</td>
                </tr>
                <tr style="font-weight: 700; background: var(--white);">
                  <td style="position: sticky; left: 0; background: white;"><strong>Net Staffing (HC Need - Productive)</strong></td>
                  <td class="gap-negative">-30</td><td class="gap-negative">-26</td><td class="gap-negative">-27</td><td class="gap-negative">-26</td><td class="gap-negative">-18</td><td class="gap-negative">-14</td>
                  <td class="gap-negative">-9</td><td class="gap-negative">-10</td><td class="gap-negative">-11</td><td class="gap-negative">-11</td><td class="gap-negative">-10</td><td class="gap-negative">-11</td>
                  <td class="gap-negative">-12</td><td class="gap-negative">-2</td><td class="gap-negative">-3</td><td class="gap-negative">-6</td><td class="gap-positive">+1</td><td class="gap-positive">+5</td>
                  <td class="gap-positive">+8</td><td class="gap-positive">+7</td><td class="gap-positive">+5</td><td class="gap-positive">+3</td><td class="gap-positive">+1</td><td class="gap-negative">-1</td>
                </tr>
                <tr style="font-weight: 700; background: var(--white);">
                  <td style="position: sticky; left: 0; background: white;"><strong>Net Staffing + OT (Final Plan)</strong></td>
                  <td class="gap-negative">-22</td><td class="gap-negative">-18</td><td class="gap-negative">-19</td><td class="gap-negative">-18</td><td class="gap-negative">-10</td><td class="gap-negative">-6</td>
                  <td class="gap-negative">-1</td><td class="gap-negative">-2</td><td class="gap-negative">-3</td><td class="gap-negative">-3</td><td class="gap-negative">-2</td><td class="gap-negative">-3</td>
                  <td class="gap-negative">-4</td><td class="gap-positive">+6</td><td class="gap-positive">+5</td><td class="gap-positive">+2</td><td class="gap-positive">+9</td><td class="gap-positive">+13</td>
                  <td class="gap-positive">+16</td><td class="gap-positive">+15</td><td class="gap-positive">+13</td><td class="gap-positive">+11</td><td class="gap-positive">+9</td><td class="gap-positive">+7</td>
                </tr>
                
                <!-- ═══════════════════════════════════════════════════════════
                     SECTION 4: MANUAL INPUTS (Collapsible)
                     ═══════════════════════════════════════════════════════════ -->
                <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'manual-inputs-section')" style="background: var(--gusto-coral) !important; color: white;">
                  <td colspan="25">✏️ MANUAL INPUTS (Edit These) <span class="collapse-icon" style="float: right;">▼</span></td>
                </tr>
                
                <!-- New Hires Total - Same format as Actual Headcount -->
                <tr class="subsection-row manual-inputs-section" style="font-weight: 700; background: var(--white);">
                  <td style="position: sticky; left: 0; background: white;"><strong>📥 New Hire - Planned/Actual (Total)</strong></td>
                  <td>3</td><td>4</td><td>5</td><td>3</td><td>4</td><td>3</td><td>2</td><td>3</td><td>4</td><td>3</td><td>2</td><td>3</td>
                  <td>2</td><td>3</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td>
                </tr>
                <tr class="subsection-row manual-inputs-section by-channel-header collapsible-row" onclick="toggleSubsection(this, 'newhire-sites')">
                  <td colspan="25">└ By Site ▼</td>
                </tr>
                <tr class="subsection-row manual-inputs-section newhire-sites channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Gusto</td>
                  <td><input type="number" value="2" style="width: 44px;"></td><td><input type="number" value="3" style="width: 44px;"></td><td><input type="number" value="3" style="width: 44px;"></td>
                  <td><input type="number" value="2" style="width: 44px;"></td><td><input type="number" value="3" style="width: 44px;"></td><td><input type="number" value="2" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="2" style="width: 44px;"></td><td><input type="number" value="2" style="width: 44px;"></td>
                  <td><input type="number" value="2" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="2" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="2" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                </tr>
                <tr class="subsection-row manual-inputs-section newhire-sites channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ Teleperformance</td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                </tr>
                <tr class="subsection-row manual-inputs-section newhire-sites channel-sub hidden">
                  <td style="position: sticky; left: 0; background: #E6F7F5;">→ TaskUs</td>
                  <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td>
                  <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="1" style="width: 44px;"></td>
                  <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td>
                  <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td>
                  <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td>
                  <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td>
                  <td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td><td><input type="number" value="0" style="width: 44px;"></td>
                </tr>
                
                <!-- OT Per IC - Simple editable row like channel overlays -->
                <tr class="subsection-row manual-inputs-section row-editable">
                  <td style="position: sticky; left: 0; background: white;">⏰ Planned OT Per IC (hrs)</td>
                  <td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td>
                  <td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td>
                  <td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td>
                  <td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td>
                  <td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td>
                  <td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td>
                  <td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td>
                  <td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td><td><input type="number" value="4" style="width: 44px;"></td>
                </tr>
                
                <!-- Attrition % - Simple editable row like channel overlays -->
                <tr class="subsection-row manual-inputs-section row-editable">
                  <td style="position: sticky; left: 0; background: white;">📉 Monthly Attrition %</td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                  <td><div class="pct-input"><input type="number" value="5"><span>%</span></div></td>
                </tr>
                
                <!-- ═══════════════════════════════════════════════════════════
                     SECTION 5: WORKFORCE CALCULATIONS (Collapsible - shows the math)
                     ═══════════════════════════════════════════════════════════ -->
                <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'workforce-calc')" style="background: var(--gusto-teal-light) !important;">
                  <td colspan="25">🔢 WORKFORCE CALCULATIONS (How we get to Productive HC) <span class="collapse-icon" style="float: right;">▼</span></td>
                </tr>
                <tr class="subsection-row workforce-calc">
                  <td style="position: sticky; left: 0; background: white;">Starting Actual HC</td>
                  <td>21</td><td>23</td><td>27</td><td>30</td><td>33</td><td>35</td><td>37</td><td>39</td><td>42</td><td>45</td><td>47</td><td>49</td>
                  <td>50</td><td>52</td><td>54</td><td>55</td><td>57</td><td>58</td><td>59</td><td>60</td><td>61</td><td>62</td><td>63</td><td>64</td>
                </tr>
                <tr class="subsection-row workforce-calc" style="color: var(--success);">
                  <td style="position: sticky; left: 0; background: white;">+ Productive Hires (after 2mo ramp)</td>
                  <td>—</td><td>—</td><td>+3</td><td>+4</td><td>+5</td><td>+3</td><td>+4</td><td>+3</td><td>+2</td><td>+3</td><td>+4</td><td>+3</td>
                  <td>+2</td><td>+3</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td>
                </tr>
                <tr class="subsection-row workforce-calc" style="color: var(--error);">
                  <td style="position: sticky; left: 0; background: white;">- Attrition (5% × Actual)</td>
                  <td>-1</td><td>-1</td><td>-1</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td><td>-2</td>
                  <td>-2</td><td>-3</td><td>-3</td><td>-3</td><td>-3</td><td>-3</td><td>-3</td><td>-3</td><td>-3</td><td>-3</td><td>-3</td><td>-3</td>
                </tr>
                <tr class="subsection-row workforce-calc" style="font-weight: 600; border-top: 1px solid var(--gray-300);">
                  <td style="position: sticky; left: 0; background: white;">= Productive HC (No OT)</td>
                  <td>20</td><td>22</td><td>25</td><td>28</td><td>31</td><td>33</td><td>35</td><td>36</td><td>38</td><td>42</td><td>45</td><td>46</td>
                  <td>48</td><td>52</td><td>53</td><td>54</td><td>56</td><td>57</td><td>58</td><td>59</td><td>60</td><td>61</td><td>62</td><td>63</td>
                </tr>
                <tr class="subsection-row workforce-calc" style="color: var(--info);">
                  <td style="position: sticky; left: 0; background: white;">+ OT HC Equivalent (4hrs × HC ÷ 173)</td>
                  <td>+1</td><td>+1</td><td>+1</td><td>+2</td><td>+3</td><td>+3</td><td>+4</td><td>+4</td><td>+3</td><td>+2</td><td>+3</td><td>+3</td>
                  <td>+3</td><td>+4</td><td>+4</td><td>+4</td><td>+4</td><td>+4</td><td>+4</td><td>+4</td><td>+4</td><td>+4</td><td>+4</td><td>+4</td>
                </tr>
                <tr class="subsection-row workforce-calc" style="font-weight: 700; border-top: 2px solid var(--gusto-teal);">
                  <td style="position: sticky; left: 0; background: white; color: var(--gusto-teal);"><strong>= Productive HC Available (with OT)</strong></td>
                  <td>21</td><td>23</td><td>26</td><td>30</td><td>34</td><td>36</td><td>39</td><td>40</td><td>41</td><td>44</td><td>48</td><td>49</td>
                  <td>51</td><td>56</td><td>57</td><td>58</td><td>60</td><td>61</td><td>62</td><td>63</td><td>64</td><td>65</td><td>66</td><td>67</td>
                </tr>
                
                <!-- ═══════════════════════════════════════════════════════════
                     SECTION 6: HC NEED DETAIL (Collapsible - Base vs Active)
                     ═══════════════════════════════════════════════════════════ -->
                <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'hc-need-detail')" style="background: var(--gray-200) !important;">
                  <td colspan="25">🎯 HC NEED DETAIL (Base vs Active with Overlays) <span class="collapse-icon" style="float: right;">▼</span></td>
                </tr>
                <tr class="subsection-row hc-need-detail">
                  <td style="position: sticky; left: 0; background: white;">Base HC Need (Forecast Only)</td>
                  <td>49</td><td>47</td><td>51</td><td>54</td><td>50</td><td>48</td><td>45</td><td>46</td><td>48</td><td>52</td><td>55</td><td>57</td>
                  <td>59</td><td>51</td><td>54</td><td>58</td><td>53</td><td>50</td><td>48</td><td>50</td><td>53</td><td>56</td><td>59</td><td>62</td>
                </tr>
                <tr class="subsection-row hc-need-detail" style="color: var(--gusto-coral);">
                  <td style="position: sticky; left: 0; background: white;">+ Overlay Impact</td>
                  <td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+2</td><td>+3</td><td>+4</td><td>+4</td><td>+3</td><td>+3</td><td>+3</td>
                  <td>+3</td><td>+3</td><td>+3</td><td>+3</td><td>+3</td><td>+3</td><td>+3</td><td>+3</td><td>+3</td><td>+3</td><td>+3</td><td>+3</td>
                </tr>
                <tr class="subsection-row hc-need-detail" style="font-weight: 700;">
                  <td style="position: sticky; left: 0; background: white; color: var(--gusto-teal);"><strong>= Active HC Need</strong></td>
                  <td>51</td><td>49</td><td>53</td><td>56</td><td>52</td><td>50</td><td>48</td><td>50</td><td>52</td><td>55</td><td>58</td><td>60</td>
                  <td>62</td><td>54</td><td>57</td><td>61</td><td>56</td><td>53</td><td>51</td><td>53</td><td>56</td><td>59</td><td>62</td><td>65</td>
                </tr>
                
              </tbody>
            </table>
          </div>
        </section>
        
        <!-- Channel Level Sections -->
        <section class="table-section">
          <div class="table-header">
            <div class="table-title">
              <div class="table-title-icon">📞</div>
              <span>Channel Level Staffing</span>
            </div>
          </div>
          
          <!-- Phone Channel - FULL STAFFING TABLE -->
          <div class="channel-section expanded">
            <div class="channel-header" onclick="toggleChannel(this)">
              <div class="channel-info">
                <div class="channel-icon phone">📞</div>
                <div>
                  <div class="channel-name">Accountant - Phone</div>
                  <div style="font-size: 12px; color: var(--gray-500);">Click to expand full staffing table</div>
                </div>
              </div>
              <div class="channel-stats">
                <div class="channel-stat">
                  <div class="channel-stat-value">9,696</div>
                  <div class="channel-stat-label">Volume</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value">828</div>
                  <div class="channel-stat-label">AHT</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value">25</div>
                  <div class="channel-stat-label">HC Need</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value gap-positive">0</div>
                  <div class="channel-stat-label">Overlay Impact</div>
                </div>
              </div>
              <span class="expand-icon">▼</span>
            </div>
            <div class="channel-body">
              <!-- Full Channel Staffing Table -->
              <div class="data-grid" style="overflow-x: auto;">
                <table class="data-table" style="font-size: 12px;">
                  <thead>
                    <tr>
                      <th style="min-width: 180px; position: sticky; left: 0; background: var(--gray-50); z-index: 2;">Phone Channel</th>
                      <th>Dec-24</th><th>Jan-25</th><th>Feb-25</th><th>Mar-25</th><th>Apr-25</th><th>May-25</th>
                      <th>Jun-25</th><th>Jul-25</th><th>Aug-25</th><th>Sep-25</th><th>Oct-25</th><th>Nov-25</th>
                      <th>Dec-25</th><th>Jan-26</th><th>Feb-26</th><th>Mar-26</th><th>Apr-26</th><th>May-26</th>
                      <th>Jun-26</th><th>Jul-26</th><th>Aug-26</th><th>Sep-26</th><th>Oct-26</th><th>Nov-26</th>
                      <th style="background: var(--gusto-teal-light); color: var(--gusto-teal); position: sticky; right: 0;">⚡ Apply All</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Volume Section -->
                    <tr class="row-section-header">
                      <td colspan="26">📈 Volume</td>
                    </tr>
                    <tr>
                      <td style="position: sticky; left: 0; background: white;">Volume - Forecast Inbound</td>
                      <td>9,696</td><td>9,250</td><td>10,050</td><td>10,600</td><td>9,900</td><td>9,450</td>
                      <td>9,300</td><td>9,500</td><td>9,800</td><td>10,100</td><td>10,400</td><td>10,700</td>
                      <td>10,900</td><td>9,800</td><td>10,300</td><td>10,700</td><td>10,200</td><td>9,900</td>
                      <td>9,700</td><td>9,900</td><td>10,300</td><td>10,600</td><td>10,900</td><td>11,200</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="row-calculated" style="font-weight: 600;">
                      <td style="position: sticky; left: 0; background: white;">Volume - Active</td>
                      <td>9,696</td><td>9,250</td><td>10,050</td><td>10,600</td><td>9,900</td><td>9,450</td>
                      <td>9,300</td><td>9,500</td><td>9,800</td><td>10,100</td><td>10,400</td><td>10,700</td>
                      <td>10,900</td><td>9,800</td><td>10,300</td><td>10,700</td><td>10,200</td><td>9,900</td>
                      <td>9,700</td><td>9,900</td><td>10,300</td><td>10,600</td><td>10,900</td><td>11,200</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    
                    <!-- Baseline Metrics Section - Collapsible -->
                    <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'baseline-phone')">
                      <td colspan="26">📊 Baseline Metrics (From Forecast)</td>
                    </tr>
                    <tr class="subsection-row baseline-phone baseline-row">
                      <td style="position: sticky; left: 0;">AHT (seconds)</td>
                      <td>828</td><td>830</td><td>825</td><td>820</td><td>828</td><td>835</td>
                      <td>830</td><td>825</td><td>828</td><td>832</td><td>835</td><td>838</td>
                      <td>840</td><td>828</td><td>833</td><td>838</td><td>833</td><td>828</td>
                      <td>825</td><td>828</td><td>832</td><td>835</td><td>838</td><td>840</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-phone baseline-row">
                      <td style="position: sticky; left: 0;">SL Target</td>
                      <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                      <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                      <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                      <td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td><td>80/60</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-phone baseline-row">
                      <td style="position: sticky; left: 0;">Occupancy %</td>
                      <td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td>
                      <td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td>
                      <td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td>
                      <td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-phone baseline-row">
                      <td style="position: sticky; left: 0;">Concurrency</td>
                      <td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td>
                      <td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td>
                      <td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td>
                      <td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-phone baseline-row">
                      <td style="position: sticky; left: 0;">Total Shrink %</td>
                      <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                      <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                      <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                      <td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td><td>28%</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-phone baseline-row">
                      <td style="position: sticky; left: 0;">SL Uplift Factor</td>
                      <td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td>
                      <td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td>
                      <td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td>
                      <td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td><td>1.08</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    
                    <!-- OVERLAYS Section - EDITABLE - Collapsible -->
                    <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'overlay-phone')" style="background: var(--gusto-coral) !important;">
                      <td colspan="26">✏️ OVERLAYS (Edit These)</td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Volume Adj</td>
                      <td><input type="text" placeholder="0 or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="0 or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="0 or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="0 or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="0 or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="0 or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="val" style="width: 45px;" onchange="applyToAll(this, 'phone-vol')"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">AHT Adj</td>
                      <td><input type="text" placeholder="sec or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="sec or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="sec or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="sec or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="sec or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" placeholder="sec or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="val" style="width: 45px;" onchange="applyToAll(this, 'phone-aht')"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">SL Target Override</td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><select class="sl-select" onchange="applyToAll(this, 'phone-sl')"><option value="">—</option><option>80/60</option><option>70/60</option></select></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Occupancy Override %</td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;" onchange="applyToAll(this, 'phone-occ')"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Shrink Override %</td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;" onchange="applyToAll(this, 'phone-shrink')"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Automation Rate %</td>
                      <td><input type="text" placeholder="0%" style="width: 50px;"></td><td><input type="text" placeholder="0%" style="width: 50px;"></td><td><input type="text" placeholder="0%" style="width: 50px;"></td>
                      <td><input type="text" placeholder="0%" style="width: 50px;"></td><td><input type="text" placeholder="0%" style="width: 50px;"></td><td><input type="text" placeholder="0%" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;" onchange="applyToAll(this, 'phone-auto')"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Concurrency Override</td>
                      <td><input type="text" placeholder="1.0" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="#" style="width: 45px;" onchange="applyToAll(this, 'phone-conc')"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Outbound Contacts</td>
                      <td><input type="number" placeholder="0" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="number" placeholder="#" style="width: 45px;" onchange="applyToAll(this, 'phone-outb')"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Outbound AHT (sec)</td>
                      <td><input type="number" placeholder="0" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="number" placeholder="sec" style="width: 45px;" onchange="applyToAll(this, 'phone-outb-aht')"></td>
                    </tr>
                    <!-- HC Need Section -->
                    <tr class="row-section-header">
                      <td colspan="26">🎯 Headcount Need</td>
                    </tr>
                    <tr>
                      <td style="position: sticky; left: 0; background: white;">Base HC Need (No Overlays)</td>
                      <td>25</td><td>24</td><td>26</td><td>27</td><td>25</td><td>24</td>
                      <td>24</td><td>25</td><td>26</td><td>27</td><td>28</td><td>29</td>
                      <td>30</td><td>26</td><td>28</td><td>29</td><td>27</td><td>26</td>
                      <td>25</td><td>26</td><td>28</td><td>29</td><td>30</td><td>31</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="row-calculated" style="font-weight: 700;">
                      <td style="position: sticky; left: 0; background: white; color: var(--gusto-teal);">🟢 Active HC Need (Inc Overlays)</td>
                      <td>25</td><td>24</td><td>26</td><td>27</td><td>25</td><td>24</td>
                      <td>24</td><td>25</td><td>26</td><td>27</td><td>28</td><td>29</td>
                      <td>30</td><td>26</td><td>28</td><td>29</td><td>27</td><td>26</td>
                      <td>25</td><td>26</td><td>28</td><td>29</td><td>30</td><td>31</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr>
                      <td style="color: var(--gusto-coral); position: sticky; left: 0; background: white;">Overlay Impact</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    
                    <!-- Actual OT Tracking -->
                    <tr class="row-section-header">
                      <td colspan="26">⏰ Actual OT Tracking</td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Actual OT Hours/IC</td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td><input type="number" value="" placeholder="0" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="number" placeholder="hrs" style="width: 45px;"></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          
          <!-- Email Channel - FULL STAFFING TABLE -->
          <div class="channel-section">
            <div class="channel-header" onclick="toggleChannel(this)">
              <div class="channel-info">
                <div class="channel-icon email">📧</div>
                <div>
                  <div class="channel-name">Accountant - Email</div>
                  <div style="font-size: 12px; color: var(--gray-500);">Click to expand full staffing table</div>
                </div>
              </div>
              <div class="channel-stats">
                <div class="channel-stat">
                  <div class="channel-stat-value">21,682</div>
                  <div class="channel-stat-label">Volume</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value">1,128</div>
                  <div class="channel-stat-label">AHT</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value">54</div>
                  <div class="channel-stat-label">HC Need</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value gap-positive">0</div>
                  <div class="channel-stat-label">Overlay Impact</div>
                </div>
              </div>
              <span class="expand-icon">▼</span>
            </div>
            <div class="channel-body">
              <!-- Full Channel Staffing Table for Email - 24 months -->
              <div class="data-grid" style="overflow-x: auto;">
                <table class="data-table" style="font-size: 12px;">
                  <thead>
                    <tr>
                      <th style="min-width: 180px; position: sticky; left: 0; background: var(--gray-50); z-index: 2;">Email Channel</th>
                      <th>Dec-24</th><th>Jan-25</th><th>Feb-25</th><th>Mar-25</th><th>Apr-25</th><th>May-25</th>
                      <th>Jun-25</th><th>Jul-25</th><th>Aug-25</th><th>Sep-25</th><th>Oct-25</th><th>Nov-25</th>
                      <th>Dec-25</th><th>Jan-26</th><th>Feb-26</th><th>Mar-26</th><th>Apr-26</th><th>May-26</th>
                      <th>Jun-26</th><th>Jul-26</th><th>Aug-26</th><th>Sep-26</th><th>Oct-26</th><th>Nov-26</th>
                      <th style="background: var(--gusto-teal-light); color: var(--gusto-teal); position: sticky; right: 0;">⚡ Apply All</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Volume Section -->
                    <tr class="row-section-header"><td colspan="26">📈 Volume</td></tr>
                    <tr>
                      <td style="position: sticky; left: 0; background: white;">Volume - Forecast Inbound</td>
                      <td>21,682</td><td>19,267</td><td>19,943</td><td>19,891</td><td>22,574</td><td>19,839</td>
                      <td>21,557</td><td>29,154</td><td>36,478</td><td>29,792</td><td>28,585</td><td>27,521</td>
                      <td>22,270</td><td>19,765</td><td>21,617</td><td>20,310</td><td>23,331</td><td>25,010</td>
                      <td>29,350</td><td>29,350</td><td>36,823</td><td>30,238</td><td>29,083</td><td>28,115</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="row-calculated" style="font-weight: 600;">
                      <td style="position: sticky; left: 0; background: white;">Volume - Active</td>
                      <td>21,682</td><td>19,267</td><td>19,943</td><td>19,891</td><td>22,574</td><td>19,839</td>
                      <td>21,557</td><td>29,154</td><td>36,478</td><td>29,792</td><td>28,585</td><td>27,521</td>
                      <td>22,270</td><td>19,765</td><td>21,617</td><td>20,310</td><td>23,331</td><td>25,010</td>
                      <td>29,350</td><td>29,350</td><td>36,823</td><td>30,238</td><td>29,083</td><td>28,115</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    
                    <!-- Baseline Metrics - Email Channel -->
                    <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'baseline-email')"><td colspan="26">📊 Baseline Metrics (From Forecast)</td></tr>
                    <tr class="subsection-row baseline-email baseline-row">
                      <td style="position: sticky; left: 0;">AHT (seconds)</td>
                      <td>1,128</td><td>1,128</td><td>1,284</td><td>1,332</td><td>1,422</td><td>1,302</td>
                      <td>1,308</td><td>1,423</td><td>1,419</td><td>1,415</td><td>1,412</td><td>1,408</td>
                      <td>1,404</td><td>1,400</td><td>1,397</td><td>1,393</td><td>1,389</td><td>1,386</td>
                      <td>1,382</td><td>1,379</td><td>1,375</td><td>1,371</td><td>1,368</td><td>1,364</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-email baseline-row">
                      <td style="position: sticky; left: 0;">SL Target</td>
                      <td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td>
                      <td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td>
                      <td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td>
                      <td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td><td>100/24h</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-email baseline-row">
                      <td style="position: sticky; left: 0;">Occupancy %</td>
                      <td>100%</td><td>100%</td><td>100%</td><td>100%</td><td>100%</td><td>100%</td>
                      <td>100%</td><td>100%</td><td>100%</td><td>100%</td><td>100%</td><td>100%</td>
                      <td>100%</td><td>100%</td><td>100%</td><td>100%</td><td>100%</td><td>100%</td>
                      <td>100%</td><td>100%</td><td>100%</td><td>100%</td><td>100%</td><td>100%</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-email baseline-row">
                      <td style="position: sticky; left: 0;">Concurrency</td>
                      <td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td>
                      <td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td>
                      <td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td>
                      <td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.0</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-email baseline-row">
                      <td style="position: sticky; left: 0;">Total Shrink</td>
                      <td>18%</td><td>18%</td><td>18%</td><td>18%</td><td>18%</td><td>18%</td>
                      <td>33%</td><td>32%</td><td>33%</td><td>38%</td><td>39%</td><td>43%</td>
                      <td>43%</td><td>43%</td><td>43%</td><td>43%</td><td>45%</td><td>42%</td>
                      <td>38%</td><td>32%</td><td>33%</td><td>38%</td><td>39%</td><td>43%</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    
                    <!-- OVERLAYS Section - EMAIL CHANNEL -->
                    <tr class="row-section-header" style="background: var(--gusto-coral) !important;"><td colspan="26">✏️ OVERLAYS (Edit These) - Email Channel</td></tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Volume Adj</td>
                      <td><input type="text" placeholder="0 or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="val" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">AHT Adj</td>
                      <td><input type="text" placeholder="sec or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="val" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">SL Target Override</td>
                      <td><select class="sl-select"><option value="">—</option><option selected>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><select class="sl-select"><option value="">—</option><option>100/86400</option></select></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Occupancy Override %</td>
                      <td><input type="text" placeholder="100%" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Concurrency Override</td>
                      <td><input type="text" placeholder="1.0" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="#" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Shrink Override %</td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">Automation Rate %</td>
                      <td><input type="text" placeholder="0%" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">📧 Backlog Inventory Count</td>
                      <td><input type="number" placeholder="0" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="number" placeholder="#" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-editable">
                      <td style="position: sticky; left: 0; background: white;">📧 Email Backlog Target (days)</td>
                      <td><input type="number" placeholder="1" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="number" placeholder="days" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-editable" style="background: var(--gray-50);">
                      <td style="position: sticky; left: 0; background: var(--gray-50); font-style: italic; color: var(--gray-500);">TFIR (hrs) - Tracking Only</td>
                      <td><input type="number" placeholder="—" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td><td><input type="number" style="width: 50px;"></td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    
                    <!-- HC Need Section -->
                    <tr class="row-section-header"><td colspan="26">🎯 Headcount Need</td></tr>
                    <tr>
                      <td style="position: sticky; left: 0; background: white;">Base HC Need (No Overlays)</td>
                      <td>54</td><td>51</td><td>54</td><td>59</td><td>71</td><td>52</td>
                      <td>82</td><td>98</td><td>136</td><td>121</td><td>101</td><td>100</td>
                      <td>88</td><td>74</td><td>74</td><td>76</td><td>88</td><td>88</td>
                      <td>116</td><td>96</td><td>140</td><td>119</td><td>95</td><td>98</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="row-calculated" style="font-weight: 700;">
                      <td style="position: sticky; left: 0; background: white; color: var(--gusto-teal);">🟢 Active HC Need</td>
                      <td>54</td><td>51</td><td>54</td><td>59</td><td>71</td><td>52</td>
                      <td>82</td><td>98</td><td>136</td><td>121</td><td>101</td><td>100</td>
                      <td>88</td><td>74</td><td>74</td><td>76</td><td>88</td><td>88</td>
                      <td>116</td><td>96</td><td>140</td><td>119</td><td>95</td><td>98</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr>
                      <td style="color: var(--gusto-coral); position: sticky; left: 0; background: white;">Overlay Impact</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          
          <!-- Chat Channel - THIRD CHANNEL -->
          <div class="channel-section">
            <div class="channel-header" onclick="toggleChannel(this)">
              <div class="channel-info">
                <div class="channel-icon chat">💬</div>
                <div>
                  <div class="channel-name">Accountant - Chat</div>
                  <div style="font-size: 12px; color: var(--gray-500);">Click to expand full staffing table</div>
                </div>
              </div>
              <div class="channel-stats">
                <div class="channel-stat">
                  <div class="channel-stat-value">34,282</div>
                  <div class="channel-stat-label">Volume</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value">1,326</div>
                  <div class="channel-stat-label">AHT</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value">70</div>
                  <div class="channel-stat-label">HC Need</div>
                </div>
                <div class="channel-stat">
                  <div class="channel-stat-value gap-positive">0</div>
                  <div class="channel-stat-label">Overlay Impact</div>
                </div>
              </div>
              <span class="expand-icon">▼</span>
            </div>
            <div class="channel-body">
              <div class="data-grid" style="overflow-x: auto;">
                <table class="data-table" style="font-size: 12px;">
                  <thead>
                    <tr>
                      <th style="min-width: 180px; position: sticky; left: 0; background: var(--gray-50); z-index: 2;">Chat Channel</th>
                      <th>Dec-24</th><th>Jan-25</th><th>Feb-25</th><th>Mar-25</th><th>Apr-25</th><th>May-25</th>
                      <th>Jun-25</th><th>Jul-25</th><th>Aug-25</th><th>Sep-25</th><th>Oct-25</th><th>Nov-25</th>
                      <th>Dec-25</th><th>Jan-26</th><th>Feb-26</th><th>Mar-26</th><th>Apr-26</th><th>May-26</th>
                      <th>Jun-26</th><th>Jul-26</th><th>Aug-26</th><th>Sep-26</th><th>Oct-26</th><th>Nov-26</th>
                      <th style="background: var(--gusto-teal-light); color: var(--gusto-teal); position: sticky; right: 0;">⚡ Apply All</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'baseline-chat')">
                      <td colspan="26">📊 Baseline Metrics (From Forecast)</td>
                    </tr>
                    <tr class="subsection-row baseline-chat baseline-row">
                      <td style="position: sticky; left: 0;">AHT (seconds)</td>
                      <td>1,326</td><td>1,284</td><td>1,338</td><td>1,362</td><td>1,212</td><td>1,260</td>
                      <td>1,254</td><td>1,339</td><td>1,296</td><td>1,252</td><td>1,311</td><td>1,252</td>
                      <td>1,386</td><td>1,256</td><td>1,316</td><td>1,367</td><td>1,248</td><td>1,258</td>
                      <td>1,237</td><td>1,339</td><td>1,296</td><td>1,252</td><td>1,311</td><td>1,252</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-chat baseline-row">
                      <td style="position: sticky; left: 0;">SL Target</td>
                      <td>80/30</td><td>80/30</td><td>80/30</td><td>80/30</td><td>80/30</td><td>80/30</td>
                      <td>80/30</td><td>70/30</td><td>70/30</td><td>80/30</td><td>80/30</td><td>80/30</td>
                      <td>80/30</td><td>80/30</td><td>80/30</td><td>80/30</td><td>80/30</td><td>80/30</td>
                      <td>80/30</td><td>70/30</td><td>70/30</td><td>80/30</td><td>80/30</td><td>80/30</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-chat baseline-row">
                      <td style="position: sticky; left: 0;">Occupancy %</td>
                      <td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td>
                      <td>85%</td><td>89%</td><td>89%</td><td>85%</td><td>85%</td><td>85%</td>
                      <td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td><td>85%</td>
                      <td>85%</td><td>89%</td><td>89%</td><td>85%</td><td>85%</td><td>85%</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-chat baseline-row">
                      <td style="position: sticky; left: 0;">Concurrency</td>
                      <td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td>
                      <td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td>
                      <td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td>
                      <td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td><td>1.7</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="subsection-row baseline-chat baseline-row">
                      <td style="position: sticky; left: 0;">Total Shrink %</td>
                      <td>18%</td><td>18%</td><td>18%</td><td>18%</td><td>18%</td><td>18%</td>
                      <td>33%</td><td>32%</td><td>33%</td><td>38%</td><td>39%</td><td>43%</td>
                      <td>43%</td><td>43%</td><td>43%</td><td>43%</td><td>45%</td><td>42%</td>
                      <td>38%</td><td>32%</td><td>33%</td><td>38%</td><td>39%</td><td>43%</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    
                    <!-- OVERLAYS Section - CHAT CHANNEL -->
                    <tr class="row-section-header collapsible-row" onclick="toggleSubsection(this, 'overlay-chat')" style="background: var(--gusto-coral) !important;">
                      <td colspan="26">✏️ OVERLAYS (Edit These) - Chat Channel</td>
                    </tr>
                    <tr class="subsection-row overlay-chat row-editable">
                      <td style="position: sticky; left: 0; background: white;">Volume Adj</td>
                      <td><input type="text" placeholder="0 or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="val" style="width: 45px;"></td>
                    </tr>
                    <tr class="subsection-row overlay-chat row-editable">
                      <td style="position: sticky; left: 0; background: white;">AHT Adj</td>
                      <td><input type="text" placeholder="sec or %" style="width: 50px;" oninput="handleInputMode(this)"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="val" style="width: 45px;"></td>
                    </tr>
                    <tr class="subsection-row overlay-chat row-editable">
                      <td style="position: sticky; left: 0; background: white;">SL Target Override</td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><select class="sl-select"><option value="">—</option><option>80/30</option><option>70/30</option></select></td>
                    </tr>
                    <tr class="subsection-row overlay-chat row-editable">
                      <td style="position: sticky; left: 0; background: white;">Occupancy Override %</td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;"></td>
                    </tr>
                    <tr class="subsection-row overlay-chat row-editable">
                      <td style="position: sticky; left: 0; background: white;">Concurrency Override</td>
                      <td><input type="text" placeholder="1.7" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="#" style="width: 45px;"></td>
                    </tr>
                    <tr class="subsection-row overlay-chat row-editable">
                      <td style="position: sticky; left: 0; background: white;">Shrink Override %</td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;"></td>
                    </tr>
                    <tr class="subsection-row overlay-chat row-editable">
                      <td style="position: sticky; left: 0; background: white;">Automation Rate %</td>
                      <td><input type="text" placeholder="0%" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td><td><input type="text" style="width: 50px;"></td>
                      <td style="background: var(--gusto-teal-light); position: sticky; right: 0;"><input type="text" placeholder="%" style="width: 45px;"></td>
                    </tr>
                    <tr class="row-section-header"><td colspan="26">🎯 Headcount Need</td></tr>
                    <tr>
                      <td style="position: sticky; left: 0; background: white;">Base HC Need</td>
                      <td>70</td><td>59</td><td>61</td><td>52</td><td>51</td><td>53</td>
                      <td>100</td><td>111</td><td>151</td><td>133</td><td>110</td><td>102</td>
                      <td>96</td><td>72</td><td>75</td><td>70</td><td>73</td><td>86</td>
                      <td>161</td><td>137</td><td>197</td><td>164</td><td>130</td><td>126</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr class="row-calculated" style="font-weight: 700;">
                      <td style="position: sticky; left: 0; background: white; color: var(--gusto-teal);">🟢 Active HC Need</td>
                      <td>70</td><td>59</td><td>61</td><td>52</td><td>51</td><td>53</td>
                      <td>100</td><td>111</td><td>151</td><td>133</td><td>110</td><td>102</td>
                      <td>96</td><td>72</td><td>75</td><td>70</td><td>73</td><td>86</td>
                      <td>161</td><td>137</td><td>197</td><td>164</td><td>130</td><td>126</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                    <tr>
                      <td style="color: var(--gusto-coral); position: sticky; left: 0; background: white;">Overlay Impact</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                      <td style="background: var(--gray-100); position: sticky; right: 0;">—</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </section>
        
        </div><!-- END view-pillar -->
        
        <!-- ═══════════════════════════════════════════════════════════════════════
             DATA MANAGEMENT VIEW - Import/Export, Storage, Architecture
             ═══════════════════════════════════════════════════════════════════════ -->
        <div id="view-datamanagement" class="view-container" style="display: none;">
          
          <!-- Page Header -->
          <div style="margin-bottom: var(--space-lg);">
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
              <h1 style="font-size: 24px; font-weight: 600; color: var(--gray-800);">🗄️ Data Management</h1>
            </div>
            <p style="color: var(--gray-500); font-size: 14px;">Export plans, manage data sources, and configure import/export settings</p>
          </div>
          
          <!-- Storage Summary Cards - Top Section -->
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-md); margin-bottom: var(--space-lg);">
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center;">
              <div style="font-size: 36px; font-weight: 700; color: var(--gusto-teal);">1</div>
              <div style="font-size: 13px; font-weight: 600; color: var(--gray-700); margin-top: 4px;">Working Plan</div>
              <div style="font-size: 11px; color: var(--gray-400);">Current edits</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center;">
              <div style="font-size: 36px; font-weight: 700; color: var(--success);">3</div>
              <div style="font-size: 13px; font-weight: 600; color: var(--gray-700); margin-top: 4px;">Published Plans</div>
              <div style="font-size: 11px; color: var(--gray-400);">of 12 max</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center;">
              <div style="font-size: 36px; font-weight: 700; color: var(--gusto-coral);">4</div>
              <div style="font-size: 13px; font-weight: 600; color: var(--gray-700); margin-top: 4px;">Scenarios</div>
              <div style="font-size: 11px; color: var(--gray-400);">5 max per pillar</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center;">
              <div style="font-size: 36px; font-weight: 700; color: var(--gray-600);">~8.5K</div>
              <div style="font-size: 13px; font-weight: 600; color: var(--gray-700); margin-top: 4px;">Total Rows</div>
              <div style="font-size: 11px; color: var(--gray-400);">across all tables</div>
            </div>
          </div>
          
          <!-- Three Column Layout -->
          <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-lg);">
            
            <!-- COLUMN 1: Export Options -->
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 20px;">📊</span> Export Plan Data
              </h3>
              
              <!-- Plan Selector -->
              <div style="margin-bottom: var(--space-md);">
                <label style="font-size: 12px; font-weight: 500; color: var(--gray-600); display: block; margin-bottom: 6px;">Select Plan to Export</label>
                <select id="exportPlanSelect" class="form-select" style="width: 100%; padding: 10px; border: 1px solid var(--gray-200); border-radius: var(--radius-sm); font-size: 13px;">
                  <option value="working">📝 Working Plan (Current)</option>
                  <option value="published">📋 Published Plan v3.2 (Dec 2025)</option>
                  <option value="pub-nov">📋 Published Plan v3.1 (Nov 2025)</option>
                  <option value="scn-001">💾 Scenario: Jan Hiring Freeze</option>
                  <option value="scn-002">💾 Scenario: 20hr OT Strategy</option>
                </select>
              </div>
              
              <!-- Pillar Selector -->
              <div style="margin-bottom: var(--space-md);">
                <label style="font-size: 12px; font-weight: 500; color: var(--gray-600); display: block; margin-bottom: 6px;">Pillar Scope</label>
                <select id="exportPillarScope" class="form-select" style="width: 100%; padding: 10px; border: 1px solid var(--gray-200); border-radius: var(--radius-sm); font-size: 13px;">
                  <option value="all">All Pillars (Customer Care All-In)</option>
                  <option value="payroll">Payroll and Taxes</option>
                  <option value="benefits">Benefits</option>
                  <option value="members">Members</option>
                  <option value="accountant">Accountant</option>
                  <option value="money">Money</option>
                  <option value="premier">Premier</option>
                  <option value="pac">PAC</option>
                  <option value="bac">BAC</option>
                </select>
              </div>
              
              <!-- Export Format Options -->
              <div style="margin-bottom: var(--space-lg);">
                <label style="font-size: 12px; font-weight: 500; color: var(--gray-600); display: block; margin-bottom: 8px;">Export Format</label>
                
                <div onclick="selectExportFormat('pillar-template')" id="export-pillar-template" style="background: var(--gusto-teal-light); border: 2px solid var(--gusto-teal); border-radius: var(--radius-sm); padding: 12px; margin-bottom: 8px; cursor: pointer;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 18px;">📋</span>
                    <div>
                      <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Pillar Template Format</div>
                      <div style="font-size: 11px; color: var(--gray-500);">Wide format with months as columns - editable in Sheets</div>
                    </div>
                  </div>
                </div>
                
                <div onclick="selectExportFormat('executive-summary')" id="export-executive-summary" style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: var(--radius-sm); padding: 12px; margin-bottom: 8px; cursor: pointer;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 18px;">📄</span>
                    <div>
                      <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Executive Summary (PDF)</div>
                      <div style="font-size: 11px; color: var(--gray-500);">Stakeholder-ready report with insights</div>
                    </div>
                  </div>
                </div>
                
                <div onclick="selectExportFormat('raw-data')" id="export-raw-data" style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: var(--radius-sm); padding: 12px; cursor: pointer;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 18px;">📊</span>
                    <div>
                      <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Raw Data (CSV)</div>
                      <div style="font-size: 11px; color: var(--gray-500);">Normalized tables for data analysis</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <button onclick="exportPlanData()" class="btn btn-primary" style="width: 100%; padding: 12px; font-size: 14px;">
                📤 Export Selected Plan
              </button>
            </div>
            
            <!-- COLUMN 2: Import Options -->
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 20px;">📥</span> Import Data
              </h3>
              
              <!-- Import Type -->
              <div style="margin-bottom: var(--space-md);">
                <label style="font-size: 12px; font-weight: 500; color: var(--gray-600); display: block; margin-bottom: 8px;">Import Type</label>
                
                <div onclick="selectImportType('baseline')" id="import-baseline" style="background: var(--gusto-teal-light); border: 2px solid var(--gusto-teal); border-radius: var(--radius-sm); padding: 12px; margin-bottom: 8px; cursor: pointer;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 18px;">📈</span>
                    <div>
                      <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Baseline Forecast</div>
                      <div style="font-size: 11px; color: var(--gray-500);">Monthly volume, AHT, SL targets from forecast engine</div>
                    </div>
                  </div>
                </div>
                
                <div onclick="selectImportType('active-hc')" id="import-active-hc" style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: var(--radius-sm); padding: 12px; margin-bottom: 8px; cursor: pointer;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 18px;">👥</span>
                    <div>
                      <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Active Headcount</div>
                      <div style="font-size: 11px; color: var(--gray-500);">Actual HC by site from HR systems</div>
                    </div>
                  </div>
                </div>
                
                <div onclick="selectImportType('pillar-template')" id="import-pillar-template" style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: var(--radius-sm); padding: 12px; cursor: pointer;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 18px;">📋</span>
                    <div>
                      <div style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Pillar Template (Re-import)</div>
                      <div style="font-size: 11px; color: var(--gray-500);">Import edits made offline in Sheets</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- File Upload Area -->
              <div style="margin-bottom: var(--space-md);">
                <label style="font-size: 12px; font-weight: 500; color: var(--gray-600); display: block; margin-bottom: 6px;">Source</label>
                <div style="border: 2px dashed var(--gray-300); border-radius: var(--radius-sm); padding: 24px; text-align: center; background: var(--gray-50);">
                  <div style="font-size: 32px; margin-bottom: 8px;">📁</div>
                  <div style="font-size: 13px; color: var(--gray-600); margin-bottom: 8px;">Drag & drop file or</div>
                  <button class="btn btn-secondary" style="font-size: 12px;">Browse Google Drive</button>
                  <div style="font-size: 11px; color: var(--gray-400); margin-top: 8px;">Supports .csv, .xlsx, Google Sheets link</div>
                </div>
              </div>
              
              <button onclick="openImportModal()" class="btn btn-primary" style="width: 100%; padding: 12px; font-size: 14px;">
                📥 Import Data
              </button>
              
              <button onclick="runCalculations()" class="btn btn-secondary" style="width: 100%; padding: 12px; font-size: 14px; margin-top: 10px;">
                🧮 Run Calculations
              </button>
              
              <button onclick="testCalculation()" class="btn btn-secondary" style="width: 100%; padding: 10px; font-size: 12px; margin-top: 8px; opacity: 0.7;">
                🧪 Test Channel Calc (Payroll Phone May-25)
              </button>
              <div style="font-size: 10px; color: var(--gray-400); text-align: center; margin-top: 4px;">
                Compares against your actual Pillar Template data
              </div>
              
              <div style="margin-top: var(--space-md); padding: 12px; background: var(--warning-bg); border-radius: var(--radius-sm);">
                <div style="font-size: 12px; color: var(--warning); font-weight: 600;">⚠️ Import will update Working Plan</div>
                <div style="font-size: 11px; color: var(--gray-600); margin-top: 4px;">Review changes before publishing</div>
              </div>
            </div>
            
            <!-- COLUMN 3: Data Sources & Architecture -->
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 20px;">🔗</span> Data Sources
              </h3>
              
              <!-- Connected Sources -->
              <div style="margin-bottom: var(--space-lg);">
                <div style="font-size: 12px; font-weight: 500; color: var(--gray-600); margin-bottom: 8px;">Connected Sources</div>
                
                <div style="background: var(--success-bg); border-radius: var(--radius-sm); padding: 10px 12px; margin-bottom: 8px; display: flex; align-items: center; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="color: var(--success);">✓</span>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Plans_Registry</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Last sync: 2 min ago</div>
                    </div>
                  </div>
                  <button style="background: none; border: none; font-size: 12px; color: var(--gusto-teal); cursor: pointer;">🔄</button>
                </div>
                
                <div style="background: var(--success-bg); border-radius: var(--radius-sm); padding: 10px 12px; margin-bottom: 8px; display: flex; align-items: center; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="color: var(--success);">✓</span>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Plan_Inputs</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Last sync: 2 min ago</div>
                    </div>
                  </div>
                  <button style="background: none; border: none; font-size: 12px; color: var(--gusto-teal); cursor: pointer;">🔄</button>
                </div>
                
                <div style="background: var(--success-bg); border-radius: var(--radius-sm); padding: 10px 12px; margin-bottom: 8px; display: flex; align-items: center; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="color: var(--success);">✓</span>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Plan_Outputs</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Last sync: 2 min ago</div>
                    </div>
                  </div>
                  <button style="background: none; border: none; font-size: 12px; color: var(--gusto-teal); cursor: pointer;">🔄</button>
                </div>
                
                <div style="background: var(--success-bg); border-radius: var(--radius-sm); padding: 10px 12px; display: flex; align-items: center; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="color: var(--success);">✓</span>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Plan_Manual_Inputs</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Last sync: 2 min ago</div>
                    </div>
                  </div>
                  <button style="background: none; border: none; font-size: 12px; color: var(--gusto-teal); cursor: pointer;">🔄</button>
                </div>
              </div>
              
              <!-- Quick Links -->
              <div style="margin-bottom: var(--space-md);">
                <div style="font-size: 12px; font-weight: 500; color: var(--gray-600); margin-bottom: 8px;">Quick Links</div>
                <a href="https://docs.google.com/spreadsheets/d/1Jfm3Gv7xkaHtl5Vrf8qQpFtOElQu4MX-xl2OykBpuVs/edit" target="_blank" style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); text-decoration: none; color: var(--gray-700); font-size: 12px; margin-bottom: 6px;">
                  <span>📊</span> Open Source Spreadsheet
                  <span style="margin-left: auto; color: var(--gray-400);">↗</span>
                </a>
                <a href="#" onclick="openDataDictionary(); return false;" style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); text-decoration: none; color: var(--gray-700); font-size: 12px; margin-bottom: 6px;">
                  <span>📖</span> Data Dictionary
                  <span style="margin-left: auto; color: var(--gray-400);">→</span>
                </a>
                <a href="#" onclick="openArchitectureDocs(); return false;" style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); text-decoration: none; color: var(--gray-700); font-size: 12px;">
                  <span>🏗️</span> Architecture Docs
                  <span style="margin-left: auto; color: var(--gray-400);">→</span>
                </a>
              </div>
              
              <button onclick="syncAllData()" class="btn btn-secondary" style="width: 100%; padding: 10px; font-size: 13px;">
                🔄 Sync All Data Sources
              </button>
            </div>
          </div>
          
        </div><!-- END view-datamanagement -->
        
        <!-- ═══════════════════════════════════════════════════════════════════════
             PROJECT HUB VIEW - Sprint Timeline, Checklists, Notes
             ═══════════════════════════════════════════════════════════════════════ -->
        <div id="view-projecthub" class="view-container" style="display: none;">
          
          <!-- Page Header -->
          <div style="margin-bottom: var(--space-lg);">
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
              <h1 style="font-size: 24px; font-weight: 600; color: var(--gray-800);">🚀 Project Hub</h1>
              <span style="background: var(--info-bg); color: var(--info); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Phase 1 Prototype</span>
            </div>
            <p style="color: var(--gray-500); font-size: 14px;">Track progress, manage tasks, and document decisions</p>
          </div>
          
          <!-- Quick Stats Row -->
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-md); margin-bottom: var(--space-lg);">
            <div style="background: white; border-radius: var(--radius-md); padding: 16px 20px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">Sprint Progress</div>
              <div style="font-size: 24px; font-weight: 700; color: var(--gusto-teal);" id="sprintProgress">68%</div>
              <div style="width: 100%; height: 4px; background: var(--gray-200); border-radius: 2px; margin-top: 8px;">
                <div style="width: 68%; height: 100%; background: linear-gradient(90deg, var(--gusto-teal) 0%, var(--success) 100%); border-radius: 2px;"></div>
              </div>
            </div>
            <div style="background: white; border-radius: var(--radius-md); padding: 16px 20px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">Tasks Complete</div>
              <div style="font-size: 24px; font-weight: 700; color: var(--success);" id="tasksComplete">12/18</div>
            </div>
            <div style="background: white; border-radius: var(--radius-md); padding: 16px 20px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">Target Date</div>
              <div style="font-size: 24px; font-weight: 700; color: var(--gray-800);">Dec 31</div>
            </div>
            <div style="background: white; border-radius: var(--radius-md); padding: 16px 20px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px;">Days Left</div>
              <div style="font-size: 24px; font-weight: 700; color: var(--warning);" id="daysLeft">20</div>
            </div>
          </div>
          
          <!-- Two Column Layout -->
          <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--space-lg);">
            
            <!-- LEFT: Sprint Timeline & Tasks -->
            <div style="display: flex; flex-direction: column; gap: var(--space-lg);">
              
              <!-- Sprint Timeline -->
              <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
                <div onclick="toggleProjectSection(this)" style="display: flex; justify-content: space-between; align-items: center; padding: var(--space-lg); cursor: pointer; background: linear-gradient(135deg, var(--gusto-teal-light) 0%, white 100%); border-bottom: 1px solid var(--gray-200);">
                  <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); display: flex; align-items: center; gap: 8px; margin: 0;">
                    <span class="collapse-arrow" style="font-size: 12px; transition: transform 0.2s;">▼</span>
                    <span style="font-size: 18px;">📋</span> Sprint Checklist
                  </h3>
                  <div style="display: flex; gap: 8px; align-items: center;">
                    <span style="font-size: 11px; color: var(--gray-500);">Click to collapse</span>
                    <button onclick="event.stopPropagation(); addSprintTask()" style="background: var(--gusto-teal); color: white; border: none; padding: 6px 12px; border-radius: var(--radius-sm); font-size: 12px; cursor: pointer;">+ Add Task</button>
                  </div>
                </div>
                <div class="collapsible-content" style="padding: var(--space-lg); padding-top: var(--space-md);">
                
                
                <!-- Checklist Items -->
                <div id="sprintChecklist" style="display: flex; flex-direction: column; gap: 8px;">
                  
                  <!-- COMPLETED SECTION -->
                  <div style="font-size: 11px; color: var(--success); text-transform: uppercase; font-weight: 600; margin-top: 8px; margin-bottom: 4px;">✅ Completed</div>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Control Panel View</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Pillar overview, settings, quick stats</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 8</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">All-In View</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Combined pillar data with expandable sections</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 9</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Plan Comparison View</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Compare plans with key insights</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 10</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Dashboard View</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Charts, trends, site-level breakdowns</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 10</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Pillar View Template</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Channel staffing, overlays, insights</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 9</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Overlay Tracker</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Track quantified & unquantified overlays</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 10</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Data Management View</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Import/export, storage summary</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 10</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">GitHub Pages Deployment</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Shareable prototype URL</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 10</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Google Sheets Data Architecture</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Plans_Registry, Inputs, Outputs, Manual_Inputs</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 10</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Product Overview Document</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Scope, purpose, roadmap</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 11</span>
                  </label>
                  
                  <label class="task-item completed" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--success-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--success);">
                    <input type="checkbox" checked onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-600); text-decoration: line-through;">Responsive Design (basic)</div>
                      <div style="font-size: 10px; color: var(--gray-400);">Adapts to different screen sizes</div>
                    </div>
                    <span style="font-size: 10px; color: var(--success);">Dec 11</span>
                  </label>
                  
                  <!-- IN PROGRESS SECTION -->
                  <div style="font-size: 11px; color: var(--warning); text-transform: uppercase; font-weight: 600; margin-top: 16px; margin-bottom: 4px;">🔄 In Progress</div>
                  
                  <label class="task-item" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--warning-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--warning);">
                    <input type="checkbox" onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--warning);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-800); font-weight: 500;">Calculations Validation</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Verify HC formulas match spreadsheet logic</div>
                    </div>
                    <span style="font-size: 10px; color: var(--warning);">Dec 15</span>
                  </label>
                  
                  <label class="task-item" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--warning-bg); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--warning);">
                    <input type="checkbox" onchange="updateSprintProgress()" style="margin-top: 2px; accent-color: var(--warning);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-800); font-weight: 500;">Connect Real Data (1 Pillar)</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Test with actual baseline & HC data</div>
                    </div>
                    <span style="font-size: 10px; color: var(--warning);">Dec 20</span>
                  </label>
                  
                  <!-- UPCOMING SECTION -->
                  <div style="font-size: 11px; color: var(--gray-500); text-transform: uppercase; font-weight: 600; margin-top: 16px; margin-bottom: 4px;">📅 Upcoming</div>
                  
                  <label class="task-item" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--gray-300);">
                    <input type="checkbox" onchange="updateSprintProgress()" style="margin-top: 2px;">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">Training Documentation</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Quick start guide for new users</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Dec 23</span>
                  </label>
                  
                  <label class="task-item" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--gray-300);">
                    <input type="checkbox" onchange="updateSprintProgress()" style="margin-top: 2px;">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">Team Setup Guide</div>
                      <div style="font-size: 10px; color: var(--gray-500);">How new teams onboard to the tool</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Dec 27</span>
                  </label>
                  
                  <label class="task-item" style="display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--gray-300);">
                    <input type="checkbox" onchange="updateSprintProgress()" style="margin-top: 2px;">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">User Acceptance Testing</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Team testing with real scenarios</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Dec 31</span>
                  </label>
                  
                </div>
                </div><!-- END collapsible-content -->
              </div>
              
              <!-- Calculations Validation -->
              <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
                <div onclick="toggleProjectSection(this)" style="display: flex; justify-content: space-between; align-items: center; padding: var(--space-md) var(--space-lg); cursor: pointer; background: linear-gradient(135deg, var(--warning-bg) 0%, white 100%); border-bottom: 1px solid var(--gray-200);">
                  <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); display: flex; align-items: center; gap: 8px; margin: 0;">
                    <span class="collapse-arrow" style="font-size: 12px; transition: transform 0.2s;">▼</span>
                    <span style="font-size: 18px;">🧮</span> Calculations Validation
                  </h3>
                  <span style="font-size: 11px; color: var(--gray-500);">Click to collapse</span>
                </div>
                <div class="collapsible-content" style="padding: var(--space-lg);">
                <p style="font-size: 12px; color: var(--gray-500); margin-bottom: var(--space-md);">Verify tool calculations match your spreadsheet formulas</p>
                
                <div style="display: flex; flex-direction: column; gap: 8px;">
                  <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer;">
                    <input type="checkbox" style="accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">Base HC Need = Volume / (AHT × Occupancy × Concurrency × Productive Hours)</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Core formula</span>
                  </label>
                  
                  <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer;">
                    <input type="checkbox" style="accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">SL FTE Need = Base HC × SL Uplift Factor</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">SL adjustment</span>
                  </label>
                  
                  <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer;">
                    <input type="checkbox" style="accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">Shrink Adjusted HC = SL FTE / (1 - Shrink %)</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Shrink factor</span>
                  </label>
                  
                  <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer;">
                    <input type="checkbox" style="accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">Active HC Need = Shrink Adjusted × (1 + Overlay Impact %)</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Overlay application</span>
                  </label>
                  
                  <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer;">
                    <input type="checkbox" style="accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">Productive Hours = Working Days × Daily Hours × (1 - Shrink)</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Hours calc</span>
                  </label>
                  
                  <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer;">
                    <input type="checkbox" style="accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">Net Staffing Gap = Actual HC - Active HC Need</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Gap calculation</span>
                  </label>
                  
                  <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer;">
                    <input type="checkbox" style="accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">OT Coverage = Planned OT Hours / Standard Hours per FTE</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">OT conversion</span>
                  </label>
                  
                  <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer;">
                    <input type="checkbox" style="accent-color: var(--success);">
                    <div style="flex: 1;">
                      <div style="font-size: 13px; color: var(--gray-700);">Net Gap with OT = Net Staffing Gap + OT Coverage FTE</div>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-400);">Final position</span>
                  </label>
                </div>
                </div><!-- END collapsible-content -->
              </div>
              
            </div>
            
            <!-- RIGHT: Notes & Decisions -->
            <div style="display: flex; flex-direction: column; gap: var(--space-lg);">
              
              <!-- Quick Notes -->
              <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
                <div onclick="toggleProjectSection(this)" style="display: flex; justify-content: space-between; align-items: center; padding: var(--space-md) var(--space-lg); cursor: pointer; background: linear-gradient(135deg, var(--info-bg) 0%, white 100%); border-bottom: 1px solid var(--gray-200);">
                  <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); display: flex; align-items: center; gap: 8px; margin: 0;">
                    <span class="collapse-arrow" style="font-size: 12px; transition: transform 0.2s;">▼</span>
                    <span style="font-size: 18px;">📝</span> Notes & Decisions
                  </h3>
                  <div style="display: flex; gap: 8px; align-items: center;">
                    <span style="font-size: 11px; color: var(--gray-500);">Click to collapse</span>
                    <button onclick="event.stopPropagation(); saveProjectNotes()" style="background: var(--gusto-teal); color: white; border: none; padding: 6px 12px; border-radius: var(--radius-sm); font-size: 12px; cursor: pointer;">💾 Save</button>
                  </div>
                </div>
                <div class="collapsible-content" style="padding: var(--space-lg);">
                
                <textarea id="projectNotes" style="width: 100%; min-height: 300px; padding: 12px; border: 1px solid var(--gray-200); border-radius: var(--radius-sm); font-family: var(--font-primary); font-size: 13px; line-height: 1.6; resize: vertical;" placeholder="Document decisions, feedback, and ideas here...

Example entries:
---
Dec 11: Presentation went well! Stakeholders want full WFM suite but understand this is Phase 1.

Feedback received:
• Want forecasting capabilities (Phase 2+)
• Want interval-level IDPs (Phase 2+)  
• Love the visual design
• Concerned about multi-team scalability

Next steps:
• Validate calculations with real data
• Test with one pillar first
• Create training documentation
---"></textarea>
                <div style="font-size: 11px; color: var(--gray-400); margin-top: 8px;">💡 Notes are saved to browser localStorage</div>
                </div><!-- END collapsible-content -->
              </div>
              
              <!-- Key Decisions -->
              <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
                <div onclick="toggleProjectSection(this)" style="display: flex; justify-content: space-between; align-items: center; padding: var(--space-md) var(--space-lg); cursor: pointer; background: linear-gradient(135deg, var(--gusto-teal-light) 0%, white 100%); border-bottom: 1px solid var(--gray-200);">
                  <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); display: flex; align-items: center; gap: 8px; margin: 0;">
                    <span class="collapse-arrow" style="font-size: 12px; transition: transform 0.2s;">▼</span>
                    <span style="font-size: 18px;">🎯</span> Key Decisions Log
                  </h3>
                  <span style="font-size: 11px; color: var(--gray-500);">Click to collapse</span>
                </div>
                <div class="collapsible-content" style="padding: var(--space-lg);">
                
                <div style="display: flex; flex-direction: column; gap: 10px;">
                  <div style="padding: 12px; background: var(--gusto-teal-light); border-radius: var(--radius-sm); border-left: 3px solid var(--gusto-teal);">
                    <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal);">Architecture Decision</div>
                    <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Google Sheets as database for Phase 1, with option for server-side DB later</div>
                    <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Dec 10, 2025</div>
                  </div>
                  
                  <div style="padding: 12px; background: var(--gusto-teal-light); border-radius: var(--radius-sm); border-left: 3px solid var(--gusto-teal);">
                    <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal);">Versioning Approach</div>
                    <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Full copy for scenarios (not delta-only) to maintain complete data per scenario</div>
                    <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Dec 10, 2025</div>
                  </div>
                  
                  <div style="padding: 12px; background: var(--gusto-teal-light); border-radius: var(--radius-sm); border-left: 3px solid var(--gusto-teal);">
                    <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal);">Scope Definition</div>
                    <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Phase 1 = Capacity Planning core only. Forecasting, IDPs, full WFM = future phases</div>
                    <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Dec 11, 2025</div>
                  </div>
                  
                  <div style="padding: 12px; background: var(--gusto-teal-light); border-radius: var(--radius-sm); border-left: 3px solid var(--gusto-teal);">
                    <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal);">Export Contingency</div>
                    <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Export to Pillar Template format so users can work in Sheets if tool is down</div>
                    <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Dec 10, 2025</div>
                  </div>
                </div>
                </div><!-- END collapsible-content -->
              </div>
              
              <!-- Roadmap Quick View -->
              <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
                <div onclick="toggleProjectSection(this)" style="display: flex; justify-content: space-between; align-items: center; padding: var(--space-md) var(--space-lg); cursor: pointer; background: linear-gradient(135deg, var(--gusto-coral-light) 0%, white 100%); border-bottom: 1px solid var(--gray-200);">
                  <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); display: flex; align-items: center; gap: 8px; margin: 0;">
                    <span class="collapse-arrow" style="font-size: 12px; transition: transform 0.2s;">▼</span>
                    <span style="font-size: 18px;">🗺️</span> Roadmap Overview
                  </h3>
                  <span style="font-size: 11px; color: var(--gray-500);">Click to collapse</span>
                </div>
                <div class="collapsible-content" style="padding: var(--space-lg);">
                
                <div style="display: flex; flex-direction: column; gap: 8px;">
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 60px; font-size: 11px; font-weight: 600; color: var(--success);">Phase 1</div>
                    <div style="flex: 1; height: 20px; background: var(--success); border-radius: 4px; display: flex; align-items: center; padding: 0 8px;">
                      <span style="font-size: 10px; color: white;">Prototype & Validation</span>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-500);">Dec '25</span>
                  </div>
                  
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 60px; font-size: 11px; font-weight: 600; color: var(--info);">Phase 2</div>
                    <div style="flex: 1; height: 20px; background: var(--info); border-radius: 4px; display: flex; align-items: center; padding: 0 8px;">
                      <span style="font-size: 10px; color: white;">Live Data + Calculations</span>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-500);">Q1 '26</span>
                  </div>
                  
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 60px; font-size: 11px; font-weight: 600; color: var(--gusto-coral);">Phase 3</div>
                    <div style="flex: 1; height: 20px; background: var(--gusto-coral); border-radius: 4px; display: flex; align-items: center; padding: 0 8px;">
                      <span style="font-size: 10px; color: white;">Multi-Team + Advanced</span>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-500);">Q2 '26</span>
                  </div>
                  
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 60px; font-size: 11px; font-weight: 600; color: var(--gray-400);">Future</div>
                    <div style="flex: 1; height: 20px; background: var(--gray-300); border-radius: 4px; display: flex; align-items: center; padding: 0 8px;">
                      <span style="font-size: 10px; color: var(--gray-600);">Full WFM Suite</span>
                    </div>
                    <span style="font-size: 10px; color: var(--gray-500);">TBD</span>
                  </div>
                </div>
                </div><!-- END collapsible-content -->
              </div>
              
            </div>
          </div>
          
        </div><!-- END view-projecthub -->
        
        <!-- ═══════════════════════════════════════════════════════════════════════
             DESIGN SYSTEM VIEW - Colors, Typography, Components Reference
             ═══════════════════════════════════════════════════════════════════════ -->
        <div id="view-designsystem" class="view-container" style="display: none;">
          
          <!-- Page Header -->
          <div style="margin-bottom: var(--space-lg);">
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
              <h1 style="font-size: 24px; font-weight: 600; color: var(--gray-800);">🎨 Design System</h1>
              <span style="background: var(--gusto-teal-light); color: var(--gusto-teal); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Reference Guide</span>
            </div>
            <p style="color: var(--gray-500); font-size: 14px;">Visual standards for consistent design across the Capacity Planning Tool</p>
          </div>
          
          <!-- Color Palette -->
          <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); margin-bottom: var(--space-lg);">
            <h3 style="font-size: 18px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md);">🎨 Color Palette</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: var(--space-md);">
              <!-- Brand Colors -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 8px;">Brand Colors</div>
                <div style="display: flex; flex-direction: column; gap: 6px;">
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gusto-teal); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Gusto Teal</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#0A8080</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gusto-teal-light); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Teal Light</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#E6F4F4</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gusto-coral); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Gusto Coral</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#F45D48</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Status Colors -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 8px;">Status Colors</div>
                <div style="display: flex; flex-direction: column; gap: 6px;">
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--success); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Success</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#10B981</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--warning); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Warning</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#F59E0B</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--error); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Error</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#EF4444</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--info); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Info</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#3B82F6</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Neutral Colors -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 8px;">Neutrals</div>
                <div style="display: flex; flex-direction: column; gap: 6px;">
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gray-800); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Gray 800</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#1F2937</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gray-500); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Gray 500</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#6B7280</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gray-200); border-radius: var(--radius-sm); border: 1px solid var(--gray-300);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Gray 200</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#E5E7EB</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gray-50); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Gray 50</div>
                      <div style="font-size: 10px; color: var(--gray-500); font-family: var(--font-mono);">#F9FAFB</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Staffing Colors -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 8px;">Staffing Indicators</div>
                <div style="display: flex; flex-direction: column; gap: 6px;">
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--overstaffed); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Overstaffed</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Positive gap (green)</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--understaffed); border-radius: var(--radius-sm);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Understaffed</div>
                      <div style="font-size: 10px; color: var(--gray-500);">Negative gap (red)</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--editable); border-radius: var(--radius-sm); border: 1px solid var(--warning);"></div>
                    <div>
                      <div style="font-size: 12px; font-weight: 500;">Editable Cell</div>
                      <div style="font-size: 10px; color: var(--gray-500);">User input fields</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Typography -->
          <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); margin-bottom: var(--space-lg);">
            <h3 style="font-size: 18px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md);">📝 Typography</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 12px;">Font Family</div>
                <div style="font-family: var(--font-primary); font-size: 24px; margin-bottom: 8px;">DM Sans / Inter</div>
                <div style="font-size: 12px; color: var(--gray-500);">Primary font for all UI elements</div>
                <code style="display: block; margin-top: 8px; padding: 8px; background: var(--gray-50); border-radius: var(--radius-sm); font-size: 11px;">font-family: var(--font-primary);</code>
              </div>
              
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 12px;">Type Scale</div>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                  <div><span style="font-size: 24px; font-weight: 600;">Page Title</span> <span style="font-size: 11px; color: var(--gray-500);">24px / 600</span></div>
                  <div><span style="font-size: 18px; font-weight: 600;">Section Header</span> <span style="font-size: 11px; color: var(--gray-500);">18px / 600</span></div>
                  <div><span style="font-size: 16px; font-weight: 600;">Card Title</span> <span style="font-size: 11px; color: var(--gray-500);">16px / 600</span></div>
                  <div><span style="font-size: 14px;">Body Text</span> <span style="font-size: 11px; color: var(--gray-500);">14px / 400</span></div>
                  <div><span style="font-size: 12px;">Small Text</span> <span style="font-size: 11px; color: var(--gray-500);">12px / 400</span></div>
                  <div><span style="font-size: 10px; text-transform: uppercase; letter-spacing: 0.05em;">Label</span> <span style="font-size: 11px; color: var(--gray-500);">10px / uppercase</span></div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Components -->
          <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); margin-bottom: var(--space-lg);">
            <h3 style="font-size: 18px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md);">🧩 Components</h3>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-lg);">
              
              <!-- Buttons -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 12px;">Buttons</div>
                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px;">
                  <button class="btn btn-primary">Primary</button>
                  <button class="btn btn-secondary">Secondary</button>
                  <button style="background: none; border: none; color: var(--gusto-teal); font-size: 13px; cursor: pointer;">Text Link</button>
                </div>
                <code style="display: block; padding: 8px; background: var(--gray-50); border-radius: var(--radius-sm); font-size: 11px;">class="btn btn-primary"</code>
              </div>
              
              <!-- Cards -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 12px;">Cards</div>
                <div style="background: white; border-radius: var(--radius-md); padding: 16px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
                  <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">Card Title</div>
                  <div style="font-size: 12px; color: var(--gray-500);">Card content goes here</div>
                </div>
                <code style="display: block; margin-top: 8px; padding: 8px; background: var(--gray-50); border-radius: var(--radius-sm); font-size: 11px;">border-radius: var(--radius-lg); box-shadow: var(--shadow-sm);</code>
              </div>
              
              <!-- Status Badges -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 12px;">Status Badges</div>
                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px;">
                  <span style="background: var(--success-bg); color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
                  <span style="background: var(--warning-bg); color: var(--warning); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Pending</span>
                  <span style="background: var(--error-bg); color: var(--error); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Error</span>
                  <span style="background: var(--info-bg); color: var(--info); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Info</span>
                </div>
              </div>
              
              <!-- Table Headers -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 12px;">Table Header Gradient</div>
                <div style="background: linear-gradient(180deg, var(--gusto-teal) 0%, var(--gusto-teal-dark) 100%); padding: 12px 16px; border-radius: var(--radius-sm); color: white; font-size: 12px; font-weight: 600;">
                  Column Header
                </div>
                <code style="display: block; margin-top: 8px; padding: 8px; background: var(--gray-50); border-radius: var(--radius-sm); font-size: 11px;">linear-gradient(180deg, var(--gusto-teal) 0%, var(--gusto-teal-dark) 100%)</code>
              </div>
              
            </div>
          </div>
          
          <!-- Spacing & Layout -->
          <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
            <h3 style="font-size: 18px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md);">📐 Spacing & Layout</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 12px;">Spacing Scale</div>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 4px; height: 20px; background: var(--gusto-teal);"></div>
                    <code style="font-size: 11px;">--space-xs: 4px</code>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 8px; height: 20px; background: var(--gusto-teal);"></div>
                    <code style="font-size: 11px;">--space-sm: 8px</code>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 16px; height: 20px; background: var(--gusto-teal);"></div>
                    <code style="font-size: 11px;">--space-md: 16px</code>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 24px; height: 20px; background: var(--gusto-teal);"></div>
                    <code style="font-size: 11px;">--space-lg: 24px</code>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 32px; height: 20px; background: var(--gusto-teal);"></div>
                    <code style="font-size: 11px;">--space-xl: 32px</code>
                  </div>
                </div>
              </div>
              
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 12px;">Border Radius</div>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gray-200); border-radius: var(--radius-sm);"></div>
                    <code style="font-size: 11px;">--radius-sm: 6px</code>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gray-200); border-radius: var(--radius-md);"></div>
                    <code style="font-size: 11px;">--radius-md: 10px</code>
                  </div>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--gray-200); border-radius: var(--radius-lg);"></div>
                    <code style="font-size: 11px;">--radius-lg: 16px</code>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
        </div><!-- END view-designsystem -->
        
        <!-- ═══════════════════════════════════════════════════════════════════════
             PRODUCT OVERVIEW VIEW - Scope, Purpose, Roadmap
             ═══════════════════════════════════════════════════════════════════════ -->
        <div id="view-overview" class="view-container" style="display: none;">
          
          <!-- Phase 1 Banner -->
          <div style="background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%); border-radius: var(--radius-lg); padding: 16px 24px; margin-bottom: var(--space-lg); display: flex; align-items: center; gap: 16px; border: 1px solid #F59E0B;">
            <span style="font-size: 28px;">⚠️</span>
            <div>
              <div style="font-weight: 600; color: #92400E; font-size: 14px;">Phase 1 Prototype — Foundation Only</div>
              <div style="font-size: 13px; color: #78350F;">This is the capacity planning core. Forecasting, IDPs, and full WFM capabilities are planned for future phases.</div>
            </div>
          </div>
          
          <!-- Header -->
          <div style="text-align: center; margin-bottom: var(--space-xl);">
            <div style="display: inline-flex; align-items: center; gap: 12px; background: white; padding: 12px 24px; border-radius: 50px; box-shadow: var(--shadow-md); margin-bottom: 20px;">
              <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--gusto-teal) 0%, var(--gusto-teal-dark) 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 18px;">G</div>
              <span style="font-size: 18px; font-weight: 600; color: var(--gray-800);">Gusto Customer Care</span>
            </div>
            <h1 style="font-size: 36px; font-weight: 700; color: var(--gray-900); margin-bottom: 12px;">Capacity Planning Tool</h1>
            <p style="font-size: 16px; color: var(--gray-600); max-width: 600px; margin: 0 auto;">A unified platform for workforce planning, scenario analysis, and cross-pillar visibility</p>
            <span style="display: inline-block; background: var(--gusto-coral); color: white; padding: 6px 16px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-top: 16px;">V1 PROTOTYPE • DECEMBER 2025</span>
          </div>
          
          <!-- Quick Stats -->
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-md); margin-bottom: var(--space-xl);">
            <div style="background: white; border-radius: var(--radius-lg); padding: 24px; text-align: center; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <div style="font-size: 42px; font-weight: 700; color: var(--gusto-teal);">11</div>
              <div style="font-size: 12px; color: var(--gray-500); text-transform: uppercase; margin-top: 8px;">Views Built</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: 24px; text-align: center; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <div style="font-size: 42px; font-weight: 700; color: var(--gusto-teal);">9</div>
              <div style="font-size: 12px; color: var(--gray-500); text-transform: uppercase; margin-top: 8px;">Pillars Supported</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: 24px; text-align: center; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <div style="font-size: 42px; font-weight: 700; color: var(--gusto-teal);">24</div>
              <div style="font-size: 12px; color: var(--gray-500); text-transform: uppercase; margin-top: 8px;">Month Horizon</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: 24px; text-align: center; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <div style="font-size: 42px; font-weight: 700; color: var(--success);">✓</div>
              <div style="font-size: 12px; color: var(--gray-500); text-transform: uppercase; margin-top: 8px;">Sheets Integration</div>
            </div>
          </div>
          
          <!-- Two Column Layout -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg); margin-bottom: var(--space-xl);">
            
            <!-- Purpose & Scope -->
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <h3 style="font-size: 18px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 22px;">🎯</span> Purpose & Scope
              </h3>
              <p style="color: var(--gray-600); font-size: 14px; margin-bottom: var(--space-md);">Replace fragmented spreadsheets with a unified capacity planning platform that provides:</p>
              <ul style="color: var(--gray-600); font-size: 14px; padding-left: 20px; display: flex; flex-direction: column; gap: 8px;">
                <li><strong>Cross-Pillar Visibility</strong> — See all teams in one view</li>
                <li><strong>Scenario Planning</strong> — What-if analysis without breaking production data</li>
                <li><strong>Overlay Tracking</strong> — Document and quantify business impacts</li>
                <li><strong>Auto-Generated Insights</strong> — AI-powered summaries for stakeholders</li>
                <li><strong>Export Flexibility</strong> — Work in Sheets if needed, re-import easily</li>
              </ul>
            </div>
            
            <!-- V1 Functionality -->
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
              <h3 style="font-size: 18px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 22px;">✅</span> V1 Functionality
              </h3>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">🎛️ Control Panel</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">🔗 All-In View</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">⚖️ Plan Comparison</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">📊 Dashboard</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">🏛️ Pillar Views</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">🎚️ Overlay Tracker</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">🗄️ Data Management</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">🚀 Project Hub</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">🎨 Design System</div>
                </div>
                <div style="background: var(--success-bg); padding: 10px 12px; border-radius: var(--radius-sm); border-left: 3px solid var(--success);">
                  <div style="font-size: 12px; font-weight: 600; color: var(--gray-800);">💡 Auto Insights</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Roadmap -->
          <div style="background: linear-gradient(135deg, var(--gusto-teal) 0%, var(--gusto-teal-dark) 100%); border-radius: var(--radius-lg); padding: var(--space-xl); color: white; margin-bottom: var(--space-xl);">
            <h3 style="font-size: 20px; font-weight: 600; margin-bottom: var(--space-lg); display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 24px;">🗺️</span> Roadmap
            </h3>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-md);">
              <div style="background: rgba(255,255,255,0.15); border-radius: var(--radius-md); padding: 20px; border: 2px solid rgba(255,255,255,0.3);">
                <div style="font-size: 11px; text-transform: uppercase; opacity: 0.8; margin-bottom: 8px;">Phase 1 — Now</div>
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Prototype</div>
                <div style="font-size: 12px; opacity: 0.9;">UI/UX complete, data architecture, calculation engine</div>
              </div>
              <div style="background: rgba(255,255,255,0.1); border-radius: var(--radius-md); padding: 20px;">
                <div style="font-size: 11px; text-transform: uppercase; opacity: 0.8; margin-bottom: 8px;">Phase 2 — Q1 '26</div>
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Live Data</div>
                <div style="font-size: 12px; opacity: 0.9;">Real Sheets connection, validated calculations, team testing</div>
              </div>
              <div style="background: rgba(255,255,255,0.1); border-radius: var(--radius-md); padding: 20px;">
                <div style="font-size: 11px; text-transform: uppercase; opacity: 0.8; margin-bottom: 8px;">Phase 3 — Q2 '26</div>
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Multi-Team</div>
                <div style="font-size: 12px; opacity: 0.9;">Multiple orgs, advanced scenarios, executive reporting</div>
              </div>
              <div style="background: rgba(255,255,255,0.05); border-radius: var(--radius-md); padding: 20px;">
                <div style="font-size: 11px; text-transform: uppercase; opacity: 0.8; margin-bottom: 8px;">Future</div>
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Full WFM</div>
                <div style="font-size: 12px; opacity: 0.9;">Forecasting hub, interval IDPs, Slack integration</div>
              </div>
            </div>
          </div>
          
          <!-- Data Architecture -->
          <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); margin-bottom: var(--space-xl);">
            <h3 style="font-size: 18px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 22px;">🏗️</span> Data Architecture
            </h3>
            <div style="overflow-x: auto;">
              <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                <thead>
                  <tr style="background: var(--gray-100);">
                    <th style="padding: 12px 16px; text-align: left; font-weight: 600; border-bottom: 2px solid var(--gray-200);">Sheet</th>
                    <th style="padding: 12px 16px; text-align: left; font-weight: 600; border-bottom: 2px solid var(--gray-200);">Purpose</th>
                    <th style="padding: 12px 16px; text-align: left; font-weight: 600; border-bottom: 2px solid var(--gray-200);">Key Fields</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100); font-weight: 500;">Plans_Registry</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100);">Track all plans & scenarios</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100); color: var(--gray-500);">plan_id, type, status, pillar_scope</td>
                  </tr>
                  <tr style="background: var(--gray-50);">
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100); font-weight: 500;">Plan_Inputs</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100);">Baseline & overlay inputs</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100); color: var(--gray-500);">Volume, AHT, Shrink, Occupancy, SL</td>
                  </tr>
                  <tr>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100); font-weight: 500;">Plan_Outputs</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100);">Calculated results</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-100); color: var(--gray-500);">HC Need, FTE, Gap, OT metrics</td>
                  </tr>
                  <tr style="background: var(--gray-50);">
                    <td style="padding: 12px 16px; font-weight: 500;">Plan_Manual_Inputs</td>
                    <td style="padding: 12px 16px;">Site-level manual data</td>
                    <td style="padding: 12px 16px; color: var(--gray-500);">New hires, Attrition, Planned OT</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- Known Gaps -->
          <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200);">
            <h3 style="font-size: 18px; font-weight: 600; color: var(--gray-800); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 22px;">⚠️</span> Known Gaps (Phase 1)
            </h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-md);">
              <div style="background: var(--warning-bg); padding: 14px; border-radius: var(--radius-sm); border-left: 3px solid var(--warning);">
                <div style="font-size: 13px; font-weight: 600; color: var(--gray-800);">Live Data Connection</div>
                <div style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">Currently using sample data — real Sheets API connection in Phase 2</div>
              </div>
              <div style="background: var(--warning-bg); padding: 14px; border-radius: var(--radius-sm); border-left: 3px solid var(--warning);">
                <div style="font-size: 13px; font-weight: 600; color: var(--gray-800);">Calculation Validation</div>
                <div style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">Team review in progress to verify formulas match spreadsheet logic</div>
              </div>
              <div style="background: var(--warning-bg); padding: 14px; border-radius: var(--radius-sm); border-left: 3px solid var(--warning);">
                <div style="font-size: 13px; font-weight: 600; color: var(--gray-800);">User Authentication</div>
                <div style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">No login system yet — future production requirement</div>
              </div>
              <div style="background: var(--warning-bg); padding: 14px; border-radius: var(--radius-sm); border-left: 3px solid var(--warning);">
                <div style="font-size: 13px; font-weight: 600; color: var(--gray-800);">Multi-Team Scalability</div>
                <div style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">Architecture supports it, but UI needs work for team separation</div>
              </div>
            </div>
          </div>
          
        </div><!-- END view-overview -->
        
        <!-- ═══════════════════════════════════════════════════════════════════════
             PUBLISHED PLANS VIEW - Archive of all published plans
             ═══════════════════════════════════════════════════════════════════════ -->
        <div id="view-published" class="view-container" style="display: none;">
          
          <!-- Page Header -->
          <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-lg);">
            <div>
              <h1 style="font-size: 24px; font-weight: 600; color: var(--gray-800);">📋 Published Plans</h1>
              <p style="color: var(--gray-500); font-size: 14px;">Archive of finalized capacity plans by month</p>
            </div>
            <div style="display: flex; gap: var(--space-sm);">
              <button class="btn btn-secondary" onclick="filterPublishedPlans('all')">All</button>
              <button class="btn btn-secondary" onclick="filterPublishedPlans('2025')">2025</button>
              <button class="btn btn-secondary" onclick="filterPublishedPlans('2026')">2026</button>
            </div>
          </div>
          
          <!-- Published Plans Table -->
          <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
            <table style="width: 100%; border-collapse: collapse;">
              <thead>
                <tr style="background: linear-gradient(180deg, var(--gusto-teal) 0%, var(--gusto-teal-dark) 100%);">
                  <th style="padding: 14px 16px; text-align: left; color: white; font-size: 12px; font-weight: 600;">Plan Name</th>
                  <th style="padding: 14px 16px; text-align: center; color: white; font-size: 12px; font-weight: 600;">Period</th>
                  <th style="padding: 14px 16px; text-align: center; color: white; font-size: 12px; font-weight: 600;">Published</th>
                  <th style="padding: 14px 16px; text-align: center; color: white; font-size: 12px; font-weight: 600;">Published By</th>
                  <th style="padding: 14px 16px; text-align: center; color: white; font-size: 12px; font-weight: 600;">Pillars</th>
                  <th style="padding: 14px 16px; text-align: center; color: white; font-size: 12px; font-weight: 600;">Total HC</th>
                  <th style="padding: 14px 16px; text-align: center; color: white; font-size: 12px; font-weight: 600;">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background: var(--success-bg);">
                  <td style="padding: 14px 16px; font-weight: 600; border-bottom: 1px solid var(--gray-200);">
                    <span style="display: flex; align-items: center; gap: 8px;">
                      <span style="background: var(--success); color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px;">CURRENT</span>
                      December 2025 Plan
                    </span>
                  </td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">Dec 2025 → Nov 2026</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">Dec 6, 2025</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">B. Bates</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">9</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200); font-weight: 600;">384</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="View">👁️</button>
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Export">📥</button>
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Compare">⚖️</button>
                  </td>
                </tr>
                <tr>
                  <td style="padding: 14px 16px; font-weight: 500; border-bottom: 1px solid var(--gray-200);">November 2025 Plan</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">Nov 2025 → Oct 2026</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">Nov 5, 2025</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">B. Bates</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">9</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200); font-weight: 600;">378</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="View">👁️</button>
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Export">📥</button>
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Compare">⚖️</button>
                  </td>
                </tr>
                <tr style="background: var(--gray-50);">
                  <td style="padding: 14px 16px; font-weight: 500; border-bottom: 1px solid var(--gray-200);">October 2025 Plan</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">Oct 2025 → Sep 2026</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">Oct 4, 2025</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">B. Bates</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">8</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200); font-weight: 600;">365</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="View">👁️</button>
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Export">📥</button>
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Compare">⚖️</button>
                  </td>
                </tr>
                <tr>
                  <td style="padding: 14px 16px; font-weight: 500; border-bottom: 1px solid var(--gray-200);">September 2025 Plan</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">Sep 2025 → Aug 2026</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">Sep 3, 2025</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">B. Bates</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">8</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200); font-weight: 600;">358</td>
                  <td style="padding: 14px 16px; text-align: center; border-bottom: 1px solid var(--gray-200);">
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="View">👁️</button>
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Export">📥</button>
                    <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Compare">⚖️</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <!-- Archive Notice -->
          <div style="margin-top: var(--space-lg); background: var(--gray-50); border-radius: var(--radius-md); padding: var(--space-md); border: 1px solid var(--gray-200); display: flex; align-items: center; gap: 12px;">
            <span style="font-size: 20px;">📦</span>
            <div>
              <strong style="color: var(--gray-700);">Archive:</strong>
              <span style="color: var(--gray-500);"> Plans older than 12 months are moved to the archive. <a href="#" onclick="showToast('📦 Archive view coming soon!', 'info'); return false;" style="color: var(--gusto-teal);">View Archive →</a></span>
            </div>
          </div>
          
        </div><!-- END view-published -->
        
        <!-- ═══════════════════════════════════════════════════════════════════════
             SCENARIOS VIEW - Saved what-if scenarios
             ═══════════════════════════════════════════════════════════════════════ -->
        <div id="view-scenarios" class="view-container" style="display: none;">
          
          <!-- Page Header -->
          <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-lg);">
            <div>
              <h1 style="font-size: 24px; font-weight: 600; color: var(--gray-800);">💾 Saved Scenarios</h1>
              <p style="color: var(--gray-500); font-size: 14px;">What-if analysis scenarios for capacity planning</p>
            </div>
            <div style="display: flex; gap: var(--space-sm);">
              <select class="form-select" style="padding: 8px 12px; font-size: 13px;">
                <option>All Pillars</option>
                <option>Payroll</option>
                <option>Benefits</option>
                <option>Members</option>
              </select>
              <button class="btn btn-primary" onclick="showToast('✨ Create new scenario', 'info')">+ New Scenario</button>
            </div>
          </div>
          
          <!-- Scenario Cards -->
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-lg);">
            
            <!-- Scenario 1 -->
            <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
              <div style="padding: var(--space-md); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div style="font-weight: 600; font-size: 15px; color: var(--gray-800);">+10% Volume Increase</div>
                  <div style="font-size: 12px; color: var(--gray-500);">Payroll • Created Dec 8, 2025</div>
                </div>
                <span style="background: var(--warning-bg); color: var(--warning); padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Draft</span>
              </div>
              <div style="padding: var(--space-md);">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-sm); margin-bottom: var(--space-md);">
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--gusto-coral);">+5</div>
                    <div style="font-size: 10px; color: var(--gray-500);">HC Need Δ</div>
                  </div>
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--error);">-42</div>
                    <div style="font-size: 10px; color: var(--gray-500);">Staffing Gap</div>
                  </div>
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--warning);">+65</div>
                    <div style="font-size: 10px; color: var(--gray-500);">OT Hours</div>
                  </div>
                </div>
                <div style="display: flex; gap: 8px;">
                  <button class="btn btn-secondary" style="flex: 1; font-size: 12px;" onclick="loadView('comparison')">Compare</button>
                  <button class="btn btn-primary" style="flex: 1; font-size: 12px;" onclick="showToast('📋 Publishing scenario...', 'info')">Publish</button>
                </div>
              </div>
            </div>
            
            <!-- Scenario 2 -->
            <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
              <div style="padding: var(--space-md); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div style="font-weight: 600; font-size: 15px; color: var(--gray-800);">-15% AHT Reduction</div>
                  <div style="font-size: 12px; color: var(--gray-500);">Benefits • Created Dec 6, 2025</div>
                </div>
                <span style="background: var(--success-bg); color: var(--success); padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Ready</span>
              </div>
              <div style="padding: var(--space-md);">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-sm); margin-bottom: var(--space-md);">
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--success);">-8</div>
                    <div style="font-size: 10px; color: var(--gray-500);">HC Need Δ</div>
                  </div>
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--warning);">-18</div>
                    <div style="font-size: 10px; color: var(--gray-500);">Staffing Gap</div>
                  </div>
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--success);">-120</div>
                    <div style="font-size: 10px; color: var(--gray-500);">OT Hours</div>
                  </div>
                </div>
                <div style="display: flex; gap: 8px;">
                  <button class="btn btn-secondary" style="flex: 1; font-size: 12px;" onclick="loadView('comparison')">Compare</button>
                  <button class="btn btn-primary" style="flex: 1; font-size: 12px;" onclick="showToast('📋 Publishing scenario...', 'info')">Publish</button>
                </div>
              </div>
            </div>
            
            <!-- Scenario 3 -->
            <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
              <div style="padding: var(--space-md); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div style="font-weight: 600; font-size: 15px; color: var(--gray-800);">Q2 Hiring Freeze</div>
                  <div style="font-size: 12px; color: var(--gray-500);">All Pillars • Created Dec 4, 2025</div>
                </div>
                <span style="background: var(--error-bg); color: var(--error); padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">⚠️ Risk</span>
              </div>
              <div style="padding: var(--space-md);">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-sm); margin-bottom: var(--space-md);">
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--gray-600);">0</div>
                    <div style="font-size: 10px; color: var(--gray-500);">HC Need Δ</div>
                  </div>
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--error);">-65</div>
                    <div style="font-size: 10px; color: var(--gray-500);">Staffing Gap</div>
                  </div>
                  <div style="text-align: center;">
                    <div style="font-size: 20px; font-weight: 700; color: var(--error);">+340</div>
                    <div style="font-size: 10px; color: var(--gray-500);">OT Hours</div>
                  </div>
                </div>
                <div style="display: flex; gap: 8px;">
                  <button class="btn btn-secondary" style="flex: 1; font-size: 12px;" onclick="loadView('comparison')">Compare</button>
                  <button class="btn btn-secondary" style="flex: 1; font-size: 12px;" onclick="showToast('🗑️ Deleting scenario...', 'info')">Delete</button>
                </div>
              </div>
            </div>
            
            <!-- Add New Scenario Card -->
            <div style="background: var(--gray-50); border-radius: var(--radius-lg); border: 2px dashed var(--gray-300); display: flex; flex-direction: column; align-items: center; justify-content: center; padding: var(--space-xl); cursor: pointer; transition: all 0.2s;" onclick="showToast('✨ Create new scenario', 'info')" onmouseover="this.style.borderColor='var(--gusto-teal)'; this.style.background='var(--gusto-teal-light)';" onmouseout="this.style.borderColor='var(--gray-300)'; this.style.background='var(--gray-50)';">
              <span style="font-size: 32px; margin-bottom: 8px;">➕</span>
              <span style="font-weight: 600; color: var(--gray-600);">Create New Scenario</span>
              <span style="font-size: 12px; color: var(--gray-400); margin-top: 4px;">Start a what-if analysis</span>
            </div>
            
          </div>
          
          <!-- Scenario Limit Notice -->
          <div style="margin-top: var(--space-lg); background: var(--info-bg); border-radius: var(--radius-md); padding: var(--space-md); border: 1px solid var(--info); display: flex; align-items: center; gap: 12px;">
            <span style="font-size: 20px;">💡</span>
            <div>
              <strong style="color: var(--gray-700);">Scenario Limit:</strong>
              <span style="color: var(--gray-500);"> You can save up to 5 scenarios per pillar. Delete unused scenarios to create new ones.</span>
            </div>
          </div>
          
        </div><!-- END view-scenarios -->
        
        <!-- ═══════════════════════════════════════════════════════════════════════
             OVERLAY TRACKER VIEW - Track and manage all overlays
             ═══════════════════════════════════════════════════════════════════════ -->
        <div id="view-overlays" class="view-container" style="display: none;">
          
          <!-- Page Header -->
          <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-lg);">
            <div>
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                <h1 style="font-size: 24px; font-weight: 600; color: var(--gray-800);">🎚️ Overlay Tracker</h1>
                <span style="background: var(--gusto-teal-light); color: var(--gusto-teal-dark); padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 600;">6 Active</span>
              </div>
              <p style="color: var(--gray-500); font-size: 14px;">Track business requests and adjustments layered on top of baseline forecasts</p>
            </div>
            <div style="display: flex; gap: var(--space-sm);">
              <button class="btn btn-secondary" onclick="filterOverlays('all')">All</button>
              <button class="btn btn-secondary" onclick="filterOverlays('active')" style="background: var(--success-bg); border-color: var(--success); color: var(--success);">Active</button>
              <button class="btn btn-secondary" onclick="filterOverlays('pending')">Pending</button>
              <button class="btn btn-primary" onclick="openModal('addOverlay')">+ Add Overlay</button>
            </div>
          </div>
          
          <!-- Summary Cards -->
          <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: var(--space-md); margin-bottom: var(--space-lg);">
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center; border-top: 3px solid var(--success);">
              <div style="font-size: 32px; font-weight: 700; color: var(--success);">6</div>
              <div style="font-size: 12px; font-weight: 600; color: var(--gray-700);">Active</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center; border-top: 3px solid var(--warning);">
              <div style="font-size: 32px; font-weight: 700; color: var(--warning);">2</div>
              <div style="font-size: 12px; font-weight: 600; color: var(--gray-700);">Pending</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center; border-top: 3px solid var(--error);">
              <div style="font-size: 32px; font-weight: 700; color: var(--error);">3</div>
              <div style="font-size: 12px; font-weight: 600; color: var(--gray-700);">Rejected</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center; border-top: 3px solid var(--gusto-teal);">
              <div style="font-size: 32px; font-weight: 700; color: var(--gusto-teal);">+42</div>
              <div style="font-size: 12px; font-weight: 600; color: var(--gray-700);">Net HC Impact</div>
            </div>
            <div style="background: white; border-radius: var(--radius-lg); padding: var(--space-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center; border-top: 3px solid var(--gray-400);">
              <div style="font-size: 32px; font-weight: 700; color: var(--gray-600);">5</div>
              <div style="font-size: 12px; font-weight: 600; color: var(--gray-700);">Pillars Affected</div>
            </div>
          </div>
          
          <!-- Overlay Table -->
          <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); overflow: hidden;">
            <div style="padding: var(--space-md) var(--space-lg); border-bottom: 1px solid var(--gray-200); display: flex; justify-content: space-between; align-items: center;">
              <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800);">All Overlays</h3>
              <div style="display: flex; gap: var(--space-sm); align-items: center;">
                <button onclick="toggleUnquantifiedSection()" style="background: var(--warning-bg); border: 1px solid var(--warning); color: var(--warning); padding: 6px 12px; border-radius: var(--radius-sm); font-size: 11px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                  📝 Unquantified <span id="unquantified-count" style="background: var(--warning); color: white; padding: 2px 6px; border-radius: 8px; font-size: 10px;">2</span>
                </button>
                <select class="form-select" style="padding: 8px 12px; font-size: 12px; border-radius: var(--radius-sm);">
                  <option>All Pillars</option>
                  <option>Payroll and Taxes</option>
                  <option>Benefits</option>
                  <option>Members</option>
                  <option>Accountant</option>
                  <option>PAC</option>
                </select>
                <select class="form-select" style="padding: 8px 12px; font-size: 12px; border-radius: var(--radius-sm);">
                  <option>All Categories</option>
                  <option>Volume</option>
                  <option>AHT</option>
                  <option>SL Target</option>
                  <option>Shrinkage</option>
                  <option>Occupancy</option>
                </select>
              </div>
            </div>
            
            <div style="overflow-x: auto;">
              <table style="width: 100%; border-collapse: collapse; min-width: 1200px;">
                <thead>
                  <tr style="background: linear-gradient(180deg, var(--gusto-teal) 0%, var(--gusto-teal-dark) 100%);">
                    <th style="padding: 14px 16px; text-align: left; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Pillar</th>
                    <th style="padding: 14px 16px; text-align: left; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Impact Description</th>
                    <th style="padding: 14px 16px; text-align: center; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Category</th>
                    <th style="padding: 14px 16px; text-align: left; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Channel</th>
                    <th style="padding: 14px 16px; text-align: center; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">% Change</th>
                    <th style="padding: 14px 16px; text-align: center; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Value</th>
                    <th style="padding: 14px 16px; text-align: center; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Status</th>
                    <th style="padding: 14px 16px; text-align: center; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Effective</th>
                    <th style="padding: 14px 16px; text-align: center; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Horizon</th>
                    <th style="padding: 14px 16px; text-align: center; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Confidence</th>
                    <th style="padding: 14px 16px; text-align: center; color: white; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Active Overlays -->
                  <tr style="background: var(--success-bg);">
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); font-weight: 600;">Payroll and Taxes</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">Q1 Volume increase from new product launch</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: #DBEAFE; color: #1E40AF; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Volume</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">Phone, Chat</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center; color: var(--error); font-weight: 600;">+15%</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">+12 HC</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--success); color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">Jan-26</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--gusto-coral-light); color: var(--gusto-coral); padding: 4px 8px; border-radius: 8px; font-size: 10px;">Strategic</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="color: var(--success); font-weight: 600;">High</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Edit">✏️</button>
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Apply to Plan">📥</button>
                    </td>
                  </tr>
                  <tr style="background: var(--success-bg);">
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); font-weight: 600;">Benefits</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">Open enrollment season spike</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: #DBEAFE; color: #1E40AF; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Volume</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">All Channels</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center; color: var(--error); font-weight: 600;">+25%</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">+18 HC</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--success); color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">Jan-26</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--gusto-teal-light); color: var(--gusto-teal); padding: 4px 8px; border-radius: 8px; font-size: 10px;">Tactical</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="color: var(--success); font-weight: 600;">High</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Edit">✏️</button>
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Apply to Plan">📥</button>
                    </td>
                  </tr>
                  <tr style="background: var(--success-bg);">
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); font-weight: 600;">PAC</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">Process improvement - reduced handle time</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: #FEF3C7; color: #92400E; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">AHT</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">Chat</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center; color: var(--success); font-weight: 600;">-20%</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">-4 HC</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--success); color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">Jan-26</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--gusto-coral-light); color: var(--gusto-coral); padding: 4px 8px; border-radius: 8px; font-size: 10px;">Strategic</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="color: var(--success); font-weight: 600;">High</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Edit">✏️</button>
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Apply to Plan">📥</button>
                    </td>
                  </tr>
                  
                  <!-- Pending Overlays -->
                  <tr style="background: var(--warning-bg);">
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); font-weight: 600;">Members</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">New self-service portal launch (volume reduction)</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: #DBEAFE; color: #1E40AF; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Volume</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">Chat, Email</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center; color: var(--success); font-weight: 600;">-10%</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">TBD</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--warning); color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Pending</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">Mar-26</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--gusto-coral-light); color: var(--gusto-coral); padding: 4px 8px; border-radius: 8px; font-size: 10px;">Strategic</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="color: var(--warning); font-weight: 600;">Medium</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Edit">✏️</button>
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Approve">✅</button>
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Reject">❌</button>
                    </td>
                  </tr>
                  
                  <!-- Rejected Overlays -->
                  <tr style="background: var(--error-bg); opacity: 0.7;">
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); font-weight: 600;">Payroll and Taxes</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-decoration: line-through;">Rainy day call diversion to Chat</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: #DBEAFE; color: #1E40AF; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Volume</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">Chat</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">+20%</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">-</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--error); color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Rejected</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">-</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--gusto-coral-light); color: var(--gusto-coral); padding: 4px 8px; border-radius: 8px; font-size: 10px;">Strategic</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="color: var(--gray-400);">-</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Restore">🔄</button>
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Delete">🗑️</button>
                    </td>
                  </tr>
                  <tr style="background: var(--error-bg); opacity: 0.7;">
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); font-weight: 600;">Accountant</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-decoration: line-through;">Mandatory overtime request</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: #E0E7FF; color: #3730A3; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">OT</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200);">All</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">-</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">87 hrs</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--error); color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Rejected</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">Jan-26</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="background: var(--gusto-teal-light); color: var(--gusto-teal); padding: 4px 8px; border-radius: 8px; font-size: 10px;">Tactical</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;"><span style="color: var(--success);">High</span></td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid var(--gray-200); text-align: center;">
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Restore">🔄</button>
                      <button style="background: none; border: none; cursor: pointer; font-size: 14px;" title="Delete">🗑️</button>
                    </td>
                  </tr>
                  
                  <!-- Add New Overlay Row -->
                  <tr style="background: linear-gradient(180deg, var(--gusto-teal-light) 0%, white 100%);" class="add-overlay-row">
                    <td style="padding: 12px 16px; border-bottom: none;">
                      <select style="width: 100%; padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 12px; background: white;">
                        <option value="">Select Pillar...</option>
                        <option>Payroll and Taxes</option>
                        <option>Benefits</option>
                        <option>Members</option>
                        <option>Accountant</option>
                        <option>PAC</option>
                        <option>BAC</option>
                        <option>Premier</option>
                        <option>Money</option>
                      </select>
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none;">
                      <input type="text" placeholder="Describe the impact..." style="width: 100%; padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 12px;">
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none; text-align: center;">
                      <select style="padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 11px; background: white;">
                        <option value="">Category</option>
                        <option>Volume</option>
                        <option>AHT</option>
                        <option>SL Target</option>
                        <option>Shrinkage</option>
                        <option>Occupancy</option>
                        <option>OT</option>
                      </select>
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none;">
                      <select style="width: 100%; padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 12px; background: white;">
                        <option value="">Channel...</option>
                        <option>All Channels</option>
                        <option>Phone</option>
                        <option>Chat</option>
                        <option>Email</option>
                      </select>
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none; text-align: center;">
                      <input type="text" placeholder="%" style="width: 60px; padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 12px; text-align: center;">
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none; text-align: center;">
                      <input type="text" placeholder="Value" style="width: 70px; padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 12px; text-align: center;">
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none; text-align: center;">
                      <select style="padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 11px; background: white;">
                        <option>Pending</option>
                        <option>Active</option>
                      </select>
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none; text-align: center;">
                      <input type="month" style="padding: 6px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 11px;">
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none; text-align: center;">
                      <select style="padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 11px; background: white;">
                        <option>Tactical</option>
                        <option>Strategic</option>
                      </select>
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none; text-align: center;">
                      <select style="padding: 8px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 11px; background: white;">
                        <option>Medium</option>
                        <option>High</option>
                        <option>Low</option>
                      </select>
                    </td>
                    <td style="padding: 12px 16px; border-bottom: none; text-align: center;">
                      <button onclick="saveNewOverlay()" style="background: var(--gusto-teal); color: white; border: none; padding: 8px 16px; border-radius: var(--radius-sm); font-size: 12px; font-weight: 600; cursor: pointer;">
                        + Add
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- Bottom Section: Unquantified Overlays (Collapsible) -->
          <div id="unquantified-section" style="margin-top: var(--space-lg); background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); border-left: 4px solid var(--warning); overflow: hidden;">
            <div onclick="toggleUnquantifiedSection()" style="padding: var(--space-md) var(--space-lg); cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: linear-gradient(180deg, var(--warning-bg) 0%, white 100%);">
              <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-800); display: flex; align-items: center; gap: 8px;">
                <span id="unquantified-arrow" style="font-size: 12px; transition: transform 0.2s;">▼</span>
                <span style="font-size: 20px;">📝</span> Unquantified Overlays
                <span style="background: var(--warning); color: white; padding: 2px 10px; border-radius: 10px; font-size: 11px; font-weight: 600; margin-left: 8px;">2</span>
              </h3>
              <div style="display: flex; align-items: center; gap: var(--space-sm);">
                <span style="font-size: 12px; color: var(--gray-500);">Click to expand/collapse</span>
                <button class="btn btn-secondary" style="font-size: 12px;" onclick="event.stopPropagation(); addUnquantifiedOverlay()">+ Add Note</button>
              </div>
            </div>
            
            <div id="unquantified-content" style="padding: 0 var(--space-lg) var(--space-lg); display: block;">
              <p style="color: var(--gray-500); font-size: 13px; margin-bottom: var(--space-md); padding-top: var(--space-sm);">Track overlay requests that haven't been quantified yet - these won't affect calculations until values are assigned.</p>
              
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-md);">
                <div style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-sm); border-left: 3px solid var(--warning); position: relative;">
                  <button onclick="promoteToOverlay(this)" style="position: absolute; top: 8px; right: 8px; background: var(--gusto-teal); color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 10px; cursor: pointer;" title="Move to main table">↑ Quantify</button>
                  <div style="font-weight: 600; font-size: 13px; color: var(--gray-800); margin-bottom: 4px;">Client retention initiative impact</div>
                  <div style="font-size: 12px; color: var(--gray-500);">Benefits • Submitted by Product Team • Dec 5, 2025</div>
                  <div style="font-size: 11px; color: var(--gray-400); margin-top: 8px;">"New retention program may reduce churn-related calls. Awaiting metrics from analytics."</div>
                </div>
                <div style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-sm); border-left: 3px solid var(--warning); position: relative;">
                  <button onclick="promoteToOverlay(this)" style="position: absolute; top: 8px; right: 8px; background: var(--gusto-teal); color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 10px; cursor: pointer;" title="Move to main table">↑ Quantify</button>
                  <div style="font-weight: 600; font-size: 13px; color: var(--gray-800); margin-bottom: 4px;">AI chatbot expansion</div>
                  <div style="font-size: 12px; color: var(--gray-500);">All Pillars • Submitted by Eng Team • Dec 8, 2025</div>
                  <div style="font-size: 11px; color: var(--gray-400); margin-top: 8px;">"Expanding AI chatbot to handle more query types. Impact TBD based on pilot results."</div>
                </div>
              </div>
              
              <!-- Add new unquantified note inline -->
              <div style="margin-top: var(--space-md); background: var(--gusto-teal-light); padding: var(--space-md); border-radius: var(--radius-sm); border: 1px dashed var(--gusto-teal);">
                <div style="display: grid; grid-template-columns: 1fr 150px auto; gap: var(--space-sm); align-items: center;">
                  <input type="text" placeholder="Describe the potential overlay impact..." style="padding: 10px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 13px;">
                  <select style="padding: 10px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 13px; background: white;">
                    <option value="">Pillar...</option>
                    <option>All Pillars</option>
                    <option>Payroll and Taxes</option>
                    <option>Benefits</option>
                    <option>Members</option>
                    <option>Accountant</option>
                    <option>PAC</option>
                  </select>
                  <button onclick="saveUnquantifiedNote()" style="background: var(--gusto-teal); color: white; border: none; padding: 10px 16px; border-radius: var(--radius-sm); font-size: 13px; font-weight: 600; cursor: pointer; white-space: nowrap;">
                    + Add Note
                  </button>
                </div>
              </div>
            </div>
          </div>
          
        </div><!-- END view-overlays -->
        
      </div>
    </main>
  </div>
  
  <!-- ═══════════════════════════════════════════════════════════════════════
       OVERLAY SIDE PANEL - Slides in from right
       ═══════════════════════════════════════════════════════════════════════ -->
  <div id="overlaySidePanel" style="position: fixed; top: 0; right: -420px; width: 400px; height: 100vh; background: white; box-shadow: -4px 0 20px rgba(0,0,0,0.15); z-index: 1000; transition: right 0.3s ease; display: flex; flex-direction: column;">
    <!-- Panel Header -->
    <div style="padding: 16px 20px; background: linear-gradient(135deg, var(--gusto-coral) 0%, #E53E3E 100%); color: white; display: flex; align-items: center; justify-content: space-between;">
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 20px;">🎯</span>
        <div>
          <div style="font-weight: 600; font-size: 16px;">Active Overlays</div>
          <div style="font-size: 11px; opacity: 0.9;">12 overlays • +38 HC impact</div>
        </div>
      </div>
      <button onclick="toggleOverlayPanel()" style="background: rgba(255,255,255,0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 6px; font-size: 18px; cursor: pointer;">✕</button>
    </div>
    
    <!-- Month Selector -->
    <div style="padding: 12px 20px; border-bottom: 1px solid var(--gray-200); display: flex; align-items: center; gap: 12px;">
      <span style="font-size: 12px; color: var(--gray-600);">View for:</span>
      <select id="overlayMonthFilter" style="flex: 1; padding: 8px 12px; border: 1px solid var(--gray-300); border-radius: 6px; font-size: 13px;" onchange="filterOverlaysByMonth(this.value)">
        <option value="all">All Months</option>
        <option value="dec-25" selected>December 2025</option>
        <option value="jan-26">January 2026</option>
        <option value="feb-26">February 2026</option>
        <option value="mar-26">March 2026</option>
      </select>
    </div>
    
    <!-- Panel Content -->
    <div style="flex: 1; overflow-y: auto; padding: 16px;">
      <!-- Pillar Cards -->
      <div style="display: flex; flex-direction: column; gap: 12px;">
        
        <!-- Payroll Overlays -->
        <div style="background: var(--gray-50); border-radius: 10px; border: 1px solid var(--gray-200); overflow: hidden;">
          <div onclick="toggleSidePanelPillar(this)" style="padding: 12px 16px; background: var(--gusto-teal-light); cursor: pointer; display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 8px;">
              <span style="font-size: 14px;">💰</span>
              <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Payroll</span>
              <span style="background: var(--gusto-coral); color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;">+15 HC</span>
            </div>
            <span class="panel-pillar-arrow" style="font-size: 10px; color: var(--gray-500);">▼</span>
          </div>
          <div class="panel-pillar-content" style="padding: 12px 16px;">
            <table style="width: 100%; font-size: 11px; border-collapse: collapse;">
              <tr style="border-bottom: 1px solid var(--gray-200);">
                <td style="padding: 6px 0; color: var(--gray-600);">Volume Adjustment</td>
                <td style="padding: 6px 0; text-align: right; font-weight: 600; color: var(--error);">+10%</td>
              </tr>
              <tr style="border-bottom: 1px solid var(--gray-200);">
                <td style="padding: 6px 0; color: var(--gray-600);">AHT Override</td>
                <td style="padding: 6px 0; text-align: right; font-weight: 600; color: var(--error);">+15 sec</td>
              </tr>
              <tr>
                <td style="padding: 6px 0; color: var(--gray-600);">Shrinkage</td>
                <td style="padding: 6px 0; text-align: right; font-weight: 600;">28%</td>
              </tr>
            </table>
            <button onclick="loadView('overlays')" style="width: 100%; margin-top: 10px; padding: 8px; background: white; border: 1px solid var(--gusto-teal); color: var(--gusto-teal); border-radius: 6px; font-size: 11px; font-weight: 600; cursor: pointer;">View Full Details →</button>
          </div>
        </div>
        
        <!-- Benefits Overlays -->
        <div style="background: var(--gray-50); border-radius: 10px; border: 1px solid var(--gray-200); overflow: hidden;">
          <div onclick="toggleSidePanelPillar(this)" style="padding: 12px 16px; background: var(--gusto-teal-light); cursor: pointer; display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 8px;">
              <span style="font-size: 14px;">🏥</span>
              <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">Benefits</span>
              <span style="background: var(--gusto-coral); color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;">+18 HC</span>
            </div>
            <span class="panel-pillar-arrow" style="font-size: 10px; color: var(--gray-500);">▼</span>
          </div>
          <div class="panel-pillar-content" style="padding: 12px 16px;">
            <table style="width: 100%; font-size: 11px; border-collapse: collapse;">
              <tr style="border-bottom: 1px solid var(--gray-200);">
                <td style="padding: 6px 0; color: var(--gray-600);">Volume (Open Enrollment)</td>
                <td style="padding: 6px 0; text-align: right; font-weight: 600; color: var(--error);">+25%</td>
              </tr>
              <tr>
                <td style="padding: 6px 0; color: var(--gray-600);">SL Target</td>
                <td style="padding: 6px 0; text-align: right; font-weight: 600;">70/30</td>
              </tr>
            </table>
            <button onclick="loadView('overlays')" style="width: 100%; margin-top: 10px; padding: 8px; background: white; border: 1px solid var(--gusto-teal); color: var(--gusto-teal); border-radius: 6px; font-size: 11px; font-weight: 600; cursor: pointer;">View Full Details →</button>
          </div>
        </div>
        
        <!-- PAC Overlays -->
        <div style="background: var(--gray-50); border-radius: 10px; border: 1px solid var(--gray-200); overflow: hidden;">
          <div onclick="toggleSidePanelPillar(this)" style="padding: 12px 16px; background: #D1FAE5; cursor: pointer; display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 8px;">
              <span style="font-size: 14px;">📞</span>
              <span style="font-weight: 600; font-size: 13px; color: var(--gray-800);">PAC</span>
              <span style="background: #10B981; color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;">-5 HC</span>
            </div>
            <span class="panel-pillar-arrow" style="font-size: 10px; color: var(--gray-500);">▼</span>
          </div>
          <div class="panel-pillar-content" style="padding: 12px 16px;">
            <table style="width: 100%; font-size: 11px; border-collapse: collapse;">
              <tr>
                <td style="padding: 6px 0; color: var(--gray-600);">AHT Improvement</td>
                <td style="padding: 6px 0; text-align: right; font-weight: 600; color: var(--success);">-20%</td>
              </tr>
            </table>
            <button onclick="loadView('overlays')" style="width: 100%; margin-top: 10px; padding: 8px; background: white; border: 1px solid var(--gusto-teal); color: var(--gusto-teal); border-radius: 6px; font-size: 11px; font-weight: 600; cursor: pointer;">View Full Details →</button>
          </div>
        </div>
        
      </div>
    </div>
    
    <!-- Panel Footer -->
    <div style="padding: 12px 20px; border-top: 1px solid var(--gray-200); background: var(--gray-50);">
      <button onclick="loadView('overlays'); toggleOverlayPanel();" style="width: 100%; padding: 12px; background: var(--gusto-teal); color: white; border: none; border-radius: 8px; font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;">
        🎚️ Open Full Overlay Tracker
      </button>
    </div>
  </div>
  
  <!-- Overlay for side panel -->
  <div id="overlaySidePanelBackdrop" onclick="toggleOverlayPanel()" style="position: fixed; inset: 0; background: rgba(0,0,0,0.3); z-index: 999; display: none;"></div>
  
  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>
  
  <!-- Floating Action Buttons -->
  <div class="fab-container" id="fabContainer">
    <div class="fab-menu">
      <div class="fab-item feedback" onclick="openModal('feedback')">
        <div class="fab-item-icon">💬</div>
        <span>Send Feedback</span>
      </div>
      <div class="fab-item bug" onclick="openModal('bugReport')">
        <div class="fab-item-icon">🐛</div>
        <span>Report Bug</span>
      </div>
      <div class="fab-item feature" onclick="openModal('featureRequest')">
        <div class="fab-item-icon">💡</div>
        <span>Request Feature</span>
      </div>
    </div>
    <button class="fab-main" onclick="toggleFab()" data-tooltip="Help & Feedback">
      ?
    </button>
  </div>
  
  <!-- Bug Report Modal -->
  <div class="modal-overlay" id="bugReportModal" onclick="if(event.target === this) closeModal('bugReport')">
    <div class="modal">
      <div class="modal-header" style="background: var(--error); color: white;">
        <h3 class="modal-title" style="color: white;">🐛 Report a Bug</h3>
        <button class="modal-close" onclick="closeModal('bugReport')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Where did this happen?</label>
          <select class="form-select" id="bugLocation">
            <option>Pillar Staffing Model</option>
            <option>Channel Overlay Inputs</option>
            <option>All-In View</option>
            <option>Save/Publish</option>
            <option>Other</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">What happened?</label>
          <textarea class="form-input" rows="3" placeholder="Describe what went wrong..."></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">What did you expect to happen?</label>
          <textarea class="form-input" rows="2" placeholder="What should have happened..."></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Severity</label>
          <select class="form-select">
            <option>🔴 Critical - Blocks work</option>
            <option>🟡 Major - Workaround available</option>
            <option>🟢 Minor - Cosmetic issue</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('bugReport')">Cancel</button>
        <button class="btn btn-primary" onclick="submitBugReport()">Submit Bug</button>
      </div>
    </div>
  </div>
  
  <!-- Feature Request Modal -->
  <div class="modal-overlay" id="featureRequestModal" onclick="if(event.target === this) closeModal('featureRequest')">
    <div class="modal">
      <div class="modal-header" style="background: #7C3AED; color: white;">
        <h3 class="modal-title" style="color: white;">💡 Request a Feature</h3>
        <button class="modal-close" onclick="closeModal('featureRequest')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Feature Title</label>
          <input type="text" class="form-input" placeholder="Brief title for your idea...">
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-input" rows="3" placeholder="Describe what you'd like to see..."></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">How would this help your workflow?</label>
          <textarea class="form-input" rows="2" placeholder="Why is this important..."></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Priority</label>
          <select class="form-select">
            <option>🚀 Nice to have</option>
            <option>⭐ Would improve efficiency</option>
            <option>🔥 Critical for my workflow</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('featureRequest')">Cancel</button>
        <button class="btn btn-primary" onclick="submitFeatureRequest()">Submit Request</button>
      </div>
    </div>
  </div>
  
  <!-- Scenarios Modal -->
  <div class="modal-overlay" id="scenariosModal" onclick="if(event.target === this) closeModal('scenarios')">
    <div class="modal" style="max-width: 700px;">
      <div class="modal-header" style="background: var(--gusto-teal-dark); color: white;">
        <h3 class="modal-title" style="color: white;">📚 Saved Plans & Scenarios</h3>
        <button class="modal-close" onclick="closeModal('scenarios')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body" style="padding: 0;">
        <!-- Tabs -->
        <div style="display: flex; border-bottom: 1px solid var(--gray-200);">
          <button class="scenario-tab active" onclick="switchScenarioTab('saved')">💾 Saved Scenarios (3)</button>
          <button class="scenario-tab" onclick="switchScenarioTab('published')">📋 Published Plans (2)</button>
        </div>
        
        <!-- Saved Scenarios List -->
        <div id="savedScenariosTab" style="padding: var(--space-md); max-height: 400px; overflow-y: auto;">
          <div class="scenario-item" style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-sm); margin-bottom: var(--space-sm); display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 600;">+10% Volume Test</div>
              <div style="font-size: 11px; color: var(--gray-500);">Created Dec 6 @ 2:30 PM by bunny.bates</div>
              <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">Testing impact of Q2 volume increase</div>
            </div>
            <div style="display: flex; gap: var(--space-xs);">
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Apply</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Compare</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px; color: var(--error);">🗑️</button>
            </div>
          </div>
          <div class="scenario-item" style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-sm); margin-bottom: var(--space-sm); display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 600;">Reduced Shrink Scenario</div>
              <div style="font-size: 11px; color: var(--gray-500);">Created Dec 5 @ 11:15 AM by bunny.bates</div>
              <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">What if shrink drops to 25%?</div>
            </div>
            <div style="display: flex; gap: var(--space-xs);">
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Apply</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Compare</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px; color: var(--error);">🗑️</button>
            </div>
          </div>
          <div class="scenario-item" style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-sm); margin-bottom: var(--space-sm); display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 600;">High Attrition Test</div>
              <div style="font-size: 11px; color: var(--gray-500);">Created Dec 4 @ 9:00 AM by bunny.bates</div>
              <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">Impact of 8% monthly attrition</div>
            </div>
            <div style="display: flex; gap: var(--space-xs);">
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Apply</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Compare</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px; color: var(--error);">🗑️</button>
            </div>
          </div>
        </div>
        
        <!-- Published Plans List (hidden by default) -->
        <div id="publishedPlansTab" style="padding: var(--space-md); max-height: 400px; overflow-y: auto; display: none;">
          <div class="scenario-item" style="background: var(--success-bg); padding: var(--space-md); border-radius: var(--radius-sm); margin-bottom: var(--space-sm); display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 600;">📋 Published v3.2 <span style="background: var(--success); color: white; padding: 2px 6px; border-radius: 10px; font-size: 9px; margin-left: 4px;">CURRENT</span></div>
              <div style="font-size: 11px; color: var(--gray-500);">Published Dec 6 @ 4:00 PM by bunny.bates</div>
              <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">Q1 FY26 Final Plan - Approved by leadership</div>
            </div>
            <div style="display: flex; gap: var(--space-xs);">
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">View</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Compare</button>
            </div>
          </div>
          <div class="scenario-item" style="background: var(--gray-50); padding: var(--space-md); border-radius: var(--radius-sm); margin-bottom: var(--space-sm); display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 600;">📋 Published v3.1</div>
              <div style="font-size: 11px; color: var(--gray-500);">Published Dec 1 @ 10:30 AM by bunny.bates</div>
              <div style="font-size: 10px; color: var(--gray-400); margin-top: 4px;">Draft before final adjustments</div>
            </div>
            <div style="display: flex; gap: var(--space-xs);">
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">View</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Compare</button>
              <button class="btn btn-secondary" style="font-size: 10px; padding: 4px 8px;">Restore</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('scenarios')">Close</button>
        <button class="btn btn-coral" onclick="openModal('save')">💾 Save New Scenario</button>
      </div>
    </div>
  </div>
  
  <!-- Data Import Modal -->
  <div class="modal-overlay" id="importModal" onclick="if(event.target === this) closeImportModal()" style="display: none;">
    <div class="modal" style="max-width: 800px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column;">
      <div class="modal-header" style="background: linear-gradient(135deg, var(--gusto-teal) 0%, var(--gusto-teal-dark) 100%); color: white;">
        <h3 class="modal-title" style="color: white;">📥 Import Data</h3>
        <button class="modal-close" onclick="closeImportModal()" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body" style="overflow-y: auto; flex: 1; padding: 20px;">
        
        <!-- Import Type Selection -->
        <div style="margin-bottom: 20px;">
          <label style="font-size: 13px; font-weight: 600; color: var(--gray-700); display: block; margin-bottom: 10px;">1. Select Data Type</label>
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
            <div onclick="selectImportType('baseline')" id="modal-import-baseline" style="background: var(--gusto-teal-light); border: 2px solid var(--gusto-teal); border-radius: var(--radius-sm); padding: 14px; cursor: pointer; text-align: center;">
              <div style="font-size: 24px; margin-bottom: 6px;">📈</div>
              <div style="font-weight: 600; font-size: 12px; color: var(--gray-800);">Baseline Forecast</div>
              <div style="font-size: 10px; color: var(--gray-500);">Volume, AHT, SL</div>
            </div>
            <div onclick="selectImportType('active-hc')" id="modal-import-active-hc" style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: var(--radius-sm); padding: 14px; cursor: pointer; text-align: center;">
              <div style="font-size: 24px; margin-bottom: 6px;">👥</div>
              <div style="font-weight: 600; font-size: 12px; color: var(--gray-800);">Active Headcount</div>
              <div style="font-size: 10px; color: var(--gray-500);">HC by site</div>
            </div>
            <div onclick="selectImportType('overlays')" id="modal-import-overlays" style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: var(--radius-sm); padding: 14px; cursor: pointer; text-align: center;">
              <div style="font-size: 24px; margin-bottom: 6px;">🎚️</div>
              <div style="font-weight: 600; font-size: 12px; color: var(--gray-800);">Overlays</div>
              <div style="font-size: 10px; color: var(--gray-500);">Business impacts</div>
            </div>
          </div>
        </div>
        
        <!-- Paste Area -->
        <div style="margin-bottom: 20px;">
          <label style="font-size: 13px; font-weight: 600; color: var(--gray-700); display: block; margin-bottom: 10px;">2. Paste Data (from Excel/Sheets)</label>
          <textarea id="importPasteArea" style="width: 100%; height: 150px; padding: 12px; border: 2px dashed var(--gray-300); border-radius: var(--radius-sm); font-family: var(--font-mono); font-size: 11px; resize: vertical;" placeholder="Copy your data from Excel or Google Sheets and paste here...

Expected columns for Baseline Forecast:
Pillar, Channel, Month, Volume, AHT, Shrink, Occupancy, Concurrency, SL Target, SL Uplift

Expected columns for Active Headcount:
Pillar, Month, Site, Headcount

Tip: Include header row with column names!"></textarea>
          <button onclick="parseImportData()" class="btn btn-secondary" style="margin-top: 10px;">
            🔍 Parse & Preview Data
          </button>
        </div>
        
        <!-- Preview Area -->
        <div id="importPreview" style="display: none; margin-bottom: 20px;">
          <!-- Preview content will be inserted here by JavaScript -->
        </div>
        
        <!-- Sample Data Templates -->
        <div style="background: var(--gray-50); border-radius: var(--radius-sm); padding: 14px; margin-bottom: 16px;">
          <div style="font-size: 12px; font-weight: 600; color: var(--gray-700); margin-bottom: 8px;">📋 Need sample templates?</div>
          <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <button onclick="loadSampleBaseline()" style="background: white; border: 1px solid var(--gray-200); padding: 6px 12px; border-radius: var(--radius-sm); font-size: 11px; cursor: pointer;">
              Load Sample Baseline
            </button>
            <button onclick="loadSampleActiveHC()" style="background: white; border: 1px solid var(--gray-200); padding: 6px 12px; border-radius: var(--radius-sm); font-size: 11px; cursor: pointer;">
              Load Sample Active HC
            </button>
            <a href="https://docs.google.com/spreadsheets/d/1Jfm3Gv7xkaHtl5Vrf8qQpFtOElQu4MX-xl2OykBpuVs/edit" target="_blank" style="background: white; border: 1px solid var(--gray-200); padding: 6px 12px; border-radius: var(--radius-sm); font-size: 11px; cursor: pointer; text-decoration: none; color: var(--gray-700);">
              Open Source Sheet ↗
            </a>
          </div>
        </div>
        
      </div>
      <div class="modal-footer" style="border-top: 1px solid var(--gray-200); padding: 16px 20px; display: flex; justify-content: space-between; align-items: center;">
        <div style="font-size: 11px; color: var(--gray-500);">
          <span id="importStatus">No data loaded</span>
        </div>
        <div style="display: flex; gap: 10px;">
          <button class="btn btn-secondary" onclick="closeImportModal()">Cancel</button>
          <button id="confirmImportBtn" class="btn btn-primary" onclick="confirmImport()" disabled>
            📥 Import Data
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Save Scenario Modal -->
  <div class="modal-overlay" id="saveModal" onclick="if(event.target === this) closeModal('save')">
    <div class="modal" style="max-width: 520px;">
      <div class="modal-header" style="background: var(--gusto-coral); color: white;">
        <h3 class="modal-title" style="color: white;">💾 Save Scenario</h3>
        <button class="modal-close" onclick="closeModal('save')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Scenario Name</label>
          <input type="text" class="form-input" id="scenarioName" placeholder="e.g., Q1 2025 - +10% Volume Test">
        </div>
        <div class="form-group">
          <label class="form-label">Notes</label>
          <textarea class="form-input" rows="2" id="scenarioNotes" placeholder="Describe what makes this scenario different..."></textarea>
        </div>
        
        <!-- What gets saved -->
        <div style="background: var(--info-bg); padding: 12px; border-radius: var(--radius-sm); margin-bottom: 12px; font-size: 12px;">
          <strong>📦 What will be saved:</strong>
          <ul style="margin: 8px 0 0 16px; padding: 0; color: var(--gray-600);">
            <li>All baseline metrics (Volume, AHT, Shrink, etc.)</li>
            <li>All overlay inputs per channel/month</li>
            <li>Calculated HC Need and staffing results</li>
            <li>Forecast data snapshot date</li>
          </ul>
        </div>
        <div class="form-group">
          <label class="form-label">Select pillars to include:</label>
          <div style="border: 1px solid var(--gray-200); border-radius: var(--radius-md); max-height: 200px; overflow-y: auto;">
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer; background: var(--gray-50);">
              <input type="checkbox" id="selectAllScenario" onchange="toggleAllPillars('scenario')" checked> 
              <strong>Select All</strong>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-scenario" value="Accountant" checked> 
              <span>Accountant</span>
              <span style="margin-left: auto; font-size: 11px; color: var(--success);">✅ You are editing</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-scenario" value="Benefits" checked> 
              <span>Benefits</span>
              <span style="margin-left: auto; font-size: 11px; color: var(--gray-400);">No active edits</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer; background: var(--warning-bg);">
              <input type="checkbox" class="pillar-checkbox-scenario" value="PAC"> 
              <span>PAC</span>
              <span style="margin-left: auto; font-size: 11px; color: var(--warning);">⚠️ John D. editing</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-scenario" value="Payroll" checked> 
              <span>Payroll</span>
              <span style="margin-left: auto; font-size: 11px; color: var(--gray-400);">No active edits</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-scenario" value="Premier" checked> 
              <span>Premier</span>
              <span style="margin-left: auto; font-size: 11px; color: var(--gray-400);">No active edits</span>
            </label>
          </div>
        </div>
        <div style="background: var(--warning-bg); padding: 10px 12px; border-radius: var(--radius-sm); font-size: 13px; color: var(--gray-700);">
          ⚠️ <strong>PAC</strong> is being edited by John D. - including it may capture incomplete changes
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('save')">Cancel</button>
        <button class="btn btn-primary" onclick="saveScenario()">💾 Save Selected Pillars</button>
      </div>
    </div>
  </div>
  
  <!-- Publish Plan Modal -->
  <div class="modal-overlay" id="publishModal" onclick="if(event.target === this) closeModal('publish')">
    <div class="modal" style="max-width: 520px;">
      <div class="modal-header" style="background: var(--gusto-teal); color: white;">
        <h3 class="modal-title" style="color: white;">✅ Publish Plan</h3>
        <button class="modal-close" onclick="closeModal('publish')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body">
        <div style="background: var(--warning-bg); padding: 12px; border-radius: var(--radius-sm); margin-bottom: 16px; border-left: 4px solid var(--warning);">
          <strong>⚠️ This will replace the current published plan!</strong>
          <div style="font-size: 13px; margin-top: 4px; color: var(--gray-600);">
            Current: <strong>v3.2</strong> (published Dec 6, 2024) → New: <strong>v3.3</strong>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Select pillars to publish:</label>
          <div style="border: 1px solid var(--gray-200); border-radius: var(--radius-md); max-height: 220px; overflow-y: auto;">
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer; background: var(--gray-50);">
              <input type="checkbox" id="selectAllPublish" onchange="toggleAllPillars('publish')" checked> 
              <strong>Select All Ready Pillars</strong>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-publish" value="Accountant" checked> 
              <span>Accountant</span>
              <span style="margin-left: auto; font-size: 11px;"><strong>51 HC</strong></span>
              <span style="font-size: 11px; color: var(--success);">✅ Ready</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-publish" value="Benefits" checked> 
              <span>Benefits</span>
              <span style="margin-left: auto; font-size: 11px;"><strong>78 HC</strong></span>
              <span style="font-size: 11px; color: var(--success);">✅ Ready</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer; background: var(--error-bg); opacity: 0.7;">
              <input type="checkbox" class="pillar-checkbox-publish" value="PAC" disabled> 
              <span>PAC</span>
              <span style="margin-left: auto; font-size: 11px;"><strong>--</strong></span>
              <span style="font-size: 11px; color: var(--error);">🔴 Missing Data</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-publish" value="Payroll" checked> 
              <span>Payroll</span>
              <span style="margin-left: auto; font-size: 11px;"><strong>124 HC</strong></span>
              <span style="font-size: 11px; color: var(--success);">✅ Ready</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-publish" value="Premier" checked> 
              <span>Premier</span>
              <span style="margin-left: auto; font-size: 11px;"><strong>89 HC</strong></span>
              <span style="font-size: 11px; color: var(--success);">✅ Ready</span>
            </label>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Active editors will be notified:</label>
          <div style="background: var(--info-bg); padding: 10px 12px; border-radius: var(--radius-sm); font-size: 13px;">
            👤 <strong>John D.</strong> (PAC) - will see notification when published
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Publish Notes (optional)</label>
          <input type="text" class="form-input" id="publishNotes" placeholder="e.g., Q4 plan update - added overlays for Jan peak">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('publish')">Cancel</button>
        <button class="btn btn-primary" style="background: var(--gusto-teal);" onclick="confirmPublish()">✅ Publish Selected Pillars</button>
      </div>
    </div>
  </div>
  
  <!-- Key Insights Pop-out Modal -->
  <div class="modal-overlay" id="insightsModal" onclick="if(event.target === this) closeModal('insights')">
    <div class="modal" style="max-width: 700px; max-height: 85vh;">
      <div class="modal-header" style="background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%); color: white;">
        <h3 class="modal-title" style="color: white;">🔮 Key Insights</h3>
        <div style="display: flex; align-items: center; gap: 8px;">
          <span style="font-size: 11px; background: rgba(255,255,255,0.2); padding: 3px 8px; border-radius: 4px;">Published v3.2 vs +10% Volume</span>
          <button class="modal-close" onclick="closeModal('insights')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
        </div>
      </div>
      <div class="modal-body" style="padding: 20px;">
        <!-- Context Summary -->
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px;">
          <div style="background: var(--gray-50); padding: 12px; border-radius: 8px; text-align: center;">
            <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase;">Volume Δ</div>
            <div style="font-size: 18px; font-weight: 700; color: var(--gusto-teal);">+10%</div>
          </div>
          <div style="background: var(--gray-50); padding: 12px; border-radius: 8px; text-align: center;">
            <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase;">HC Need Δ</div>
            <div style="font-size: 18px; font-weight: 700; color: #DC2626;">+5</div>
          </div>
          <div style="background: var(--gray-50); padding: 12px; border-radius: 8px; text-align: center;">
            <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase;">Gap Δ</div>
            <div style="font-size: 18px; font-weight: 700; color: #DC2626;">-5</div>
          </div>
          <div style="background: var(--gray-50); padding: 12px; border-radius: 8px; text-align: center;">
            <div style="font-size: 10px; color: var(--gray-500); text-transform: uppercase;">Period</div>
            <div style="font-size: 14px; font-weight: 600; color: var(--gray-700);">May-25 → Apr-26</div>
          </div>
        </div>
        
        <!-- Auto-Generated Insights -->
        <div style="margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
            <span style="font-weight: 600; color: #5B21B6;">Auto-Generated Insights</span>
            <span style="font-size: 9px; background: #8B5CF6; color: white; padding: 2px 6px; border-radius: 3px;">AI</span>
            <span style="font-size: 11px; color: var(--gray-400); margin-left: auto;">Click to edit</span>
          </div>
          <div id="expandedInsights" style="display: flex; flex-direction: column; gap: 10px;">
            <div style="display: flex; align-items: flex-start; gap: 10px; background: white; padding: 14px 16px; border-radius: 8px; border: 1px solid var(--gray-200);">
              <span style="font-size: 18px;">📈</span>
              <div style="flex: 1;">
                <span style="color: var(--gray-700); line-height: 1.6; font-size: 14px;" contenteditable="true">Volume increase (+10%) is the <strong>primary driver</strong> of the HC gap widening from -30 to -35. This represents approximately 2,000 additional contacts per month that the team will need to handle.</span>
              </div>
            </div>
            <div style="display: flex; align-items: flex-start; gap: 10px; background: white; padding: 14px 16px; border-radius: 8px; border: 1px solid var(--gray-200);">
              <span style="font-size: 18px;">⚠️</span>
              <div style="flex: 1;">
                <span style="color: var(--gray-700); line-height: 1.6; font-size: 14px;" contenteditable="true"><strong>December 2025</strong> shows the peak gap of <strong>-42 HC</strong> — the highest staffing need across the 12-month period. This coincides with seasonal volume spikes and holiday PTO.</span>
              </div>
            </div>
            <div style="display: flex; align-items: flex-start; gap: 10px; background: white; padding: 14px 16px; border-radius: 8px; border: 1px solid var(--gray-200);">
              <span style="font-size: 18px;">⏰</span>
              <div style="flex: 1;">
                <span style="color: var(--gray-700); line-height: 1.6; font-size: 14px;" contenteditable="true">Overtime requirement increases by <strong>24%</strong> (averaging 55 additional hours/month). At current rates, this represents approximately <strong>$82,500</strong> in additional labor costs annually. Sustainability is a concern.</span>
              </div>
            </div>
            <div style="display: flex; align-items: flex-start; gap: 10px; background: #F5F3FF; padding: 14px 16px; border-radius: 8px; border: 2px solid #8B5CF6;">
              <span style="font-size: 18px;">💡</span>
              <div style="flex: 1;">
                <span style="color: var(--gray-700); line-height: 1.6; font-size: 14px;" contenteditable="true"><strong>Recommendation:</strong> Consider hiring 5 FTE by October 2025 to reduce peak December impact and avoid burnout risk. Alternative: Negotiate seasonal temp support or cross-training from adjacent teams.</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Custom Notes Section -->
        <div style="border-top: 1px solid var(--gray-200); padding-top: 16px;">
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
            <span style="font-weight: 600; color: var(--gray-700);">Your Notes</span>
            <span style="font-size: 11px; color: var(--gray-400);">Add context for stakeholders</span>
          </div>
          <textarea id="insightsCustomNotes" style="width: 100%; min-height: 80px; padding: 12px; border: 1px solid var(--gray-200); border-radius: 8px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Add your own analysis, action items, or notes for the stakeholder report..."></textarea>
        </div>
      </div>
      <div class="modal-footer" style="background: var(--gray-50); border-top: 1px solid var(--gray-200);">
        <button class="btn btn-secondary" onclick="closeModal('insights')">Close</button>
        <button class="btn" style="background: white; border: 1px solid #8B5CF6; color: #7C3AED;" onclick="addExpandedInsight()">+ Add Insight</button>
        <button class="btn btn-primary" style="background: #8B5CF6;" onclick="generateStakeholderReport(); closeModal('insights');">📤 Generate Report</button>
      </div>
    </div>
  </div>
  
  <!-- Recalculate Modal -->
  <div class="modal-overlay" id="recalculateModal" onclick="if(event.target === this) closeModal('recalculate')">
    <div class="modal" style="max-width: 480px;">
      <div class="modal-header" style="background: var(--gray-700); color: white;">
        <h3 class="modal-title" style="color: white;">🔄 Recalculate All</h3>
        <button class="modal-close" onclick="closeModal('recalculate')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 16px; color: var(--gray-600);">
          This will recalculate HC needs based on current overlays and forecast data.
        </p>
        
        <div class="form-group">
          <label class="form-label">Select pillars to recalculate:</label>
          <div style="border: 1px solid var(--gray-200); border-radius: var(--radius-md); max-height: 200px; overflow-y: auto;">
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer; background: var(--gray-50);">
              <input type="checkbox" id="selectAllRecalc" onchange="toggleAllPillars('recalc')" checked> 
              <strong>Select All</strong>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-recalc" value="Accountant" checked> 
              <span>Accountant</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-recalc" value="Benefits" checked> 
              <span>Benefits</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer; background: var(--warning-bg);">
              <input type="checkbox" class="pillar-checkbox-recalc" value="PAC" checked> 
              <span>PAC</span>
              <span style="margin-left: auto; font-size: 11px; color: var(--warning);">⚠️ John D. editing</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--gray-100); cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-recalc" value="Payroll" checked> 
              <span>Payroll</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; cursor: pointer;">
              <input type="checkbox" class="pillar-checkbox-recalc" value="Premier" checked> 
              <span>Premier</span>
            </label>
          </div>
        </div>
        
        <div style="background: var(--info-bg); padding: 10px 12px; border-radius: var(--radius-sm); font-size: 13px; color: var(--gray-700);">
          💡 Recalculation uses latest forecast data uploaded <strong>Dec 6, 2024</strong>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('recalculate')">Cancel</button>
        <button class="btn btn-primary" onclick="confirmRecalculate()">🔄 Recalculate Selected</button>
      </div>
    </div>
  </div>
  
  <!-- Feedback Modal -->
  <div class="modal-overlay" id="feedbackModal" onclick="if(event.target === this) closeModal('feedback')">
    <div class="modal">
      <div class="modal-header" style="background: var(--gusto-teal); color: white;">
        <h3 class="modal-title" style="color: white;">💬 Submit Feedback</h3>
        <button class="modal-close" onclick="closeModal('feedback')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Type</label>
          <select class="form-select">
            <option>Bug Report</option>
            <option>Feature Request</option>
            <option>General Feedback</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-input" rows="4" placeholder="Tell us what you're experiencing..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('feedback')">Cancel</button>
        <button class="btn btn-primary" onclick="submitFeedback()">Submit</button>
      </div>
    </div>
  </div>
  
  <!-- Create Pillar Modal -->
  <div class="modal-overlay" id="createPillarModal" onclick="if(event.target === this) closeModal('createPillar')">
    <div class="modal">
      <div class="modal-header" style="background: var(--success); color: white;">
        <h3 class="modal-title" style="color: white;">➕ Create New Pillar</h3>
        <button class="modal-close" onclick="closeModal('createPillar')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Pillar Name</label>
          <input type="text" class="form-input" id="newPillarName" placeholder="e.g., Customer Success">
        </div>
        <div class="form-group">
          <label class="form-label">Organization</label>
          <select class="form-select" id="newPillarOrg">
            <option value="Customer Care">Customer Care</option>
            <option value="Sales">Sales</option>
            <option value="Operations">Operations</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Channels (select all that apply)</label>
          <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 8px;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="checkbox" value="Phone" checked> 📞 Phone
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="checkbox" value="Email"> 📧 Email
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="checkbox" value="Chat"> 💬 Chat
            </label>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Pillar Owner Email</label>
          <input type="email" class="form-input" placeholder="owner@gusto.com">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('createPillar')">Cancel</button>
        <button class="btn btn-primary" onclick="createPillar()">Create Pillar</button>
      </div>
    </div>
  </div>
  
  <!-- Edit Pillar Modal -->
  <div class="modal-overlay" id="editPillarModal" onclick="if(event.target === this) closeModal('editPillar')">
    <div class="modal" style="max-width: 600px;">
      <div class="modal-header" style="background: var(--gusto-teal); color: white;">
        <h3 class="modal-title" style="color: white;">⚙️ Pillar Settings</h3>
        <button class="modal-close" onclick="closeModal('editPillar')" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
      </div>
      <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
        
        <!-- Basic Info Section -->
        <div style="margin-bottom: 20px;">
          <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal); text-transform: uppercase; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
            <span>📋</span> Basic Information
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label">Pillar Name</label>
              <input type="text" class="form-input" id="editPillarName" placeholder="e.g., Accountant">
            </div>
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label">Organization</label>
              <select class="form-select" id="editPillarOrg">
                <option value="On-Demand">On-Demand</option>
                <option value="Adv Care">Adv Care</option>
                <option value="Special">Special</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- Sites Section -->
        <div style="margin-bottom: 20px;">
          <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal); text-transform: uppercase; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
            <span>🏢</span> Sites Allocated
          </div>
          <div style="font-size: 11px; color: var(--gray-500); margin-bottom: 10px;">Select which sites service this pillar</div>
          <div style="display: flex; gap: 12px; flex-wrap: wrap;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 14px; background: var(--gray-50); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);">
              <input type="checkbox" id="editPillarSiteGusto" value="Gusto" checked> 
              <span style="font-size: 13px;">🏠 Gusto</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 14px; background: var(--gray-50); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);">
              <input type="checkbox" id="editPillarSiteApex" value="Apex" checked> 
              <span style="font-size: 13px;">🔺 Apex</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 14px; background: var(--gray-50); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);">
              <input type="checkbox" id="editPillarSiteTaskUs" value="TaskUs"> 
              <span style="font-size: 13px;">📋 TaskUs</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 14px; background: var(--gray-50); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);">
              <input type="checkbox" id="editPillarSiteTeleperformance" value="Teleperformance"> 
              <span style="font-size: 13px;">🌐 Teleperformance</span>
            </label>
          </div>
          <div style="font-size: 10px; color: var(--gray-400); margin-top: 8px; font-style: italic;">💡 Site allocation % is auto-calculated from actual HC data</div>
        </div>
        
        <!-- Channels Section -->
        <div style="margin-bottom: 20px;">
          <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal); text-transform: uppercase; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
            <span>📞</span> Channels Allocated
          </div>
          <div style="font-size: 11px; color: var(--gray-500); margin-bottom: 10px;">Select which channels belong to this pillar</div>
          <div style="display: flex; gap: 12px; flex-wrap: wrap;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 14px; background: var(--gray-50); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);">
              <input type="checkbox" id="editPillarPhone" value="Phone" checked> 
              <span style="font-size: 13px;">📞 Phone</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 14px; background: var(--gray-50); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);">
              <input type="checkbox" id="editPillarEmail" value="Email"> 
              <span style="font-size: 13px;">📧 Email</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 14px; background: var(--gray-50); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);">
              <input type="checkbox" id="editPillarChat" value="Chat"> 
              <span style="font-size: 13px;">💬 Chat</span>
            </label>
          </div>
          <div style="font-size: 10px; color: var(--gray-400); margin-top: 8px; font-style: italic;">💡 Channel allocation % is auto-calculated from volume data</div>
        </div>
        
        <!-- Calculation Settings Section -->
        <div style="margin-bottom: 20px; padding: 16px; background: var(--gusto-teal-light); border-radius: var(--radius-md); border: 1px solid var(--gusto-teal);">
          <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal); text-transform: uppercase; margin-bottom: 4px; display: flex; align-items: center; gap: 6px;">
            <span>🧮</span> Calculation Settings
          </div>
          <div style="font-size: 11px; color: var(--gray-600); margin-bottom: 12px;">These values drive HC calculations for this pillar</div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label" style="display: flex; align-items: center; gap: 4px;">
                Daily Work Hours
                <span style="font-size: 9px; color: var(--gray-400);">(per IC)</span>
              </label>
              <input type="number" class="form-input" id="editPillarDailyHours" value="7.5" step="0.5" min="4" max="12">
              <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Standard is 7.5 hrs/day</div>
            </div>
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label" style="display: flex; align-items: center; gap: 4px;">
                Ramp Period
                <span style="font-size: 9px; background: var(--gusto-teal); color: white; padding: 1px 6px; border-radius: 8px;">MONTHS</span>
              </label>
              <input type="number" class="form-input" id="editPillarRampPeriod" value="3" min="1" max="12">
              <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Months until new hire is fully productive</div>
            </div>
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label" style="display: flex; align-items: center; gap: 4px;">
                Baseline Attrition %
                <span style="font-size: 9px; color: var(--gray-400);">(monthly)</span>
              </label>
              <input type="number" class="form-input" id="editPillarAttrition" value="5" step="0.5" min="0" max="50">
              <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Used in HC forecasting</div>
            </div>
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label" style="display: flex; align-items: center; gap: 4px;">
                Default Shrink %
                <span style="font-size: 9px; color: var(--gray-400);">(if not in baseline)</span>
              </label>
              <input type="number" class="form-input" id="editPillarShrink" value="18" step="1" min="0" max="50">
              <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Fallback if baseline doesn't specify</div>
            </div>
          </div>
        </div>
        
        <!-- Owner & Status Section -->
        <div style="margin-bottom: 20px;">
          <div style="font-size: 12px; font-weight: 600; color: var(--gusto-teal); text-transform: uppercase; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
            <span>👤</span> Ownership & Status
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label">Pillar Owner Email</label>
              <input type="email" class="form-input" id="editPillarOwner" placeholder="owner@gusto.com">
              <div style="font-size: 10px; color: var(--gray-500); margin-top: 4px;">Will receive change notifications</div>
            </div>
            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label">Status</label>
              <select class="form-select" id="editPillarStatus">
                <option value="Ready">🟢 Ready</option>
                <option value="Editing">🟡 Editing</option>
                <option value="Missing">🔴 Missing Data</option>
                <option value="Overlay">🔵 Overlay Only</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- Admin Notification Note -->
        <div style="padding: 14px; background: var(--warning-bg); border-radius: var(--radius-sm); border-left: 3px solid var(--warning);">
          <div style="font-size: 12px; color: var(--warning); font-weight: 600; margin-bottom: 6px;">🔔 Admin Notifications (Future)</div>
          <div style="font-size: 11px; color: var(--gray-600); line-height: 1.5;">
            When user permissions are implemented, setting changes will:
            <ul style="margin: 6px 0 0 16px; padding: 0;">
              <li>Notify pillar owner via email</li>
              <li>Log who changed what and when</li>
              <li>Optionally post to Slack channel</li>
            </ul>
          </div>
        </div>
        
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('editPillar')">Cancel</button>
        <button class="btn btn-primary" onclick="savePillarSettings()">💾 Save Changes</button>
      </div>
    </div>
  </div>
  
  <script>
    // ═══════════════════════════════════════════════════════════════════════
    // WEBAPP PROTOTYPE - Interactive Functionality
    // ═══════════════════════════════════════════════════════════════════════
    
    // Navigation toggle
    function toggleNav() {
      document.getElementById('navSidebar').classList.toggle('collapsed');
    }
    
    // Pillar selection with loading animation
    function selectPillar(pillar) {
      if (!pillar) return;
      console.log('selectPillar called with:', pillar);
      
      // Show loading overlay
      const loadingOverlay = document.getElementById('pillarLoadingOverlay');
      if (loadingOverlay) {
        loadingOverlay.style.display = 'flex';
      }
      
      // Switch to pillar view
      document.querySelectorAll('.view-container').forEach(v => {
        v.style.display = 'none';
      });
      document.getElementById('view-pillar').style.display = 'block';
      
      // Simulate loading delay for realistic feel
      setTimeout(() => {
        if (loadingOverlay) {
          loadingOverlay.style.display = 'none';
        }
      }, 600);
      
      // Update URL hash for persistence
      window.location.hash = 'pillar-' + pillar;
      
      // Keep greeting (don't update page title)
      
      // Hide pillar dropdown in pillar view (selected via nav)
      const dropdown = document.getElementById('pillarDropdown');
      if (dropdown) {
        dropdown.style.display = 'none';
      }
      
      // Show scenarios button in pillar view
      const scenariosBtn = document.getElementById('scenariosBtn');
      if (scenariosBtn) {
        scenariosBtn.style.display = 'inline-flex';
      }
      
      // Update channel names to match selected pillar
      document.querySelectorAll('.channel-name').forEach(el => {
        const currentText = el.textContent;
        if (currentText.includes(' - Phone') || currentText.includes('Phone')) {
          el.textContent = pillar + ' - Phone';
        } else if (currentText.includes(' - Email') || currentText.includes('Email')) {
          el.textContent = pillar + ' - Email';
        } else if (currentText.includes(' - Chat') || currentText.includes('Chat')) {
          el.textContent = pillar + ' - Chat';
        }
      });
      
      // Update table headers in channel sections
      document.querySelectorAll('.channel-body th').forEach(th => {
        const text = th.textContent;
        if (text.includes('Phone') && !text.includes(pillar)) {
          th.textContent = pillar + ' - Phone';
        } else if (text.includes('Email') && !text.includes(pillar)) {
          th.textContent = pillar + ' - Email';
        } else if (text.includes('Chat') && !text.includes(pillar)) {
          th.textContent = pillar + ' - Chat';
        }
      });
      
      // Update pillar staffing model header
      const staffingHeader = document.querySelector('#staffingModelSection .table-title span');
      if (staffingHeader) {
        staffingHeader.textContent = pillar + ' Staffing Model';
      }
      
      // Update pillar view header
      const pillarNameDisplay = document.getElementById('pillarNameDisplay');
      if (pillarNameDisplay) {
        pillarNameDisplay.textContent = pillar;
      }
      
      // Update pillar settings button
      const settingsBtn = document.querySelector('#view-pillar .btn-secondary[onclick*="openEditPillarModal"]');
      if (settingsBtn) {
        // Get org for this pillar (demo data)
        const pillarOrgs = {
          'Accountant': 'On-Demand',
          'Benefits': 'On-Demand',
          'PAC': 'Adv Care',
          'Payroll': 'On-Demand',
          'Premier': 'On-Demand',
          'DSA': 'Special'
        };
        const org = pillarOrgs[pillar] || 'On-Demand';
        settingsBtn.setAttribute('onclick', `openEditPillarModal('${pillar}', '${org}')`);
      }
      
      // Show comparison toggle for pillar view
      const comparisonToggle = document.getElementById('comparisonToggle');
      if (comparisonToggle) {
        comparisonToggle.style.display = 'flex';
      }
      
      // Clear all nav active states first
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      
      // Set active on the pillar item
      const pillarNav = document.getElementById('pillar-' + pillar);
      if (pillarNav) {
        pillarNav.classList.add('active');
      }
      
      currentView = 'pillar';
      // No toast for navigation
    }
    
    // View loading
    function loadView(view) {
      console.log('loadView called with:', view);
      
      // Hide all view containers
      document.querySelectorAll('.view-container').forEach(v => {
        v.style.display = 'none';
      });
      
      // Show the selected view
      const viewElement = document.getElementById('view-' + view);
      if (viewElement) {
        viewElement.style.display = 'block';
        console.log('Showing view:', view);
      } else {
        console.log('View not found:', view);
        // Fallback to allin
        document.getElementById('view-allin').style.display = 'block';
      }
      
      // Update URL hash for persistence
      window.location.hash = view;
      
      // Clear all nav active states
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      
      // Set active on clicked item
      const navItem = document.getElementById('nav-' + view);
      if (navItem) {
        navItem.classList.add('active');
      }
      
      // Update page title and dropdown visibility
      const dropdown = document.getElementById('pillarDropdown');
      const pageTitle = document.getElementById('pageTitle');
      
      // Show/hide comparison toggle based on view
      const comparisonToggle = document.getElementById('comparisonToggle');
      
      const scenariosBtn = document.getElementById('scenariosBtn');
      
      // Keep greeting, just update dropdown/toggle visibility (no toasts for nav)
      if (view === 'controlpanel') {
        dropdown.style.display = 'none';
        comparisonToggle.style.display = 'none';
        if (scenariosBtn) scenariosBtn.style.display = 'none';
      } else if (view === 'allin') {
        dropdown.style.display = 'none';
        comparisonToggle.style.display = 'flex';
        if (scenariosBtn) scenariosBtn.style.display = 'inline-flex';
      } else if (view === 'dashboard') {
        dropdown.style.display = 'none';
        comparisonToggle.style.display = 'none';
      } else if (view === 'comparison') {
        dropdown.style.display = 'none';
        comparisonToggle.style.display = 'none';
      } else if (view === 'pillar') {
        dropdown.style.display = 'inline-block';
        comparisonToggle.style.display = 'flex';
      } else if (view === 'datamanagement' || view === 'published' || view === 'scenarios') {
        dropdown.style.display = 'none';
        comparisonToggle.style.display = 'none';
        if (scenariosBtn) scenariosBtn.style.display = 'none';
      } else if (view === 'overlays') {
        dropdown.style.display = 'none';
        comparisonToggle.style.display = 'none';
        if (scenariosBtn) scenariosBtn.style.display = 'none';
      } else if (view === 'projecthub' || view === 'designsystem' || view === 'overview') {
        dropdown.style.display = 'none';
        comparisonToggle.style.display = 'none';
        if (scenariosBtn) scenariosBtn.style.display = 'none';
      }
      
      // Update current view state
      currentView = view;
    }
    
    // Channel toggle
    function toggleChannel(header) {
      header.parentElement.classList.toggle('expanded');
    }
    
    // Modal management
    function openModal(type) {
      document.getElementById(type + 'Modal').classList.add('active');
    }
    
    function closeModal(type) {
      document.getElementById(type + 'Modal').classList.remove('active');
    }
    
    // Stat card month selector - Full 24 months
    function updateAllStatCardMonths(monthValue) {
      // Map month value to display text - 24 months
      const monthLabels = {
        'dec24': 'Dec-24', 'jan25': 'Jan-25', 'feb25': 'Feb-25', 'mar25': 'Mar-25',
        'apr25': 'Apr-25', 'may25': 'May-25', 'jun25': 'Jun-25', 'jul25': 'Jul-25',
        'aug25': 'Aug-25', 'sep25': 'Sep-25', 'oct25': 'Oct-25', 'nov25': 'Nov-25',
        'dec25': 'Dec-25', 'jan26': 'Jan-26', 'feb26': 'Feb-26', 'mar26': 'Mar-26',
        'apr26': 'Apr-26', 'may26': 'May-26', 'jun26': 'Jun-26', 'jul26': 'Jul-26',
        'aug26': 'Aug-26', 'sep26': 'Sep-26', 'oct26': 'Oct-26', 'nov26': 'Nov-26'
      };
      
      // Update all stat-month labels
      document.querySelectorAll('.stat-month').forEach(span => {
        span.textContent = monthLabels[monthValue] || monthValue;
      });
      
      // In real implementation, this would update the values from the data
      showToast('📊 Updated stat cards to ' + monthLabels[monthValue], 'info');
    }
    
    // Update individual stat card metric
    function updateStatCard(select, cardId) {
      // In real implementation, this would update the card value based on selected metric
      showToast('📊 Changed metric to: ' + select.options[select.selectedIndex].text, 'info');
    }
    
    // Update trend chart metric - dynamically changes chart lines and legend
    function updateTrendChart(metric) {
      const chartLine1 = document.getElementById('chartLine1');
      const chartLine2 = document.getElementById('chartLine2');
      const chartPoints1 = document.getElementById('chartPoints1');
      const chartTitle = document.getElementById('chartTitle');
      const legend1 = document.getElementById('legend1Text');
      const legend2 = document.getElementById('legend2Text');
      const legendContainer = document.getElementById('chartLegend');
      
      // Chart data for different metrics
      const chartData = {
        hc_need: {
          line1: '55,85 92,88 129,80 166,75 203,82 240,86 277,90 314,87 351,82 388,74 425,70 462,67',
          line2: '55,115 92,112 129,108 166,102 203,96 240,93 277,90 314,87 351,83 388,80 425,77 462,75',
          legend1: 'HC Need', legend2: 'Actual HC',
          title: 'HC Need vs Actual HC (12-month view)',
          color1: '#0a8080', color2: '#f45d48', showLine2: true
        },
        net_staffing: {
          line1: '55,110 92,105 129,108 166,112 203,100 240,95 277,88 314,90 351,92 388,98 425,102 462,105',
          line2: null,
          legend1: 'Net Staffing Gap', legend2: '',
          title: 'Net Staffing Gap (negative = understaffed)',
          color1: '#f45d48', color2: '', showLine2: false
        },
        volume: {
          line1: '55,95 92,100 129,85 166,78 203,88 240,92 277,105 314,98 351,90 388,82 425,75 462,72',
          line2: '55,105 92,108 129,95 166,90 203,98 240,102 277,112 314,106 351,98 388,92 425,88 462,85',
          line3: '55,115 92,118 129,108 166,102 203,108 240,112 277,120 314,115 351,108 388,102 425,98 462,95',
          legend1: 'Phone', legend2: 'Email', legend3: 'Chat',
          title: 'Volume by Channel (12-month view)',
          color1: '#0a8080', color2: '#f45d48', color3: '#6366f1', showLine2: true, showLine3: true
        },
        aht: {
          line1: '55,70 92,72 129,68 166,65 203,70 240,72 277,75 314,73 351,70 388,68 425,65 462,63',
          line2: '55,50 92,52 129,48 166,45 203,50 240,52 277,55 314,53 351,50 388,48 425,45 462,43',
          line3: '55,55 92,57 129,52 166,50 203,54 240,56 277,58 314,56 351,54 388,52 425,50 462,48',
          legend1: 'Phone (828s)', legend2: 'Email (1122s)', legend3: 'Chat (1100s)',
          title: 'AHT by Channel in seconds (12-month view)',
          color1: '#0a8080', color2: '#f45d48', color3: '#6366f1', showLine2: true, showLine3: true
        },
        productive_hc: {
          line1: '55,115 92,110 129,105 166,98 203,92 240,88 277,82 314,78 351,75 388,72 425,68 462,65',
          line2: '55,85 92,88 129,80 166,75 203,82 240,86 277,90 314,87 351,82 388,74 425,70 462,67',
          legend1: 'Productive HC', legend2: 'HC Need',
          title: 'Productive HC vs HC Need',
          color1: '#22c55e', color2: '#0a8080', showLine2: true
        }
      };
      
      const data = chartData[metric] || chartData.hc_need;
      
      // Update chart lines
      chartLine1.setAttribute('points', data.line1);
      chartLine1.setAttribute('stroke', data.color1);
      
      if (data.showLine2 && data.line2) {
        chartLine2.style.display = 'block';
        chartLine2.setAttribute('points', data.line2);
        chartLine2.setAttribute('stroke', data.color2);
      } else {
        chartLine2.style.display = 'none';
      }
      
      // Update points to match line1
      const points = data.line1.split(' ');
      let pointsHtml = '';
      points.forEach(p => {
        const [x, y] = p.split(',');
        pointsHtml += `<circle cx="${x}" cy="${y}" r="4"/>`;
      });
      chartPoints1.innerHTML = pointsHtml;
      chartPoints1.setAttribute('fill', data.color1);
      
      // Update title and legend
      chartTitle.textContent = data.title;
      legend1.textContent = data.legend1;
      legend2.textContent = data.legend2;
      
      // Update legend colors
      const legendLines = legendContainer.querySelectorAll('.legend-line');
      if (legendLines[0]) legendLines[0].style.background = data.color1;
      if (legendLines[1]) {
        legendLines[1].style.background = data.color2;
        legendLines[1].parentElement.style.display = data.showLine2 ? 'flex' : 'none';
      }
      
      // Add third legend item for volume/AHT if needed
      if (data.showLine3) {
        let legend3 = document.getElementById('legend3Item');
        if (!legend3) {
          legend3 = document.createElement('div');
          legend3.id = 'legend3Item';
          legend3.className = 'legend-item';
          legend3.innerHTML = `<span class="legend-line" style="background: ${data.color3}"></span><span id="legend3Text">${data.legend3}</span>`;
          legendContainer.appendChild(legend3);
        } else {
          legend3.style.display = 'flex';
          document.getElementById('legend3Text').textContent = data.legend3;
          legend3.querySelector('.legend-line').style.background = data.color3;
        }
      } else {
        const legend3 = document.getElementById('legend3Item');
        if (legend3) legend3.style.display = 'none';
      }
      
      showToast('📈 Showing: ' + data.title, 'info');
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // PLAN NOTES FUNCTIONALITY
    // ═══════════════════════════════════════════════════════════════════════
    
    function toggleNoteDropdown(dropdownId) {
      const dropdown = document.getElementById(dropdownId);
      const allDropdowns = document.querySelectorAll('.note-dropdown');
      
      // Close all other dropdowns
      allDropdowns.forEach(d => {
        if (d.id !== dropdownId) d.style.display = 'none';
      });
      
      // Toggle this one
      dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
    }
    
    function updateNoteTagLabel(type) {
      const dropdownId = `note${type}Dropdown`;
      const labelId = `note${type}Label`;
      const dropdown = document.getElementById(dropdownId);
      const label = document.getElementById(labelId);
      
      const checked = dropdown.querySelectorAll('input:checked');
      if (checked.length === 0) {
        label.textContent = type;
        label.style.color = 'var(--gray-500)';
      } else if (checked.length === 1) {
        label.textContent = checked[0].value;
        label.style.color = 'var(--gray-700)';
      } else {
        label.textContent = `${checked.length} selected`;
        label.style.color = 'var(--gusto-teal)';
      }
    }
    
    function getSelectedNoteTags(type) {
      const dropdownId = `note${type}Dropdown`;
      const dropdown = document.getElementById(dropdownId);
      if (!dropdown) return [];
      const checked = dropdown.querySelectorAll('input:checked');
      return Array.from(checked).map(c => c.value);
    }
    
    function clearNoteTagSelections() {
      ['Month', 'Type', 'Channel'].forEach(type => {
        const dropdown = document.getElementById(`note${type}Dropdown`);
        if (dropdown) {
          dropdown.querySelectorAll('input').forEach(cb => cb.checked = false);
        }
        updateNoteTagLabel(type);
      });
    }
    
    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.note-multiselect')) {
        document.querySelectorAll('.note-dropdown').forEach(d => d.style.display = 'none');
      }
    });
    
    function addNote() {
      const noteInput = document.getElementById('noteInput');
      const noteCustomTags = document.getElementById('noteCustomTags');
      const notesDisplay = document.getElementById('notesDisplay');
      
      // Get selected tags from multi-selects
      const selectedMonths = getSelectedNoteTags('Month');
      const selectedTypes = getSelectedNoteTags('Type');
      const selectedChannels = getSelectedNoteTags('Channel');
      
      if (!noteInput.value.trim()) {
        showToast('⚠️ Please enter a note', 'warning');
        return;
      }
      
      // Create note element
      const noteItem = document.createElement('div');
      noteItem.className = 'note-item';
      noteItem.style.cssText = 'background: white; padding: 6px; border-radius: 4px; margin-bottom: 4px; border-left: 3px solid var(--gusto-teal); animation: slideIn 0.3s ease; cursor: pointer;';
      
      // Build tags
      let tagsHtml = '<div style="display: flex; gap: 4px; margin-bottom: 3px; flex-wrap: wrap;">';
      
      // Month tags (teal)
      selectedMonths.forEach(month => {
        tagsHtml += `<span class="note-tag" style="background: var(--gusto-teal-light); color: var(--gusto-teal); padding: 1px 6px; border-radius: 10px; font-size: 9px;">${month}</span>`;
      });
      
      // Type tags (colored by type)
      const typeColors = {
        'Staffing': 'background: var(--gusto-coral-light); color: var(--gusto-coral)',
        'Volume': 'background: #EDE9FE; color: #7C3AED',
        'AHT': 'background: #FEF3C7; color: #D97706',
        'Overlay': 'background: #D1FAE5; color: #059669',
        'General': 'background: var(--gray-100); color: var(--gray-600)'
      };
      selectedTypes.forEach(type => {
        tagsHtml += `<span class="note-tag" style="${typeColors[type] || 'background: var(--gray-100); color: var(--gray-600)'}; padding: 1px 6px; border-radius: 10px; font-size: 9px;">${type}</span>`;
      });
      
      // Channel tags (pink)
      selectedChannels.forEach(channel => {
        tagsHtml += `<span class="note-tag" style="background: #FCE7F3; color: #DB2777; padding: 1px 6px; border-radius: 10px; font-size: 9px;">${channel}</span>`;
      });
      
      // Add custom tags (amber)
      if (noteCustomTags && noteCustomTags.value.trim()) {
        const customTags = noteCustomTags.value.split(',').map(t => t.trim()).filter(t => t);
        customTags.forEach(tag => {
          tagsHtml += `<span class="note-tag" style="background: #FEF3C7; color: #92400E; padding: 1px 6px; border-radius: 10px; font-size: 9px;">${tag}</span>`;
        });
      }
      tagsHtml += '</div>';
      
      // Format note text (auto-link URLs, bold)
      let noteText = noteInput.value;
      let fullNoteText = noteText;
      // Auto-link URLs
      noteText = noteText.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" style="color: var(--gusto-teal);">$1</a>');
      // Bold text between **
      noteText = noteText.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
      
      // Truncate if too long (show first 80 chars)
      const isLong = fullNoteText.length > 80;
      const truncatedText = isLong ? noteText.substring(0, 80) + '...' : noteText;
      
      noteItem.innerHTML = tagsHtml + `
        <div class="note-text-truncated" style="color: var(--gray-700); font-size: 9px;">${truncatedText}</div>
        <div class="note-text-full" style="color: var(--gray-700); font-size: 9px; display: none;">${noteText}</div>
        ${isLong ? '<div style="color: var(--gusto-teal); font-size: 8px; margin-top: 2px;">Click to expand ▼</div>' : ''}
      `;
      
      // Add click to expand for long notes
      if (isLong) {
        noteItem.onclick = function() {
          const truncated = this.querySelector('.note-text-truncated');
          const full = this.querySelector('.note-text-full');
          const hint = this.querySelector('div:last-child');
          if (truncated.style.display !== 'none') {
            truncated.style.display = 'none';
            full.style.display = 'block';
            hint.innerHTML = 'Click to collapse ▲';
          } else {
            truncated.style.display = 'block';
            full.style.display = 'none';
            hint.innerHTML = 'Click to expand ▼';
          }
        };
      }
      
      // Add to display (at top)
      notesDisplay.insertBefore(noteItem, notesDisplay.firstChild);
      
      // Clear inputs
      noteInput.value = '';
      if (noteCustomTags) noteCustomTags.value = '';
      clearNoteTagSelections();
      
      showToast('📝 Note added!', 'success');
    }
    
    function popOutNotes() {
      let modal = document.getElementById('notesModal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'notesModal';
        modal.className = 'modal-overlay';
        modal.innerHTML = `
          <div class="modal" style="max-width: 600px; max-height: 80vh; display: flex; flex-direction: column;">
            <div class="modal-header" style="background: var(--gusto-teal-dark); color: white;">
              <h3 class="modal-title" style="color: white;">📝 Plan Notes - Expanded View</h3>
              <button class="modal-close" onclick="closeNotesModal()" style="background: rgba(255,255,255,0.2); color: white; border: none; width: 28px; height: 28px; border-radius: 4px; font-size: 16px; cursor: pointer;">✕</button>
            </div>
            <div class="modal-content" style="flex: 1; display: flex; flex-direction: column; padding: var(--space-md);">
              <div id="notesDisplayExpanded" style="flex: 1; overflow-y: auto; padding: 12px; background: var(--gray-50); border-radius: var(--radius-sm); margin-bottom: 12px; min-height: 300px;">
                <!-- Notes will be copied here -->
              </div>
              <div style="padding-top: 12px; border-top: 1px solid var(--gray-200);">
                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                  <select id="noteMonthExpanded" style="flex: 1; padding: 6px 8px; font-size: 12px; border: 1px solid var(--gray-200); border-radius: 4px;">
                    <option value="">Select Month</option>
                    <option>Dec-24</option><option>Jan-25</option><option>Feb-25</option><option>Mar-25</option>
                    <option>Apr-25</option><option>May-25</option><option>Jun-25</option><option>Jul-25</option>
                    <option>Aug-25</option><option>Sep-25</option><option>Oct-25</option><option>Nov-25</option>
                  </select>
                  <select id="noteTypeExpanded" style="flex: 1; padding: 6px 8px; font-size: 12px; border: 1px solid var(--gray-200); border-radius: 4px;">
                    <option value="">Select Type</option>
                    <option>Staffing</option><option>Volume</option><option>AHT</option><option>Overlay</option><option>General</option>
                  </select>
                  <select id="noteChannelExpanded" style="flex: 1; padding: 6px 8px; font-size: 12px; border: 1px solid var(--gray-200); border-radius: 4px;">
                    <option value="">Select Channel</option>
                    <option>All</option><option>Phone</option><option>Chat</option><option>Email</option>
                  </select>
                </div>
                <div style="display: flex; gap: 8px;">
                  <textarea id="noteInputExpanded" placeholder="Add a detailed note... Use **bold** for emphasis and URLs will auto-link." style="flex: 1; padding: 8px; font-size: 12px; border: 1px solid var(--gray-200); border-radius: 4px; resize: vertical; min-height: 60px;"></textarea>
                </div>
                <div style="display: flex; justify-content: flex-end; gap: 8px; margin-top: 8px;">
                  <button onclick="closeNotesModal()" class="btn btn-secondary">Close</button>
                  <button onclick="addNoteExpanded()" class="btn btn-primary">+ Add Note</button>
                </div>
              </div>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      }
      
      // Copy current notes to expanded view
      const notesDisplay = document.getElementById('notesDisplay');
      const notesExpanded = document.getElementById('notesDisplayExpanded');
      notesExpanded.innerHTML = notesDisplay.innerHTML;
      
      // Use active class for visibility (matches CSS)
      modal.classList.add('active');
    }
    
    function closeNotesModal() {
      const modal = document.getElementById('notesModal');
      if (modal) modal.classList.remove('active');
    }
    
    function addAllInNote() {
      const noteInput = document.getElementById('allInNoteInput');
      const notesDisplay = document.getElementById('allInNotesDisplay');
      
      if (!noteInput.value.trim()) {
        showToast('⚠️ Please enter a note', 'warning');
        return;
      }
      
      const noteItem = document.createElement('div');
      noteItem.className = 'note-item';
      noteItem.style.cssText = 'background: white; padding: 6px; border-radius: 4px; margin-bottom: 4px; border-left: 3px solid var(--gusto-teal); animation: slideIn 0.3s ease;';
      
      let noteText = noteInput.value;
      noteText = noteText.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" style="color: var(--gusto-teal);">$1</a>');
      noteText = noteText.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
      
      noteItem.innerHTML = `<div style="color: var(--gray-700); font-size: 9px;">${noteText}</div>`;
      notesDisplay.insertBefore(noteItem, notesDisplay.firstChild);
      noteInput.value = '';
      showToast('📝 Note added!', 'success');
    }
    
    function updateAllInTrendChart(metric) {
      const title = document.getElementById('allInChartTitle');
      const titles = {
        'hc': 'HC Need vs Actual HC (All Pillars)',
        'volume': 'Total Volume Trend',
        'staffing': 'Net Staffing Gap'
      };
      title.textContent = titles[metric] || titles['hc'];
      showToast('📈 Showing: ' + (titles[metric] || 'HC Trend'), 'info');
    }
    
    function addNoteExpanded() {
      const noteInput = document.getElementById('noteInputExpanded');
      const noteMonth = document.getElementById('noteMonthExpanded');
      const noteType = document.getElementById('noteTypeExpanded');
      const noteChannel = document.getElementById('noteChannelExpanded');
      const notesExpanded = document.getElementById('notesDisplayExpanded');
      const notesDisplay = document.getElementById('notesDisplay');
      
      if (!noteInput.value.trim()) {
        showToast('⚠️ Please enter a note', 'warning');
        return;
      }
      
      // Create note element
      const noteItem = document.createElement('div');
      noteItem.style.cssText = 'background: white; padding: 10px; border-radius: 6px; margin-bottom: 8px; border-left: 4px solid var(--gusto-teal); box-shadow: 0 1px 3px rgba(0,0,0,0.1);';
      
      // Build tags
      let tagsHtml = '<div style="display: flex; gap: 6px; margin-bottom: 6px; flex-wrap: wrap;">';
      
      if (noteMonth.value) {
        tagsHtml += `<span style="background: var(--gusto-teal-light); color: var(--gusto-teal); padding: 2px 8px; border-radius: 12px; font-size: 11px;">${noteMonth.value}</span>`;
      }
      if (noteType.value) {
        const typeColors = {
          'Staffing': 'background: var(--gusto-coral-light); color: var(--gusto-coral)',
          'Volume': 'background: #EDE9FE; color: #7C3AED',
          'AHT': 'background: #FEF3C7; color: #D97706',
          'Overlay': 'background: #D1FAE5; color: #059669',
          'General': 'background: var(--gray-100); color: var(--gray-600)'
        };
        tagsHtml += `<span style="${typeColors[noteType.value]}; padding: 2px 8px; border-radius: 12px; font-size: 11px;">${noteType.value}</span>`;
      }
      if (noteChannel.value && noteChannel.value !== 'All') {
        tagsHtml += `<span style="background: #FCE7F3; color: #DB2777; padding: 2px 8px; border-radius: 12px; font-size: 11px;">${noteChannel.value}</span>`;
      }
      tagsHtml += '</div>';
      
      // Format note text
      let noteText = noteInput.value;
      noteText = noteText.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" style="color: var(--gusto-teal);">$1</a>');
      noteText = noteText.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
      noteText = noteText.replace(/\n/g, '<br>');
      
      noteItem.innerHTML = tagsHtml + `<div style="color: var(--gray-700); font-size: 12px; line-height: 1.5;">${noteText}</div>`;
      
      // Add to both displays
      notesExpanded.insertBefore(noteItem, notesExpanded.firstChild);
      
      // Create compact version for main display
      const compactNote = document.createElement('div');
      compactNote.className = 'note-item';
      compactNote.style.cssText = 'background: white; padding: 6px; border-radius: 4px; margin-bottom: 4px; border-left: 3px solid var(--gusto-teal);';
      compactNote.innerHTML = tagsHtml.replace(/padding: 2px 8px/g, 'padding: 1px 6px').replace(/font-size: 11px/g, 'font-size: 9px') + 
        `<div style="color: var(--gray-700); font-size: 9px;">${noteText.substring(0, 50)}${noteText.length > 50 ? '...' : ''}</div>`;
      notesDisplay.insertBefore(compactNote, notesDisplay.firstChild);
      
      // Clear inputs
      noteInput.value = '';
      noteMonth.value = '';
      noteType.value = '';
      noteChannel.value = '';
      
      showToast('📝 Note added!', 'success');
    }
    
    // Expand chart to full screen modal
    function expandChart() {
      // Create and show chart modal
      let modal = document.getElementById('chartExpandModal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'chartExpandModal';
        modal.className = 'chart-modal';
        modal.innerHTML = `
          <div class="chart-modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
              <h2 style="margin: 0;">📈 HC Need Trend - Full View</h2>
              <button onclick="closeChartModal()" style="background: none; border: none; font-size: 24px; cursor: pointer;">✕</button>
            </div>
            <div id="expandedChartContainer" style="height: 400px;">
              <!-- Expanded chart will be cloned here -->
            </div>
          </div>
        `;
        modal.onclick = function(e) {
          if (e.target === modal) closeChartModal();
        };
        document.body.appendChild(modal);
      }
      
      // Clone the chart into the modal
      const chartContainer = document.getElementById('trendChartContainer');
      const expandedContainer = document.getElementById('expandedChartContainer');
      expandedContainer.innerHTML = chartContainer.innerHTML;
      
      modal.classList.add('active');
      showToast('📈 Chart expanded - click outside to close', 'info');
    }
    
    function closeChartModal() {
      const modal = document.getElementById('chartExpandModal');
      if (modal) {
        modal.classList.remove('active');
      }
    }
    
    // Toast notifications
    function showToast(message, type = 'info') {
      const container = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      toast.className = 'toast ' + type;
      toast.innerHTML = message;
      container.appendChild(toast);
      
      setTimeout(() => {
        toast.remove();
      }, 3000);
    }
    
    // Actions - Open confirmation modals
    function recalculate() {
      openModal('recalculate');
    }
    
    function publishPlan() {
      openModal('publish');
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // EXPORT & DATA MANAGEMENT FUNCTIONS
    // ═══════════════════════════════════════════════════════════════════════
    
    let selectedExportFormat = 'pillar-template';
    let selectedImportType = 'baseline';
    
    function selectExportFormat(format) {
      selectedExportFormat = format;
      // Update UI
      document.querySelectorAll('[id^="export-"]').forEach(el => {
        if (el.id === 'export-' + format) {
          el.style.background = 'var(--gusto-teal-light)';
          el.style.border = '2px solid var(--gusto-teal)';
        } else {
          el.style.background = 'var(--gray-50)';
          el.style.border = '1px solid var(--gray-200)';
        }
      });
    }
    
    function selectImportType(type) {
      selectedImportType = type;
      // Update UI
      document.querySelectorAll('[id^="import-"]').forEach(el => {
        if (el.id === 'import-' + type) {
          el.style.background = 'var(--gusto-teal-light)';
          el.style.border = '2px solid var(--gusto-teal)';
        } else {
          el.style.background = 'var(--gray-50)';
          el.style.border = '1px solid var(--gray-200)';
        }
      });
    }
    
    function exportPlanData() {
      const planSelect = document.getElementById('exportPlanSelect');
      const pillarScope = document.getElementById('exportPillarScope');
      const planName = planSelect.options[planSelect.selectedIndex].text;
      const pillarName = pillarScope.options[pillarScope.selectedIndex].text;
      
      showToast('📤 Preparing export...', 'info');
      
      setTimeout(() => {
        if (selectedExportFormat === 'pillar-template') {
          showToast('✅ Pillar Template exported! Opening in Google Sheets...', 'success');
          // In production: would generate and open a new Sheet with the template format
          console.log('Exporting as Pillar Template:', { plan: planSelect.value, pillar: pillarScope.value });
        } else if (selectedExportFormat === 'executive-summary') {
          showToast('✅ Executive Summary generated! Downloading PDF...', 'success');
          console.log('Exporting as Executive Summary:', { plan: planSelect.value, pillar: pillarScope.value });
        } else {
          showToast('✅ Raw data exported! Downloading CSV...', 'success');
          console.log('Exporting as Raw Data:', { plan: planSelect.value, pillar: pillarScope.value });
        }
      }, 1500);
    }
    
    function importData() {
      showToast('📥 Import functionality coming soon!', 'info');
    }
    
    function syncAllData() {
      showToast('🔄 Syncing all data sources...', 'info');
      setTimeout(() => {
        showToast('✅ All data sources synced successfully!', 'success');
      }, 2000);
    }
    
    function openDataDictionary() {
      showToast('📖 Data Dictionary - Coming soon!', 'info');
    }
    
    function openArchitectureDocs() {
      // Open the PRD we created
      window.open('/Users/bunny.bates/Desktop/Planning Web Tool/PRODUCT_REQUIREMENTS.html', '_blank');
      showToast('🏗️ Opening Architecture Documentation...', 'info');
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // PROJECT HUB FUNCTIONS - Sprint tracking, notes, localStorage
    // ═══════════════════════════════════════════════════════════════════════
    
    // Load saved notes from localStorage on page load
    function loadProjectNotes() {
      const savedNotes = localStorage.getItem('capacityPlanner_projectNotes');
      const notesTextarea = document.getElementById('projectNotes');
      if (savedNotes && notesTextarea) {
        notesTextarea.value = savedNotes;
      }
    }
    
    // Save notes to localStorage
    function saveProjectNotes() {
      const notesTextarea = document.getElementById('projectNotes');
      if (notesTextarea) {
        localStorage.setItem('capacityPlanner_projectNotes', notesTextarea.value);
        showToast('💾 Notes saved to browser storage!', 'success');
      }
    }
    
    // Update sprint progress based on checked items
    function updateSprintProgress() {
      const checklist = document.getElementById('sprintChecklist');
      if (!checklist) return;
      
      const allCheckboxes = checklist.querySelectorAll('input[type="checkbox"]');
      const checkedBoxes = checklist.querySelectorAll('input[type="checkbox"]:checked');
      
      const total = allCheckboxes.length;
      const completed = checkedBoxes.length;
      const percentage = Math.round((completed / total) * 100);
      
      // Update progress display
      const progressEl = document.getElementById('sprintProgress');
      const tasksEl = document.getElementById('tasksComplete');
      
      if (progressEl) {
        progressEl.textContent = percentage + '%';
        progressEl.parentElement.querySelector('div > div').style.width = percentage + '%';
      }
      if (tasksEl) {
        tasksEl.textContent = completed + '/' + total;
      }
      
      // Save checkbox states to localStorage
      const checkboxStates = Array.from(allCheckboxes).map((cb, idx) => ({
        index: idx,
        checked: cb.checked
      }));
      localStorage.setItem('capacityPlanner_sprintChecklist', JSON.stringify(checkboxStates));
    }
    
    // Load saved checkbox states
    function loadSprintProgress() {
      const saved = localStorage.getItem('capacityPlanner_sprintChecklist');
      if (!saved) return;
      
      const checklist = document.getElementById('sprintChecklist');
      if (!checklist) return;
      
      const checkboxStates = JSON.parse(saved);
      const allCheckboxes = checklist.querySelectorAll('input[type="checkbox"]');
      
      checkboxStates.forEach(state => {
        if (allCheckboxes[state.index]) {
          allCheckboxes[state.index].checked = state.checked;
        }
      });
      
      // Update display
      updateSprintProgress();
    }
    
    // Add new sprint task
    function addSprintTask() {
      const taskName = prompt('Enter task name:');
      if (!taskName) return;
      
      const taskDesc = prompt('Enter task description (optional):') || '';
      const targetDate = prompt('Target date (e.g., Dec 20):') || 'TBD';
      
      const checklist = document.getElementById('sprintChecklist');
      if (!checklist) return;
      
      // Find the upcoming section
      const upcomingLabel = Array.from(checklist.querySelectorAll('div')).find(d => d.textContent.includes('Upcoming'));
      
      const newTask = document.createElement('label');
      newTask.className = 'task-item';
      newTask.style.cssText = 'display: flex; align-items: flex-start; gap: 10px; padding: 10px 12px; background: var(--gray-50); border-radius: var(--radius-sm); cursor: pointer; border-left: 3px solid var(--gray-300);';
      newTask.innerHTML = '<input type="checkbox" onchange="updateSprintProgress()" style="margin-top: 2px;">' +
        '<div style="flex: 1;">' +
          '<div style="font-size: 13px; color: var(--gray-700);">' + taskName + '</div>' +
          '<div style="font-size: 10px; color: var(--gray-500);">' + taskDesc + '</div>' +
        '</div>' +
        '<span style="font-size: 10px; color: var(--gray-400);">' + targetDate + '</span>';
      
      if (upcomingLabel) {
        upcomingLabel.after(newTask);
      } else {
        checklist.appendChild(newTask);
      }
      
      updateSprintProgress();
      showToast('✅ Task added!', 'success');
    }
    
    // Calculate days remaining
    function updateDaysRemaining() {
      const targetDate = new Date('2025-12-31');
      const today = new Date();
      const diffTime = targetDate - today;
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      
      const daysEl = document.getElementById('daysLeft');
      if (daysEl) {
        daysEl.textContent = diffDays > 0 ? diffDays : '0';
        if (diffDays <= 7) {
          daysEl.style.color = 'var(--error)';
        } else if (diffDays <= 14) {
          daysEl.style.color = 'var(--warning)';
        }
      }
    }
    
    // Toggle collapsible sections in Project Hub
    function toggleProjectSection(headerElement) {
      const content = headerElement.nextElementSibling;
      const arrow = headerElement.querySelector('.collapse-arrow');
      
      if (content && content.classList.contains('collapsible-content')) {
        if (content.style.display === 'none') {
          content.style.display = 'block';
          if (arrow) arrow.style.transform = 'rotate(0deg)';
        } else {
          content.style.display = 'none';
          if (arrow) arrow.style.transform = 'rotate(-90deg)';
        }
      }
    }
    
    // Initialize Project Hub on load
    document.addEventListener('DOMContentLoaded', function() {
      loadProjectNotes();
      loadSprintProgress();
      updateDaysRemaining();
    });
    
    function openArchiveManager() {
      showToast('🗄️ Archive Manager - Coming soon!', 'info');
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // CAPACITY CALCULATOR ENGINE - Core HC Calculations
    // Based on: https://docs.google.com/spreadsheets/d/1Jfm3Gv7xkaHtl5Vrf8qQpFtOElQu4MX-xl2OykBpuVs/edit?gid=1616116817
    // ═══════════════════════════════════════════════════════════════════════
    
    const CapacityCalculator = {
      
      // Configuration defaults (can be overridden per pillar/channel)
      defaults: {
        dailyWorkHours: 7.5,  // User defined, usually 7.5
        standardWorkHours: 8,  // Standard 8-hour day for HC conversion
        rampPeriod: 3          // Months until new hire is productive
      },
      
      // ═══════════════════════════════════════════════════════════════════════
      // PILLAR-CHANNEL LEVEL CALCULATIONS
      // ═══════════════════════════════════════════════════════════════════════
      
      /**
       * Calculate Productive Hours for a month
       * Formula: Productive Days × Daily Work Hours
       * Note: Shrink is NOT applied here - it's applied in FTE calculation
       */
      calculateProductiveHours: function(productiveDays, dailyWorkHours) {
        return productiveDays * (dailyWorkHours || this.defaults.dailyWorkHours);
      },
      
      /**
       * Calculate Base FTE Need (No Overlays)
       * Formula: ((Volume × (AHT/Concurrency)) / 3600 / Productive Hours / Occupancy) × (1 + Shrink)
       * 
       * @param {number} volume - Monthly contact volume
       * @param {number} ahtSeconds - Average Handle Time in SECONDS
       * @param {number} concurrency - Concurrent sessions (1 for phone, 2-3 for chat)
       * @param {number} productiveHours - Monthly productive hours
       * @param {number} occupancyPercent - Occupancy percentage (e.g., 85 for 85%)
       * @param {number} shrinkPercent - Shrink percentage (e.g., 18 for 18%)
       */
      calculateBaseFTENeed: function(volume, ahtSeconds, concurrency, productiveHours, occupancyPercent, shrinkPercent) {
        const occ = occupancyPercent / 100;
        const shrink = shrinkPercent / 100;
        
        if (productiveHours === 0 || occ === 0 || concurrency === 0) return 0;
        
        // ((Volume × (AHT/Concurrency)) / 3600 / Productive Hours / Occupancy) × (1 + Shrink)
        const workload = (volume * (ahtSeconds / concurrency)) / 3600;
        const baseFTE = (workload / productiveHours / occ) * (1 + shrink);
        
        return baseFTE;
      },
      
      /**
       * Calculate FTE Need with SL Uplift
       * Formula: Base FTE Need × SL Uplift Factor
       */
      calculateFTEWithSLUplift: function(baseFTE, slUpliftFactor) {
        return baseFTE * (slUpliftFactor || 1.0);
      },
      
      /**
       * Calculate Headcount Need from FTE
       * Formula: FTE Need / (Daily Work Hours / 8)
       * This converts FTE to headcount - if daily hours < 8, need more HC
       * Example: 110.6 FTE / (7.5/8) = 110.6 / 0.9375 = 118 HC
       */
      calculateHCFromFTE: function(fteNeed, dailyWorkHours) {
        const dwh = dailyWorkHours || this.defaults.dailyWorkHours;
        return fteNeed / (dwh / 8);
      },
      
      /**
       * Full Pillar-Channel calculation (Baseline - No Overlays)
       */
      calculateBaselineChannel: function(inputs) {
        const {
          volume,
          ahtSeconds,
          concurrency,
          productiveDays,
          dailyWorkHours,
          occupancyPercent,
          shrinkPercent,
          slUpliftFactor
        } = inputs;
        
        // Step 1: Productive Hours
        const productiveHours = this.calculateProductiveHours(productiveDays, dailyWorkHours);
        
        // Step 2: Base FTE Need (no overlays)
        const baseFTENeed = this.calculateBaseFTENeed(
          volume, ahtSeconds, concurrency, productiveHours, occupancyPercent, shrinkPercent
        );
        
        // Step 3: Base FTE with SL Uplift
        const baseFTEWithSL = this.calculateFTEWithSLUplift(baseFTENeed, slUpliftFactor);
        
        // Step 4: Base Headcount Need
        const baseHCNeed = this.calculateHCFromFTE(baseFTEWithSL, dailyWorkHours);
        
        return {
          productiveHours: this.round(productiveHours),
          baseFTENeed: this.round(baseFTENeed),
          baseFTEWithSL: this.round(baseFTEWithSL),
          baseHCNeed: this.round(baseHCNeed)
        };
      },
      
      /**
       * Full Pillar-Channel calculation (Active - With Overlays)
       * Same formulas but with overlay-adjusted inputs
       */
      calculateActiveChannel: function(inputs) {
        const {
          volumeActive,           // Volume with overlays applied
          ahtSecondsActive,       // AHT with overlays applied
          concurrencyActive,      // Concurrency with overlays
          productiveDays,
          dailyWorkHours,
          occupancyPercentActive, // Occupancy with overlays
          shrinkPercentActive,    // Shrink with overlays
          slUpliftFactor
        } = inputs;
        
        // Step 1: Productive Hours (same as baseline)
        const productiveHours = this.calculateProductiveHours(productiveDays, dailyWorkHours);
        
        // Step 2: Active FTE Need (with overlays)
        const activeFTENeed = this.calculateBaseFTENeed(
          volumeActive, ahtSecondsActive, concurrencyActive, productiveHours, occupancyPercentActive, shrinkPercentActive
        );
        
        // Step 3: Active FTE with SL Uplift
        const activeFTEWithSL = this.calculateFTEWithSLUplift(activeFTENeed, slUpliftFactor);
        
        // Step 4: Active Headcount Need
        const activeHCNeed = this.calculateHCFromFTE(activeFTEWithSL, dailyWorkHours);
        
        return {
          productiveHours: this.round(productiveHours),
          activeFTENeed: this.round(activeFTENeed),
          activeFTEWithSL: this.round(activeFTEWithSL),
          activeHCNeed: this.round(activeHCNeed)
        };
      },
      
      /**
       * Calculate Overlay Impact
       * Formula: Active HC Need - Base HC Need
       */
      calculateOverlayImpact: function(activeHCNeed, baseHCNeed) {
        return activeHCNeed - baseHCNeed;
      },
      
      // ═══════════════════════════════════════════════════════════════════════
      // PILLAR STAFFING MODEL CALCULATIONS
      // ═══════════════════════════════════════════════════════════════════════
      
      /**
       * Calculate Actual Headcount (with forecast fallback)
       * Uses LET formula logic: IF actual exists, use it; else use forecast
       * 
       * @param {number} actualHC - Actual HC from data (0 if not available)
       * @param {number} prevMonthHC - Previous month's HC
       * @param {number} newHires - Ramped new hires for this month
       * @param {number} attritionRate - Monthly attrition rate (e.g., 0.05 for 5%)
       */
      calculateActualHC: function(actualHC, prevMonthHC, newHires, attritionRate) {
        if (actualHC && actualHC > 0) {
          return actualHC;
        }
        // Forecast: (Previous + New Hires) - (Attrition × Previous)
        const forecastHC = (prevMonthHC + newHires) - (attritionRate * prevMonthHC);
        return Math.max(0, forecastHC);
      },
      
      /**
       * Calculate Net Staffing Gap
       * Formula: Actual HC - Active HC Need
       * Positive = overstaffed, Negative = understaffed
       */
      calculateNetStaffingGap: function(actualHC, activeHCNeed) {
        return actualHC - activeHCNeed;
      },
      
      /**
       * Calculate Planned OT Headcount
       * Formula: ROUND((Planned OT Per IC × Total Actual HC) / Productive Hours)
       */
      calculatePlannedOTHeadcount: function(plannedOTPerIC, totalActualHC, productiveHours) {
        if (productiveHours === 0) return 0;
        return Math.round((plannedOTPerIC * totalActualHC) / productiveHours);
      },
      
      /**
       * Calculate Net Staffing with OT
       * Formula: Net Staffing Gap + Planned OT Headcount
       */
      calculateNetStaffingWithOT: function(netStaffingGap, plannedOTHeadcount) {
        return netStaffingGap + plannedOTHeadcount;
      },
      
      /**
       * Calculate Required OT Per IC Per Month (Channel Level)
       * Formula: -(Net Staffing × Channel Allocation) × (Productive Hours) / Actual Headcount
       * This tells you how much OT each person needs to work to cover the gap
       */
      calculateRequiredOTPerIC: function(netStaffing, channelAllocation, productiveHours, actualHC) {
        if (actualHC === 0) return 0;
        return -(netStaffing * channelAllocation) * (productiveHours) / actualHC;
      },
      
      /**
       * Calculate Required OT Headcount
       * Formula: (Required OT Per IC × Actual HC) / Productive Hours
       */
      calculateRequiredOTHeadcount: function(requiredOTPerIC, actualHC, productiveHours) {
        if (productiveHours === 0) return 0;
        return (requiredOTPerIC * actualHC) / productiveHours;
      },
      
      /**
       * Calculate Forecasted Attrition
       * Formula: Baseline Attrition + Attrition Adjustment
       */
      calculateForecastedAttrition: function(baselineAttrition, attritionAdjustment) {
        return baselineAttrition + (attritionAdjustment || 0);
      },
      
      // ═══════════════════════════════════════════════════════════════════════
      // PILLAR ROLLUP CALCULATIONS
      // ═══════════════════════════════════════════════════════════════════════
      
      /**
       * Sum values across channels for pillar-level metrics
       */
      sumChannels: function(channelValues) {
        return channelValues.reduce((sum, val) => sum + (val || 0), 0);
      },
      
      /**
       * Calculate Weighted Average AHT across channels
       * Formula: SUM(Volume × AHT) / SUM(Volume)
       */
      calculateWeightedAHT: function(channels) {
        let totalWeighted = 0;
        let totalVolume = 0;
        
        channels.forEach(ch => {
          totalWeighted += (ch.volume || 0) * (ch.aht || 0);
          totalVolume += (ch.volume || 0);
        });
        
        return totalVolume > 0 ? totalWeighted / totalVolume : 0;
      },
      
      /**
       * Calculate Site Allocation Percentage
       * Formula: Site HC / Total HC
       */
      calculateSiteAllocation: function(siteHC, totalHC) {
        return totalHC > 0 ? siteHC / totalHC : 0;
      },
      
      /**
       * Calculate Channel Allocation Percentage
       * Formula: Channel Volume / Total Volume
       */
      calculateChannelAllocation: function(channelVolume, totalVolume) {
        return totalVolume > 0 ? channelVolume / totalVolume : 0;
      },
      
      // ═══════════════════════════════════════════════════════════════════════
      // FULL CALCULATION PIPELINE
      // ═══════════════════════════════════════════════════════════════════════
      
      /**
       * Full calculation for a single channel/month
       * Returns all intermediate and final values
       */
      calculateFullChannel: function(inputs) {
        const {
          // Baseline inputs
          volume,
          ahtSeconds,
          concurrency,
          productiveDays,
          dailyWorkHours,
          occupancyPercent,
          shrinkPercent,
          slUpliftFactor,
          // Overlay inputs (use baseline if not provided)
          volumeOverlay,
          ahtSecondsOverlay,
          concurrencyOverlay,
          occupancyPercentOverlay,
          shrinkPercentOverlay
        } = inputs;
        
        // Use overlay values if provided, otherwise use baseline
        const volumeActive = volumeOverlay || volume;
        const ahtActive = ahtSecondsOverlay || ahtSeconds;
        const concActive = concurrencyOverlay || concurrency;
        const occActive = occupancyPercentOverlay || occupancyPercent;
        const shrinkActive = shrinkPercentOverlay || shrinkPercent;
        
        // Calculate baseline
        const baseline = this.calculateBaselineChannel({
          volume, ahtSeconds, concurrency, productiveDays, dailyWorkHours, occupancyPercent, shrinkPercent, slUpliftFactor
        });
        
        // Calculate active (with overlays)
        const active = this.calculateActiveChannel({
          volumeActive, ahtSecondsActive: ahtActive, concurrencyActive: concActive,
          productiveDays, dailyWorkHours, occupancyPercentActive: occActive, shrinkPercentActive: shrinkActive, slUpliftFactor
        });
        
        // Calculate overlay impact
        const overlayImpact = this.calculateOverlayImpact(active.activeHCNeed, baseline.baseHCNeed);
        
        return {
          inputs,
          baseline,
          active,
          overlayImpact: this.round(overlayImpact)
        };
      },
      
      /**
       * Full Pillar Staffing Model calculation
       */
      calculatePillarStaffing: function(inputs) {
        const {
          activeHCNeed,      // From channel rollup
          actualHC,          // From data or forecast
          productiveHours,
          plannedOTPerIC,
          channelAllocations // Array of {channel, allocation}
        } = inputs;
        
        // Net Staffing Gap
        const netStaffingGap = this.calculateNetStaffingGap(actualHC, activeHCNeed);
        
        // Planned OT Headcount
        const plannedOTHeadcount = this.calculatePlannedOTHeadcount(plannedOTPerIC, actualHC, productiveHours);
        
        // Net Staffing with OT
        const netStaffingWithOT = this.calculateNetStaffingWithOT(netStaffingGap, plannedOTHeadcount);
        
        // Required OT per channel
        const channelOT = channelAllocations.map(ch => ({
          channel: ch.channel,
          requiredOTPerIC: this.round(this.calculateRequiredOTPerIC(netStaffingGap, ch.allocation, productiveHours, actualHC))
        }));
        
        // Total Required OT Per IC
        const totalRequiredOTPerIC = channelOT.reduce((sum, ch) => sum + ch.requiredOTPerIC, 0);
        
        // Required OT Headcount
        const requiredOTHeadcount = this.calculateRequiredOTHeadcount(totalRequiredOTPerIC, actualHC, productiveHours);
        
        return {
          netStaffingGap: this.round(netStaffingGap),
          plannedOTHeadcount: this.round(plannedOTHeadcount),
          netStaffingWithOT: this.round(netStaffingWithOT),
          channelOT,
          totalRequiredOTPerIC: this.round(totalRequiredOTPerIC),
          requiredOTHeadcount: this.round(requiredOTHeadcount)
        };
      },
      
      // Utility function for rounding
      round: function(value, decimals) {
        decimals = decimals || 2;
        return Math.round(value * Math.pow(10, decimals)) / Math.pow(10, decimals);
      }
    };
    
    // ═══════════════════════════════════════════════════════════════════════
    // DATA IMPORT FUNCTIONS - CSV Parsing, Validation, Preview
    // ═══════════════════════════════════════════════════════════════════════
    
    let importedData = null;
    let importType = 'baseline';
    
    // Select import type
    function selectImportType(type) {
      importType = type;
      
      // Update UI
      document.querySelectorAll('[id^="import-"]').forEach(el => {
        if (el.id === 'import-' + type) {
          el.style.background = 'var(--gusto-teal-light)';
          el.style.border = '2px solid var(--gusto-teal)';
        } else {
          el.style.background = 'var(--gray-50)';
          el.style.border = '1px solid var(--gray-200)';
        }
      });
      
      showToast('Selected: ' + type.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase()), 'info');
    }
    
    // Select export format
    function selectExportFormat(format) {
      document.querySelectorAll('[id^="export-"]').forEach(el => {
        if (el.id === 'export-' + format) {
          el.style.background = 'var(--gusto-teal-light)';
          el.style.border = '2px solid var(--gusto-teal)';
        } else {
          el.style.background = 'var(--gray-50)';
          el.style.border = '1px solid var(--gray-200)';
        }
      });
    }
    
    // Open import modal
    function openImportModal() {
      document.getElementById('importModal').style.display = 'flex';
      document.getElementById('importPasteArea').value = '';
      document.getElementById('importPreview').innerHTML = '';
      document.getElementById('importPreview').style.display = 'none';
      document.getElementById('confirmImportBtn').disabled = true;
    }
    
    // Close import modal
    function closeImportModal() {
      document.getElementById('importModal').style.display = 'none';
      importedData = null;
    }
    
    // Parse CSV data from paste area
    function parseImportData() {
      const pasteArea = document.getElementById('importPasteArea');
      const rawData = pasteArea.value.trim();
      
      if (!rawData) {
        showToast('Please paste data first', 'warning');
        return;
      }
      
      // Parse CSV/TSV
      const lines = rawData.split('\n');
      const delimiter = rawData.includes('\t') ? '\t' : ',';
      
      const headers = lines[0].split(delimiter).map(h => h.trim().replace(/"/g, ''));
      const rows = [];
      
      for (let i = 1; i < lines.length; i++) {
        if (lines[i].trim()) {
          const values = lines[i].split(delimiter).map(v => v.trim().replace(/"/g, ''));
          const row = {};
          headers.forEach((h, idx) => {
            row[h] = values[idx] || '';
          });
          rows.push(row);
        }
      }
      
      importedData = { headers, rows };
      
      // Show preview
      showImportPreview(headers, rows.slice(0, 10));
      
      // Enable confirm button
      document.getElementById('confirmImportBtn').disabled = false;
      
      showToast('Parsed ' + rows.length + ' rows. Review preview below.', 'success');
    }
    
    // Show preview of imported data
    function showImportPreview(headers, rows) {
      const previewDiv = document.getElementById('importPreview');
      previewDiv.style.display = 'block';
      
      let html = '<div style="font-size: 12px; font-weight: 600; color: var(--gray-700); margin-bottom: 8px;">Preview (first 10 rows):</div>';
      html += '<div style="overflow-x: auto; max-height: 300px; border: 1px solid var(--gray-200); border-radius: var(--radius-sm);">';
      html += '<table style="width: 100%; border-collapse: collapse; font-size: 11px;">';
      
      // Headers
      html += '<thead><tr style="background: var(--gusto-teal); color: white; position: sticky; top: 0;">';
      headers.forEach(h => {
        html += '<th style="padding: 8px 10px; text-align: left; white-space: nowrap;">' + h + '</th>';
      });
      html += '</tr></thead>';
      
      // Rows
      html += '<tbody>';
      rows.forEach((row, idx) => {
        html += '<tr style="background: ' + (idx % 2 === 0 ? 'white' : 'var(--gray-50)') + ';">';
        headers.forEach(h => {
          const val = row[h] || '';
          const isNumeric = !isNaN(parseFloat(val)) && isFinite(val);
          html += '<td style="padding: 6px 10px; border-bottom: 1px solid var(--gray-100); ' + 
                  (isNumeric ? 'text-align: right; font-family: var(--font-mono);' : '') + '">' + 
                  val + '</td>';
        });
        html += '</tr>';
      });
      html += '</tbody></table></div>';
      
      // Column mapping section
      html += '<div style="margin-top: 16px; padding: 12px; background: var(--info-bg); border-radius: var(--radius-sm);">';
      html += '<div style="font-size: 12px; font-weight: 600; color: var(--info); margin-bottom: 8px;">📊 Detected Columns:</div>';
      html += '<div style="display: flex; flex-wrap: wrap; gap: 6px;">';
      headers.forEach(h => {
        const mapped = mapColumnToField(h);
        const color = mapped ? 'var(--success)' : 'var(--gray-500)';
        const bg = mapped ? 'var(--success-bg)' : 'var(--gray-100)';
        html += '<span style="padding: 4px 8px; background: ' + bg + '; color: ' + color + '; border-radius: 4px; font-size: 10px;">';
        html += h + (mapped ? ' → ' + mapped : ' (unmapped)');
        html += '</span>';
      });
      html += '</div></div>';
      
      previewDiv.innerHTML = html;
    }
    
    // Map column headers to expected fields
    function mapColumnToField(header) {
      const headerLower = header.toLowerCase().replace(/[_\s-]/g, '');
      
      const mappings = {
        // Baseline forecast mappings
        'volume': 'volume',
        'contacts': 'volume',
        'aht': 'aht',
        'averagehandletime': 'aht',
        'shrink': 'shrink',
        'shrinkpercent': 'shrink',
        'occupancy': 'occupancy',
        'occ': 'occupancy',
        'concurrency': 'concurrency',
        'sltarget': 'slTarget',
        'servicelevel': 'slTarget',
        'sluplift': 'slUplift',
        'pillar': 'pillar',
        'channel': 'channel',
        'month': 'month',
        'date': 'month',
        'organization': 'organization',
        'org': 'organization',
        
        // Active HC mappings
        'headcount': 'actualHC',
        'hc': 'actualHC',
        'activehc': 'actualHC',
        'ftecount': 'actualHC',
        'site': 'site',
        'location': 'site',
        
        // Overlay mappings
        'overlayimpact': 'overlayImpact',
        'impact': 'overlayImpact',
        'ottarget': 'plannedOT',
        'plannedhours': 'plannedOT'
      };
      
      return mappings[headerLower] || null;
    }
    
    // Confirm and process import
    function confirmImport() {
      if (!importedData || !importedData.rows.length) {
        showToast('No data to import', 'error');
        return;
      }
      
      // Store in localStorage for now (will be replaced with Sheets API)
      const storageKey = 'capacityPlanner_import_' + importType;
      localStorage.setItem(storageKey, JSON.stringify(importedData));
      
      showToast('✅ Imported ' + importedData.rows.length + ' rows as ' + importType, 'success');
      closeImportModal();
      
      // Trigger recalculation if we have both baseline and HC
      if (localStorage.getItem('capacityPlanner_import_baseline') && 
          localStorage.getItem('capacityPlanner_import_active-hc')) {
        showToast('📊 Ready to calculate! Both baseline and HC data loaded.', 'success');
      }
    }
    
    // Run calculations on imported data
    function runCalculations() {
      const baseline = JSON.parse(localStorage.getItem('capacityPlanner_import_baseline') || 'null');
      const activeHC = JSON.parse(localStorage.getItem('capacityPlanner_import_active-hc') || 'null');
      
      if (!baseline) {
        showToast('Please import Baseline Forecast data first', 'warning');
        return;
      }
      
      // Process calculations
      const results = [];
      baseline.rows.forEach(row => {
        const inputs = {
          volume: parseFloat(row.Volume || row.Contacts || 0),
          aht: parseFloat(row.AHT || row['Average Handle Time'] || 0),
          occupancy: parseFloat(row.Occupancy || row['Occ'] || 85),
          concurrency: parseFloat(row.Concurrency || 1),
          shrinkPercent: parseFloat(row.Shrink || row['Shrink %'] || 30),
          slUpliftFactor: parseFloat(row['SL Uplift'] || 1),
          overlayImpactPercent: 0,
          actualHC: 0,
          plannedOTHours: 0,
          workingDays: 21,
          dailyHours: 8
        };
        
        // Match with active HC if available
        if (activeHC) {
          const hcMatch = activeHC.rows.find(hc => 
            (hc.Pillar || hc.pillar) === (row.Pillar || row.pillar) &&
            (hc.Month || hc.Date) === (row.Month || row.Date)
          );
          if (hcMatch) {
            inputs.actualHC = parseFloat(hcMatch.HC || hcMatch.Headcount || hcMatch['Active HC'] || 0);
          }
        }
        
        const calc = CapacityCalculator.calculateFull(inputs);
        results.push({
          pillar: row.Pillar || row.pillar,
          channel: row.Channel || row.channel,
          month: row.Month || row.Date,
          ...calc
        });
      });
      
      // Store results
      localStorage.setItem('capacityPlanner_calculations', JSON.stringify(results));
      
      showToast('✅ Calculated ' + results.length + ' rows!', 'success');
      
      // Show results summary
      console.log('Calculation Results:', results);
      
      return results;
    }
    
    // Test calculation with sample data (matches your Pillar Template)
    function testCalculation() {
      // Sample from Payroll and Taxes - Phone, May-2025
      const testInputs = {
        volume: 47118,
        ahtSeconds: 888,        // AHT in SECONDS
        concurrency: 1,
        productiveDays: 21,
        dailyWorkHours: 7.5,
        occupancyPercent: 85,
        shrinkPercent: 18,
        slUpliftFactor: 1.08
      };
      
      const result = CapacityCalculator.calculateFullChannel(testInputs);
      
      console.log('=== Test Calculation (Payroll Phone May-25) ===');
      console.log('Inputs:', testInputs);
      console.log('Baseline Results:', result.baseline);
      console.log('Active Results:', result.active);
      console.log('Overlay Impact:', result.overlayImpact);
      console.log('================================================');
      
      let msg = '════════════════════════════════════\n';
      msg += '🧮 CHANNEL CALCULATION TEST\n';
      msg += '════════════════════════════════════\n\n';
      msg += '📍 PILLAR: Payroll and Taxes\n';
      msg += '📞 CHANNEL: Phone\n';
      msg += '📅 MONTH: May-2025\n';
      msg += '────────────────────────────────────\n\n';
      msg += 'INPUTS:\n';
      msg += '  • Volume: ' + testInputs.volume.toLocaleString() + '\n';
      msg += '  • AHT: ' + testInputs.ahtSeconds + ' seconds\n';
      msg += '  • Occupancy: ' + testInputs.occupancyPercent + '%\n';
      msg += '  • Shrink: ' + testInputs.shrinkPercent + '%\n';
      msg += '  • SL Uplift: ' + testInputs.slUpliftFactor + '\n';
      msg += '  • Productive Days: ' + testInputs.productiveDays + '\n';
      msg += '  • Daily Work Hours: ' + testInputs.dailyWorkHours + '\n\n';
      msg += '────────────────────────────────────\n';
      msg += 'CALCULATED RESULTS:\n';
      msg += '  • Productive Hours: ' + result.baseline.productiveHours + '\n';
      msg += '  • Base FTE Need: ' + result.baseline.baseFTENeed + '\n';
      msg += '  • Base FTE w/ SL: ' + result.baseline.baseFTEWithSL + '\n';
      msg += '  • Base HC Need: ' + result.baseline.baseHCNeed + '\n\n';
      msg += '────────────────────────────────────\n';
      msg += 'EXPECTED (from your sheet):\n';
      msg += '  • Productive Hours: 158\n';
      msg += '  • Base FTE: 102.4\n';
      msg += '  • Base FTE w/ SL: 110.6\n';
      msg += '  • Base HC Need: 118\n\n';
      msg += '════════════════════════════════════\n';
      msg += 'MATCH: ' + (Math.abs(result.baseline.baseHCNeed - 118) < 2 ? '✅ SUCCESS!' : '⚠️ Check formulas') + '\n';
      msg += '════════════════════════════════════';
      
      alert(msg);
      return result;
    }
    
    // Test Pillar Staffing Model
    function testStaffingModel() {
      const staffingInputs = {
        activeHCNeed: 118,
        actualHC: 125,
        productiveHours: 157.5,
        plannedOTPerIC: 10,
        channelAllocations: [
          { channel: 'Phone', allocation: 0.7 },
          { channel: 'Chat', allocation: 0.2 },
          { channel: 'Email', allocation: 0.1 }
        ]
      };
      
      const result = CapacityCalculator.calculatePillarStaffing(staffingInputs);
      
      console.log('=== Pillar Staffing Model Test ===');
      console.log('Inputs:', staffingInputs);
      console.log('Results:', result);
      console.log('==================================');
      
      let msg = '════════════════════════════════════\n';
      msg += '🏢 PILLAR STAFFING MODEL TEST\n';
      msg += '════════════════════════════════════\n\n';
      msg += '📍 PILLAR: Payroll and Taxes\n';
      msg += '📅 MONTH: May-2025 (Sample)\n';
      msg += '────────────────────────────────────\n\n';
      msg += 'INPUTS:\n';
      msg += '  • Active HC Need: ' + staffingInputs.activeHCNeed + '\n';
      msg += '  • Actual HC: ' + staffingInputs.actualHC + '\n';
      msg += '  • Productive Hours: ' + staffingInputs.productiveHours + '\n';
      msg += '  • Planned OT/IC: ' + staffingInputs.plannedOTPerIC + ' hrs\n\n';
      msg += 'CHANNEL ALLOCATIONS:\n';
      staffingInputs.channelAllocations.forEach(function(ch) {
        msg += '  • ' + ch.channel + ': ' + (ch.allocation * 100) + '%\n';
      });
      msg += '\n────────────────────────────────────\n';
      msg += 'CALCULATED RESULTS:\n';
      msg += '  • Net Staffing Gap: ' + result.netStaffingGap + '\n';
      msg += '    (Positive = Overstaffed)\n';
      msg += '  • Planned OT HC: ' + result.plannedOTHeadcount + '\n';
      msg += '  • Net w/ OT: ' + result.netStaffingWithOT + '\n';
      msg += '  • Required OT/IC: ' + result.totalRequiredOTPerIC + ' hrs\n';
      msg += '  • Required OT HC: ' + result.requiredOTHeadcount + '\n\n';
      msg += '════════════════════════════════════';
      
      alert(msg);
      return result;
    }
    
    // Load sample baseline forecast data
    function loadSampleBaseline() {
      const sampleData = `Pillar\tChannel\tMonth\tVolume\tAHT\tShrink\tOccupancy\tConcurrency\tSL Target\tSL Uplift
Payroll\tPhone\tJan-25\t12500\t8.5\t30\t85\t1\t80\t1.15
Payroll\tPhone\tFeb-25\t11800\t8.2\t30\t85\t1\t80\t1.15
Payroll\tPhone\tMar-25\t13200\t8.8\t30\t85\t1\t80\t1.15
Payroll\tChat\tJan-25\t8500\t6.0\t25\t80\t2.5\t85\t1.10
Payroll\tChat\tFeb-25\t7900\t5.8\t25\t80\t2.5\t85\t1.10
Payroll\tChat\tMar-25\t9100\t6.2\t25\t80\t2.5\t85\t1.10
Benefits\tPhone\tJan-25\t9800\t10.2\t32\t82\t1\t75\t1.18
Benefits\tPhone\tFeb-25\t8500\t9.8\t32\t82\t1\t75\t1.18
Benefits\tPhone\tMar-25\t10500\t10.5\t32\t82\t1\t75\t1.18
Accountant\tPhone\tJan-25\t6200\t12.0\t28\t88\t1\t85\t1.12
Accountant\tPhone\tFeb-25\t5800\t11.5\t28\t88\t1\t85\t1.12
Accountant\tPhone\tMar-25\t7500\t12.8\t28\t88\t1\t85\t1.12`;
      
      document.getElementById('importPasteArea').value = sampleData;
      selectImportType('baseline');
      showToast('📋 Sample baseline data loaded! Click "Parse & Preview"', 'info');
    }
    
    // Load sample active HC data
    function loadSampleActiveHC() {
      const sampleData = `Pillar\tMonth\tSite\tHeadcount
Payroll\tJan-25\tGusto\t28
Payroll\tJan-25\tApex\t12
Payroll\tJan-25\tTaskUs\t8
Payroll\tFeb-25\tGusto\t29
Payroll\tFeb-25\tApex\t12
Payroll\tFeb-25\tTaskUs\t8
Payroll\tMar-25\tGusto\t30
Payroll\tMar-25\tApex\t13
Payroll\tMar-25\tTaskUs\t9
Benefits\tJan-25\tGusto\t22
Benefits\tJan-25\tApex\t10
Benefits\tFeb-25\tGusto\t21
Benefits\tFeb-25\tApex\t10
Benefits\tMar-25\tGusto\t23
Benefits\tMar-25\tApex\t11
Accountant\tJan-25\tGusto\t15
Accountant\tFeb-25\tGusto\t15
Accountant\tMar-25\tGusto\t16`;
      
      document.getElementById('importPasteArea').value = sampleData;
      selectImportType('active-hc');
      showToast('📋 Sample HC data loaded! Click "Parse & Preview"', 'info');
    }
    
    // Update selectImportType to also update modal cards
    (function() {
      const originalSelectImportType = selectImportType;
      selectImportType = function(type) {
        importType = type;
        
        // Update both data management and modal UIs
        ['', 'modal-'].forEach(prefix => {
          document.querySelectorAll('[id^="' + prefix + 'import-"]').forEach(el => {
            const elType = el.id.replace(prefix, '').replace('import-', '');
            if (elType === type) {
              el.style.background = 'var(--gusto-teal-light)';
              el.style.border = '2px solid var(--gusto-teal)';
            } else if (!el.id.includes('Preview') && !el.id.includes('Btn') && !el.id.includes('Area') && !el.id.includes('Status')) {
              el.style.background = 'var(--gray-50)';
              el.style.border = '1px solid var(--gray-200)';
            }
          });
        });
        
        showToast('Selected: ' + type.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()), 'info');
      };
    })();
    
    // ═══════════════════════════════════════════════════════════════════════
    // OVERLAY TRACKER FUNCTIONS
    // ═══════════════════════════════════════════════════════════════════════
    
    function filterOverlays(status) {
      showToast('🔍 Filtering overlays by: ' + status, 'info');
      // In production: would filter the table rows
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // OVERLAY SIDE PANEL FUNCTIONS
    // ═══════════════════════════════════════════════════════════════════════
    
    function toggleOverlayPanel() {
      const panel = document.getElementById('overlaySidePanel');
      const backdrop = document.getElementById('overlaySidePanelBackdrop');
      const isOpen = panel.style.right === '0px';
      
      if (isOpen) {
        panel.style.right = '-420px';
        backdrop.style.display = 'none';
      } else {
        panel.style.right = '0px';
        backdrop.style.display = 'block';
      }
    }
    
    function showPillarOverlays(pillarName) {
      toggleOverlayPanel();
      showToast('📋 Showing overlays for ' + pillarName, 'info');
    }
    
    function toggleSidePanelPillar(header) {
      const content = header.nextElementSibling;
      const arrow = header.querySelector('.panel-pillar-arrow');
      const isHidden = content.style.display === 'none';
      
      content.style.display = isHidden ? 'block' : 'none';
      arrow.textContent = isHidden ? '▼' : '▶';
    }
    
    function filterOverlaysByMonth(month) {
      showToast('🗓️ Filtering overlays for: ' + month, 'info');
      // In production: would filter overlay data
    }
    
    function addUnquantifiedOverlay() {
      // Scroll to the unquantified section and expand it
      const section = document.getElementById('unquantified-section');
      const content = document.getElementById('unquantified-content');
      const arrow = document.getElementById('unquantified-arrow');
      
      // Expand if collapsed
      if (content.style.display === 'none') {
        content.style.display = 'block';
        arrow.style.transform = 'rotate(0deg)';
      }
      
      // Scroll to it
      section.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    
    function toggleUnquantifiedSection() {
      const content = document.getElementById('unquantified-content');
      const arrow = document.getElementById('unquantified-arrow');
      
      if (content.style.display === 'none') {
        content.style.display = 'block';
        arrow.style.transform = 'rotate(0deg)';
      } else {
        content.style.display = 'none';
        arrow.style.transform = 'rotate(-90deg)';
      }
    }
    
    function saveNewOverlay() {
      showToast('✅ Overlay added successfully!', 'success');
      // In production: would save to database and refresh table
    }
    
    function saveUnquantifiedNote() {
      showToast('📝 Note saved! You can quantify it later.', 'success');
      // In production: would save to database
    }
    
    function promoteToOverlay(btn) {
      showToast('↑ Opening quantification form...', 'info');
      // In production: would open a modal or scroll to add row with prefilled data
    }
    
    function openAddOverlayModal() {
      showToast('➕ Add Overlay modal - Coming soon!', 'info');
    }
    
    function saveScenario() {
      const name = document.getElementById('scenarioName').value;
      if (!name) {
        showToast('Please enter a scenario name', 'warning');
        return;
      }
      
      // Get selected pillars
      const selected = [];
      document.querySelectorAll('.pillar-checkbox-scenario:checked').forEach(cb => {
        selected.push(cb.value);
      });
      
      if (selected.length === 0) {
        showToast('Please select at least one pillar', 'warning');
        return;
      }
      
      closeModal('save');
      showToast('💾 Saving scenario for ' + selected.length + ' pillars...', 'info');
      
      setTimeout(() => {
        showToast('✅ Scenario "' + name + '" saved!', 'success');
      }, 1000);
    }
    
    function confirmPublish() {
      // Get selected pillars
      const selected = [];
      document.querySelectorAll('.pillar-checkbox-publish:checked').forEach(cb => {
        selected.push(cb.value);
      });
      
      if (selected.length === 0) {
        showToast('Please select at least one pillar', 'warning');
        return;
      }
      
      closeModal('publish');
      showToast('✅ Publishing ' + selected.length + ' pillars...', 'info');
      
      setTimeout(() => {
        showToast('🎉 Plan v3.3 published successfully!', 'success');
        // Update status indicator
        document.querySelector('.status-dot').className = 'status-dot';
        document.querySelector('.status-details').textContent = 'Published just now';
      }, 1500);
    }
    
    function confirmRecalculate() {
      // Get selected pillars
      const selected = [];
      document.querySelectorAll('.pillar-checkbox-recalc:checked').forEach(cb => {
        selected.push(cb.value);
      });
      
      if (selected.length === 0) {
        showToast('Please select at least one pillar', 'warning');
        return;
      }
      
      closeModal('recalculate');
      showToast('🔄 Recalculating ' + selected.length + ' pillars...', 'info');
      
      setTimeout(() => {
        showToast('✅ Calculations complete for ' + selected.join(', '), 'success');
      }, 1500);
    }
    
    // Toggle all pillars in a modal
    function toggleAllPillars(type) {
      const selectAll = document.getElementById('selectAll' + type.charAt(0).toUpperCase() + type.slice(1));
      const checkboxes = document.querySelectorAll('.pillar-checkbox-' + type + ':not(:disabled)');
      
      checkboxes.forEach(cb => {
        cb.checked = selectAll.checked;
      });
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // MULTI-SELECT DROPDOWNS
    // ═══════════════════════════════════════════════════════════════════════
    
    function toggleMultiSelect(id) {
      const el = document.getElementById(id);
      el.classList.toggle('open');
    }
    
    function toggleAllInMultiSelect(id, selectAllCheckbox) {
      const dropdown = document.getElementById(id);
      const checkboxes = dropdown.querySelectorAll('.multi-select-item:not(.select-all) input[type="checkbox"]');
      
      checkboxes.forEach(cb => {
        cb.checked = selectAllCheckbox.checked;
      });
      
      updateMultiSelectLabel(id);
    }
    
    function updateMultiSelectLabel(id) {
      const dropdown = document.getElementById(id);
      const checkboxes = dropdown.querySelectorAll('.multi-select-item:not(.select-all) input[type="checkbox"]');
      const checkedCount = dropdown.querySelectorAll('.multi-select-item:not(.select-all) input[type="checkbox"]:checked').length;
      const trigger = dropdown.querySelector('.multi-select-trigger span');
      
      if (checkedCount === 0) {
        trigger.textContent = 'None selected';
      } else if (checkedCount === checkboxes.length) {
        trigger.textContent = id.includes('pillar') ? 'All Pillars' : 'All Channels';
      } else {
        trigger.textContent = checkedCount + ' selected';
      }
    }
    
    // Close multi-selects when clicking outside
    document.addEventListener('click', function(e) {
      document.querySelectorAll('.multi-select').forEach(ms => {
        if (!ms.contains(e.target)) {
          ms.classList.remove('open');
        }
      });
    });
    
    // Update labels when individual checkboxes change
    document.addEventListener('change', function(e) {
      if (e.target.closest('.multi-select-item:not(.select-all)')) {
        const multiSelect = e.target.closest('.multi-select');
        if (multiSelect) {
          updateMultiSelectLabel(multiSelect.id);
        }
      }
    });
    
    // ═══════════════════════════════════════════════════════════════════════
    // SMART INPUT DETECTION (% vs value)
    // ═══════════════════════════════════════════════════════════════════════
    
    // Detect if input is percent or value based on content
    function detectInputMode(input) {
      const value = input.value.trim();
      
      if (value.includes('%')) {
        input.classList.add('is-percent');
        input.classList.remove('is-value');
        input.title = 'Detected as PERCENT: ' + value;
      } else if (value !== '') {
        input.classList.add('is-value');
        input.classList.remove('is-percent');
        input.title = 'Detected as VALUE: ' + value;
      } else {
        input.classList.remove('is-percent', 'is-value');
        input.title = '';
      }
    }
    
    // Alias for HTML oninput handlers
    function handleInputMode(input) {
      detectInputMode(input);
    }
    
    // Apply smart detection to all overlay inputs
    document.querySelectorAll('.row-editable input[type="text"], .row-editable input[type="number"]').forEach(input => {
      input.addEventListener('input', function() {
        detectInputMode(this);
      });
      input.addEventListener('blur', function() {
        detectInputMode(this);
      });
    });
    
    // ═══════════════════════════════════════════════════════════════════════
    // QUARTER GROUPING TOGGLE
    // ═══════════════════════════════════════════════════════════════════════
    
    function toggleQuarter(quarterNum) {
      const months = document.querySelectorAll('.q' + quarterNum + '-month');
      const header = document.querySelector('.q' + quarterNum + '-header');
      
      months.forEach(m => {
        m.classList.toggle('collapsed');
      });
      
      // Update header indicator
      const isCollapsed = months[0]?.classList.contains('collapsed');
      header.textContent = isCollapsed ? 
        'Q' + quarterNum + ' ▶' : 
        'Q' + quarterNum + ' ▼';
    }
    
    // Toggle table subsections (Baseline, Overlays, Channels, Sites)
    function toggleSubsection(headerRow, subsectionClass) {
      const rows = document.querySelectorAll('.' + subsectionClass);
      const isCollapsed = headerRow.classList.toggle('collapsed');
      
      rows.forEach(row => {
        row.classList.toggle('hidden', isCollapsed);
      });
      
      // Update arrow indicator in the header text
      const td = headerRow.querySelector('td');
      if (td) {
        const text = td.textContent;
        if (isCollapsed) {
          td.textContent = text.replace('▼', '▶');
        } else {
          td.textContent = text.replace('▶', '▼');
        }
      }
      
      // Also update any collapse-icon span
      const icon = headerRow.querySelector('.collapse-icon');
      if (icon) {
        icon.textContent = isCollapsed ? '▶' : '▼';
      }
    }
    
    // Toggle nav sections (collapsible sidebar groups)
    function toggleNavSection(sectionElement) {
      sectionElement.classList.toggle('collapsed');
    }
    
    // Initialize nav section toggle
    document.querySelectorAll('.section-label').forEach(label => {
      label.addEventListener('click', function() {
        toggleNavSection(this.closest('.nav-section'));
      });
    });
    
    // Switch scenario tabs
    function switchScenarioTab(tab) {
      // Update tab buttons
      document.querySelectorAll('.scenario-tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      // Show/hide content
      if (tab === 'saved') {
        document.getElementById('savedScenariosTab').style.display = 'block';
        document.getElementById('publishedPlansTab').style.display = 'none';
      } else {
        document.getElementById('savedScenariosTab').style.display = 'none';
        document.getElementById('publishedPlansTab').style.display = 'block';
      }
    }
    
    function submitFeedback() {
      closeModal('feedback');
      showToast('💬 Feedback submitted. Thank you!', 'success');
    }
    
    // Create new pillar
    function createPillar() {
      const name = document.getElementById('newPillarName').value;
      if (!name) {
        showToast('Please enter a pillar name', 'warning');
        return;
      }
      
      closeModal('createPillar');
      showToast('➕ Creating pillar: ' + name + '...', 'info');
      
      // In production: google.script.run.createPillarFromTemplate(name, org, channels)
      setTimeout(() => {
        showToast('✅ Pillar "' + name + '" created!', 'success');
        // Add to nav dynamically
        addPillarToNav(name);
      }, 1500);
    }
    
    // Open Edit Pillar Modal
    let currentEditingPillar = null;
    function openEditPillarModal(pillarName, org) {
      currentEditingPillar = pillarName;
      
      // Populate the form with current values
      document.getElementById('editPillarName').value = pillarName;
      document.getElementById('editPillarOrg').value = org || 'On-Demand';
      
      // Set channel checkboxes based on pillar (demo data)
      const pillarChannels = {
        'Accountant': ['Phone', 'Email', 'Chat'],
        'Benefits': ['Phone', 'Email', 'Chat'],
        'PAC': ['Phone', 'Chat'],
        'Payroll': ['Phone', 'Email', 'Chat'],
        'Premier': ['Phone', 'Email'],
        'DSA': []
      };
      
      const channels = pillarChannels[pillarName] || ['Phone'];
      document.getElementById('editPillarPhone').checked = channels.includes('Phone');
      document.getElementById('editPillarEmail').checked = channels.includes('Email');
      document.getElementById('editPillarChat').checked = channels.includes('Chat');
      
      // Set owner email (demo)
      document.getElementById('editPillarOwner').value = pillarName.toLowerCase() + '-team@gusto.com';
      
      openModal('editPillar');
    }
    
    // Save pillar settings
    function savePillarSettings() {
      const newName = document.getElementById('editPillarName').value;
      const newOrg = document.getElementById('editPillarOrg').value;
      
      if (!newName) {
        showToast('Please enter a pillar name', 'warning');
        return;
      }
      
      closeModal('editPillar');
      showToast('💾 Saving pillar settings...', 'info');
      
      // In production: google.script.run.updatePillarSettings(currentEditingPillar, newName, newOrg, ...)
      setTimeout(() => {
        // Update Control Panel table
        updatePillarInTable(currentEditingPillar, newName, newOrg);
        
        // Update Pillar tab title if different
        if (currentEditingPillar !== newName) {
          updatePillarNav(currentEditingPillar, newName);
        }
        
        showToast('✅ Pillar "' + newName + '" updated!', 'success');
      }, 1000);
    }
    
    // Update pillar name in Control Panel table
    function updatePillarInTable(oldName, newName, newOrg) {
      // Find and update the pillar row in the table
      const table = document.querySelector('#view-controlpanel .data-table tbody');
      if (table) {
        const rows = table.querySelectorAll('tr');
        rows.forEach(row => {
          const link = row.querySelector('a');
          if (link && link.textContent === oldName) {
            link.textContent = newName;
            link.onclick = function() { selectPillar(newName); return false; };
            // Update org cell
            const orgCell = row.querySelector('td:nth-child(2)');
            if (orgCell) orgCell.textContent = newOrg;
            // Update the edit button onclick
            const editBtn = row.querySelector('.btn-secondary');
            if (editBtn) editBtn.onclick = function() { selectPillar(newName); };
            // Update the settings button onclick
            const settingsBtn = row.querySelectorAll('.btn-secondary')[1];
            if (settingsBtn) settingsBtn.onclick = function() { openEditPillarModal(newName, newOrg); };
          }
        });
      }
    }
    
    // Update pillar in navigation
    function updatePillarNav(oldName, newName) {
      const navItem = document.getElementById('pillar-' + oldName);
      if (navItem) {
        navItem.id = 'pillar-' + newName;
        const label = navItem.querySelector('.nav-label');
        if (label) label.textContent = newName;
        navItem.onclick = function() { selectPillar(newName); };
      }
      
      // Update pillar view title if currently viewing this pillar
      if (currentPillar === oldName) {
        currentPillar = newName;
        const titleEl = document.querySelector('#view-pillar .pillar-header h2');
        if (titleEl) titleEl.textContent = newName + ' Pillar';
      }
    }
    
    // Add pillar to navigation
    function addPillarToNav(name) {
      const pillarsSection = document.querySelector('.nav-section:nth-child(2)');
      const newItem = document.createElement('div');
      newItem.className = 'nav-item';
      newItem.id = 'pillar-' + name;
      newItem.onclick = function() { selectPillar(name); };
      newItem.innerHTML = `
        <span class="nav-icon">🏛️</span>
        <span class="nav-text">${name}</span>
        <span class="nav-badge" style="background: var(--success);">New</span>
      `;
      pillarsSection.appendChild(newItem);
    }
    
    // Apply value to all months in that row
    function applyToAll(input, rowId) {
      const value = input.value;
      if (!value) return;
      
      // Find the parent row
      const row = input.closest('tr');
      if (!row) return;
      
      // Get all inputs in this row except the "Apply All" column
      const inputs = row.querySelectorAll('td:not(:last-child) input, td:not(:last-child) select');
      
      inputs.forEach(inp => {
        if (inp.tagName === 'SELECT') {
          // For selects, try to match the value
          for (let i = 0; i < inp.options.length; i++) {
            if (inp.options[i].value === value || inp.options[i].text === value) {
              inp.selectedIndex = i;
              break;
            }
          }
        } else {
          inp.value = value;
        }
      });
      
      showToast('✅ Applied "' + value + '" to all months', 'success');
      triggerAutoRecalc();
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // AUTO-RECALCULATE WITH DEBOUNCE
    // ═══════════════════════════════════════════════════════════════════════
    
    let recalcTimeout = null;
    
    function triggerAutoRecalc() {
      // Update status immediately
      document.querySelector('.status-dot').className = 'status-dot editing';
      document.querySelector('.status-details').textContent = 'Calculating...';
      
      // Clear any existing timeout
      if (recalcTimeout) clearTimeout(recalcTimeout);
      
      // Wait 500ms after last change before recalculating
      recalcTimeout = setTimeout(() => {
        // Simulate recalculation
        showToast('🔄 Auto-recalculating...', 'info');
        setTimeout(() => {
          document.querySelector('.status-dot').className = 'status-dot';
          document.querySelector('.status-details').textContent = 'Changes ready to save';
          showToast('✅ Calculations updated!', 'success');
        }, 800);
      }, 500);
    }
    
    // Update all input handlers to use auto-recalc
    document.querySelectorAll('.row-editable input, .row-editable select').forEach(input => {
      input.addEventListener('change', triggerAutoRecalc);
      input.addEventListener('input', function() {
        document.querySelector('.status-dot').className = 'status-dot editing';
        document.querySelector('.status-details').textContent = 'Typing...';
      });
    });
    
    // ═══════════════════════════════════════════════════════════════════════
    // COLLAPSIBLE SECTIONS
    // ═══════════════════════════════════════════════════════════════════════
    
    function toggleSection(sectionId) {
      const section = document.getElementById(sectionId);
      section.classList.toggle('collapsed');
      
      const isCollapsed = section.classList.contains('collapsed');
      showToast(isCollapsed ? '📁 Section collapsed' : '📂 Section expanded', 'info');
    }
    
    // Toggle All-In view table sections
    function toggleAllInSection(headerRow) {
      // Get all following siblings until the next section header
      let nextRow = headerRow.nextElementSibling;
      const rowsToToggle = [];
      
      while (nextRow && !nextRow.classList.contains('row-section-header')) {
        rowsToToggle.push(nextRow);
        nextRow = nextRow.nextElementSibling;
      }
      
      if (rowsToToggle.length === 0) return;
      
      // Check if currently collapsed
      const isCollapsed = rowsToToggle[0].style.display === 'none';
      
      // Toggle all rows
      rowsToToggle.forEach(row => {
        row.style.display = isCollapsed ? '' : 'none';
      });
      
      // Update arrow indicator
      const arrow = headerRow.querySelector('span');
      if (arrow) {
        arrow.textContent = isCollapsed ? '▼' : '▶';
      }
    }
    
    // NOTE: toggleSubsection is defined earlier in the file - removed duplicate here
    
    // Toggle overlay summary section visibility
    function toggleOverlaysVisibility(show) {
      const overlaysSection = document.getElementById('overlaysSummarySection');
      if (overlaysSection) {
        overlaysSection.style.display = show ? '' : 'none';
        if (show) {
          filterOverlaysByChannel(); // Apply current channel filter
        }
      }
    }
    
    // Toggle overlay summary expand/collapse
    function toggleOverlaysSummary() {
      const content = document.getElementById('overlaysSummaryContent');
      const arrow = document.getElementById('overlaysArrow');
      const isHidden = content.style.display === 'none';
      content.style.display = isHidden ? '' : 'none';
      arrow.textContent = isHidden ? '▼' : '▶';
    }
    
    // Toggle pillar accordion in overlay summary
    function toggleOverlayPillar(element) {
      const content = element.nextElementSibling;
      const arrow = element.querySelector('.overlay-pillar-arrow');
      const isCollapsed = content.classList.contains('collapsed');
      
      if (isCollapsed) {
        content.classList.remove('collapsed');
        arrow.textContent = '▼';
      } else {
        content.classList.add('collapsed');
        arrow.textContent = '▶';
      }
    }
    
    // Toggle channel accordion in overlay summary
    function toggleOverlayChannel(element) {
      const content = element.nextElementSibling;
      const arrow = element.querySelector('.overlay-channel-arrow');
      const isCollapsed = content.classList.contains('collapsed');
      
      if (isCollapsed) {
        content.classList.remove('collapsed');
        arrow.textContent = '▼';
      } else {
        content.classList.add('collapsed');
        arrow.textContent = '▶';
      }
    }
    
    // Toggle comparison table sections
    function toggleComparisonSection(headerRow) {
      const arrow = headerRow.querySelector('span');
      const tbody = headerRow.closest('tbody');
      let currentRow = headerRow.nextElementSibling;
      const isCollapsing = arrow.textContent === '▼';
      
      // Toggle visibility of rows until we hit another section header
      while (currentRow && !currentRow.classList.contains('row-section-header')) {
        currentRow.style.display = isCollapsing ? 'none' : '';
        currentRow = currentRow.nextElementSibling;
      }
      
      arrow.textContent = isCollapsing ? '▶' : '▼';
    }
    
    // Filter overlay rows based on selected channels AND orgs
    function filterOverlaysByChannel() {
      const channelSelect = document.getElementById('allInChannelSelect');
      const orgSelect = document.getElementById('allInOrgSelect');
      if (!channelSelect || !orgSelect) return;
      
      // Get selected channels
      const selectedChannels = [];
      channelSelect.querySelectorAll('.multi-select-item:not(.select-all) input:checked').forEach(input => {
        selectedChannels.push(input.value);
      });
      
      // Get selected orgs
      const selectedOrgs = [];
      orgSelect.querySelectorAll('.multi-select-item:not(.select-all) input:checked').forEach(input => {
        selectedOrgs.push(input.value);
      });
      
      // Filter pillar groups by org
      document.querySelectorAll('.overlay-pillar-group').forEach(pillarGroup => {
        let orgMatch = false;
        if (selectedOrgs.includes('ondemand') && pillarGroup.classList.contains('overlay-ondemand')) orgMatch = true;
        if (selectedOrgs.includes('advanced') && pillarGroup.classList.contains('overlay-advanced')) orgMatch = true;
        if (selectedOrgs.includes('dsa') && pillarGroup.classList.contains('overlay-dsa')) orgMatch = true;
        
        pillarGroup.style.display = orgMatch ? '' : 'none';
      });
      
      // Filter channel groups within visible pillars
      document.querySelectorAll('.overlay-channel-group').forEach(channelGroup => {
        let channelMatch = false;
        if (selectedChannels.includes('phone') && channelGroup.classList.contains('overlay-phone')) channelMatch = true;
        if (selectedChannels.includes('chat') && channelGroup.classList.contains('overlay-chat')) channelMatch = true;
        if (selectedChannels.includes('email') && channelGroup.classList.contains('overlay-email')) channelMatch = true;
        
        channelGroup.style.display = channelMatch ? '' : 'none';
      });
      
      // Update overlay counts on visible pillars
      document.querySelectorAll('.overlay-pillar-group').forEach(pillarGroup => {
        if (pillarGroup.style.display !== 'none') {
          const visibleChannels = pillarGroup.querySelectorAll('.overlay-channel-group:not([style*="display: none"])');
          const header = pillarGroup.querySelector('.overlay-pillar-header span:last-child');
          const count = visibleChannels.length;
          if (header && count === 0) {
            pillarGroup.style.display = 'none'; // Hide pillar if no channels visible
          }
        }
      });
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // PLAN COMPARISON - VIEW TOGGLES & INSIGHTS
    // ═══════════════════════════════════════════════════════════════════════
    
    // Toggle between Story, Table, and Graph views
    function setComparisonView(view) {
      // Update active button
      document.querySelectorAll('.comparison-view-btn').forEach(btn => {
        btn.classList.remove('active');
        btn.style.background = 'transparent';
        btn.style.boxShadow = 'none';
      });
      event.target.classList.add('active');
      event.target.style.background = 'white';
      event.target.style.boxShadow = 'var(--shadow-sm)';
      
      // Hide all view containers
      document.getElementById('comparisonStoryView').style.display = 'none';
      document.getElementById('comparisonTableView').style.display = 'none';
      document.getElementById('comparisonGraphView').style.display = 'none';
      
      // Show selected view
      if (view === 'story') {
        document.getElementById('comparisonStoryView').style.display = 'block';
      } else if (view === 'table') {
        document.getElementById('comparisonTableView').style.display = 'block';
      } else if (view === 'graph') {
        document.getElementById('comparisonGraphView').style.display = 'block';
      }
    }
    
    // Add a custom insight to the comparison
    function addComparisonInsight() {
      const insightsContainer = document.getElementById('comparisonInsights');
      const newInsight = document.createElement('div');
      newInsight.style.cssText = 'display: flex; align-items: flex-start; gap: 8px; background: white; padding: 10px 14px; border-radius: 8px; border: 1px dashed #8B5CF6;';
      newInsight.innerHTML = `
        <span style="font-size: 14px;">✍️</span>
        <span style="font-size: 13px; color: var(--gray-700); line-height: 1.5; flex: 1;" contenteditable="true" placeholder="Type your insight here...">Click to add your custom insight...</span>
        <button onclick="this.parentElement.remove()" style="background: none; border: none; color: var(--gray-400); cursor: pointer; font-size: 12px;">✕</button>
      `;
      insightsContainer.appendChild(newInsight);
      
      // Focus on the editable span
      const editableSpan = newInsight.querySelector('[contenteditable]');
      editableSpan.focus();
      editableSpan.addEventListener('focus', function() {
        if (this.textContent === 'Click to add your custom insight...') {
          this.textContent = '';
        }
      });
    }
    
    // Generate a stakeholder report from insights
    function generateStakeholderReport() {
      // Try to get from expanded modal first, fall back to compact view
      let insights = [];
      const expandedInsights = document.querySelectorAll('#expandedInsights > div span[contenteditable]');
      const compactInsights = document.querySelectorAll('#comparisonInsights > div span[contenteditable]');
      
      const source = expandedInsights.length > 0 ? expandedInsights : compactInsights;
      source.forEach(span => {
        insights.push(span.textContent.trim());
      });
      
      // Get custom notes if available
      const customNotes = document.getElementById('insightsCustomNotes')?.value || '';
      
      // For prototype, copy to clipboard and show confirmation
      const reportText = `
📊 STAFFING IMPACT REPORT
Generated: ${new Date().toLocaleDateString()}
Comparing: Published v3.2 vs +10% Volume Scenario
Period: May 2025 → April 2026

KEY INSIGHTS:
${insights.map((insight, i) => `${i + 1}. ${insight}`).join('\n\n')}
${customNotes ? `\nADDITIONAL NOTES:\n${customNotes}` : ''}

SUMMARY:
• Volume Change: +10% (19K → 21K)
• HC Need Impact: +5 HC (51 → 56)
• Staffing Gap: -35 (from -30)
• OT Requirement: +55 hrs/month
• Final Gap (after OT): -27

ACTION ITEMS:
- Review hiring timeline for Q4 2025
- Assess OT sustainability
- Monitor December peak staffing
      `.trim();
      
      navigator.clipboard.writeText(reportText).then(() => {
        showToast('📋 Report copied to clipboard! Ready to share with stakeholders.', 'success');
      }).catch(() => {
        showToast('📤 Report generated! (Copy functionality requires HTTPS)', 'info');
      });
    }
    
    // Pop out insights to expanded modal
    function popOutInsights() {
      openModal('insights');
    }
    
    // All-In Insights functions
    function addAllInInsight() {
      const container = document.getElementById('allInInsights');
      const newInsight = document.createElement('div');
      newInsight.style.cssText = 'display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px; border: 1px dashed #22C55E;';
      newInsight.innerHTML = `
        <span>✍️</span>
        <span style="color: var(--gray-700); line-height: 1.4; flex: 1;" contenteditable="true">Add your insight...</span>
        <button onclick="this.parentElement.remove()" style="background: none; border: none; color: var(--gray-400); cursor: pointer; font-size: 10px;">✕</button>
      `;
      container.appendChild(newInsight);
      newInsight.querySelector('[contenteditable]').focus();
    }
    
    function popOutAllInInsights() {
      // For prototype, show a toast - full modal would be implemented in production
      showToast('Expanded All-In insights view coming soon!', 'info');
    }
    
    // Pillar Insights functions
    function addPillarInsight() {
      const container = document.getElementById('pillarInsights');
      const newInsight = document.createElement('div');
      newInsight.style.cssText = 'display: flex; align-items: flex-start; gap: 6px; background: white; padding: 8px 10px; border-radius: 6px; font-size: 11px; border: 1px dashed #F97316;';
      newInsight.innerHTML = `
        <span>✍️</span>
        <span style="color: var(--gray-700); line-height: 1.4; flex: 1;" contenteditable="true">Add your insight...</span>
        <button onclick="this.parentElement.remove()" style="background: none; border: none; color: var(--gray-400); cursor: pointer; font-size: 10px;">✕</button>
      `;
      container.appendChild(newInsight);
      newInsight.querySelector('[contenteditable]').focus();
    }
    
    function popOutPillarInsights() {
      // For prototype, show a toast - full modal would be implemented in production
      showToast('Expanded Pillar insights view coming soon!', 'info');
    }
    
    // Add insight in expanded modal
    function addExpandedInsight() {
      const container = document.getElementById('expandedInsights');
      const newInsight = document.createElement('div');
      newInsight.style.cssText = 'display: flex; align-items: flex-start; gap: 10px; background: white; padding: 14px 16px; border-radius: 8px; border: 2px dashed #8B5CF6;';
      newInsight.innerHTML = `
        <span style="font-size: 18px;">✍️</span>
        <div style="flex: 1;">
          <span style="color: var(--gray-700); line-height: 1.6; font-size: 14px;" contenteditable="true">Click here to add your custom insight...</span>
        </div>
        <button onclick="this.parentElement.remove()" style="background: none; border: none; color: var(--gray-400); cursor: pointer; font-size: 14px; padding: 4px;">✕</button>
      `;
      container.appendChild(newInsight);
      
      // Focus and select placeholder text
      const editableSpan = newInsight.querySelector('[contenteditable]');
      editableSpan.focus();
      editableSpan.addEventListener('focus', function() {
        if (this.textContent === 'Click here to add your custom insight...') {
          this.textContent = '';
        }
      });
    }
    
    // Update comparison plans based on selected pillar
    function updateComparisonPlans() {
      const pillarSelect = document.getElementById('comparisonPillarSelect');
      const basePlanSelect = document.getElementById('comparisonBasePlan');
      const targetSelect = document.getElementById('comparisonTarget');
      
      const pillar = pillarSelect.value;
      const pillarName = pillarSelect.options[pillarSelect.selectedIndex].text;
      
      // Define available plans/scenarios per pillar (in production, this comes from backend)
      const pillarPlans = {
        'all': {
          base: [
            { value: 'published-3.2', label: '📋 Published v3.2 (Current)' },
            { value: 'published-3.1', label: '📋 Published v3.1' },
            { value: 'published-3.0', label: '📋 Published v3.0' }
          ],
          scenarios: [
            { value: 'working', label: '✏️ Working Draft' },
            { value: 'scenario-volume', label: '💾 +10% Volume' },
            { value: 'scenario-attrition', label: '💾 High Attrition' },
            { value: 'scenario-shrink', label: '💾 Reduced Shrink' }
          ]
        },
        'accountant': {
          base: [
            { value: 'published-3.2', label: '📋 Accountant v3.2 (Current)' },
            { value: 'published-3.1', label: '📋 Accountant v3.1' }
          ],
          scenarios: [
            { value: 'working', label: '✏️ Working Draft' },
            { value: 'scenario-volume', label: '💾 +10% Volume' },
            { value: 'scenario-peak', label: '💾 Tax Season Peak' }
          ]
        },
        'benefits': {
          base: [
            { value: 'published-3.2', label: '📋 Benefits v3.2 (Current)' },
            { value: 'published-3.0', label: '📋 Benefits v3.0' }
          ],
          scenarios: [
            { value: 'working', label: '✏️ Working Draft' },
            { value: 'scenario-oe', label: '💾 Open Enrollment' }
          ]
        },
        'pac': {
          base: [
            { value: 'published-3.1', label: '📋 PAC v3.1 (Current)' }
          ],
          scenarios: [
            { value: 'working', label: '✏️ Working Draft' }
          ]
        },
        'payroll': {
          base: [
            { value: 'published-3.2', label: '📋 Payroll v3.2 (Current)' },
            { value: 'published-3.1', label: '📋 Payroll v3.1' },
            { value: 'published-3.0', label: '📋 Payroll v3.0' }
          ],
          scenarios: [
            { value: 'working', label: '✏️ Working Draft' },
            { value: 'scenario-volume', label: '💾 +15% Volume' },
            { value: 'scenario-eoy', label: '💾 EOY Rush' }
          ]
        },
        'premier': {
          base: [
            { value: 'published-3.2', label: '📋 Premier v3.2 (Current)' }
          ],
          scenarios: [
            { value: 'working', label: '✏️ Working Draft' },
            { value: 'scenario-growth', label: '💾 Customer Growth' }
          ]
        }
      };
      
      const plans = pillarPlans[pillar] || pillarPlans['all'];
      
      // Update base plan dropdown
      basePlanSelect.innerHTML = plans.base.map(p => 
        `<option value="${p.value}">${p.label}</option>`
      ).join('');
      
      // Update target dropdown
      targetSelect.innerHTML = plans.scenarios.map(s => 
        `<option value="${s.value}">${s.label}</option>`
      ).join('');
    }
    
    // Run comparison (prototype - just shows toast)
    function runComparison() {
      const pillar = document.getElementById('comparisonPillarSelect');
      const base = document.getElementById('comparisonBasePlan');
      const target = document.getElementById('comparisonTarget');
      
      const pillarName = pillar.options[pillar.selectedIndex].text;
      const baseName = base.options[base.selectedIndex].text;
      const targetName = target.options[target.selectedIndex].text;
      
      showToast(`Comparing: ${baseName} vs ${targetName}`, 'success');
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // FLOATING ACTION BUTTONS
    // ═══════════════════════════════════════════════════════════════════════
    
    function toggleFab() {
      document.getElementById('fabContainer').classList.toggle('expanded');
    }
    
    // Close FAB when clicking outside
    document.addEventListener('click', function(e) {
      const fab = document.getElementById('fabContainer');
      if (!fab.contains(e.target) && fab.classList.contains('expanded')) {
        fab.classList.remove('expanded');
      }
    });
    
    function submitBugReport() {
      closeModal('bugReport');
      showToast('🐛 Bug report submitted. We\'ll investigate!', 'success');
    }
    
    function submitFeatureRequest() {
      closeModal('featureRequest');
      showToast('💡 Feature request logged. Thank you!', 'success');
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // ACTIVITY & VERSION PANELS
    // ═══════════════════════════════════════════════════════════════════════
    
    function toggleActivityPanel() {
      const panel = document.getElementById('activityPanel');
      const isVisible = panel.style.display === 'flex';
      panel.style.display = isVisible ? 'none' : 'flex';
    }
    
    function toggleVersionPanel() {
      const panel = document.getElementById('versionPanel');
      const isVisible = panel.style.display === 'flex';
      panel.style.display = isVisible ? 'none' : 'flex';
    }
    
    function toggleExportPanel() {
      const panel = document.getElementById('exportPanel');
      const isVisible = panel.style.display === 'flex';
      panel.style.display = isVisible ? 'none' : 'flex';
    }
    
    function showVersionType(type) {
      // Update tabs
      document.querySelectorAll('.version-tab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');
      
      // Show/hide lists
      document.getElementById('publishedList').style.display = type === 'published' ? 'block' : 'none';
      document.getElementById('scenariosList').style.display = type === 'scenarios' ? 'block' : 'none';
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // VIEW MANAGEMENT (ALL-IN vs PILLAR vs DASHBOARD)
    // ═══════════════════════════════════════════════════════════════════════
    
    // Current view state
    let currentView = 'controlpanel'; // Default to Control Panel
    let currentPlanView = 'working'; // working | published | compare
    let hasUnsavedChanges = false; // Track if there are unsaved changes
    
    // ═══════════════════════════════════════════════════════════════════════
    // PLAN VIEW TOGGLE (Working / Published / Compare)
    // ═══════════════════════════════════════════════════════════════════════
    
    function setPlanView(view) {
      currentPlanView = view;
      
      // Update toggle button states
      const options = document.querySelectorAll('.comparison-option');
      options.forEach(opt => opt.classList.remove('active'));
      event.target.classList.add('active');
      
      // Get all editable inputs
      const inputs = document.querySelectorAll('input[type="number"], input[type="text"], select:not(.form-select)');
      const tables = document.querySelectorAll('.data-table');
      
      if (view === 'working') {
        // Working Plan: Editable state
        inputs.forEach(input => {
          input.disabled = false;
          input.style.opacity = '1';
          input.style.backgroundColor = '';
        });
        document.body.classList.remove('view-published', 'view-compare');
        // Remove any diff highlights
        document.querySelectorAll('.diff-increase, .diff-decrease').forEach(el => {
          el.classList.remove('diff-increase', 'diff-decrease');
        });
        
      } else if (view === 'published') {
        // Published: Read-only state
        inputs.forEach(input => {
          input.disabled = true;
          input.style.opacity = '0.7';
          input.style.backgroundColor = 'var(--gray-100)';
        });
        document.body.classList.add('view-published');
        document.body.classList.remove('view-compare');
        
      } else if (view === 'compare') {
        // Compare: Show diff indicators
        inputs.forEach(input => {
          input.disabled = true;
          input.style.opacity = '1';
        });
        document.body.classList.add('view-compare');
        document.body.classList.remove('view-published');
        
        // Add some fake diff highlights for prototype
        highlightDifferences();
        showToast('⚖️ Differences highlighted', 'info');
      }
    }
    
    // Highlight differences for compare mode (prototype fake data)
    function highlightDifferences() {
      // Remove any existing highlights
      document.querySelectorAll('.diff-increase, .diff-decrease').forEach(el => {
        el.classList.remove('diff-increase', 'diff-decrease');
      });
      
      // Add fake diff highlights to some cells for demo
      const cells = document.querySelectorAll('.data-table td:not(:first-child)');
      cells.forEach((cell, index) => {
        // Randomly highlight ~10% of cells
        if (Math.random() < 0.1 && !cell.querySelector('input')) {
          if (Math.random() < 0.5) {
            cell.classList.add('diff-increase');
          } else {
            cell.classList.add('diff-decrease');
          }
        }
      });
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // UNSAVED CHANGES WARNING
    // ═══════════════════════════════════════════════════════════════════════
    
    // Warn user before leaving with unsaved changes
    window.addEventListener('beforeunload', function(e) {
      if (hasUnsavedChanges) {
        e.preventDefault();
        e.returnValue = 'You have unsaved changes. Are you sure you want to leave?';
        return e.returnValue;
      }
    });
    
    // Mark as having unsaved changes when any input changes
    document.addEventListener('input', function(e) {
      if (e.target.matches('input, textarea, select')) {
        hasUnsavedChanges = true;
        updateUnsavedIndicator();
      }
    });
    
    // Update the unsaved changes indicator in footer
    function updateUnsavedIndicator() {
      const indicators = document.querySelectorAll('.unsaved-indicator');
      indicators.forEach(ind => {
        ind.style.display = hasUnsavedChanges ? 'inline' : 'none';
      });
    }
    
    // Mark changes as saved
    function markAsSaved() {
      hasUnsavedChanges = false;
      updateUnsavedIndicator();
      showToast('💾 All changes saved!', 'success');
    }
    
    // ═══════════════════════════════════════════════════════════════════════
    // ALL-IN CHANNEL FILTER
    // ═══════════════════════════════════════════════════════════════════════
    
    // Combined filter for All-In view (channels and orgs)
    function filterAllInData() {
      // Get selected channels
      const channelSelect = document.getElementById('allInChannelSelect');
      const selectedChannels = [];
      channelSelect.querySelectorAll('.multi-select-item:not(.select-all) input:checked').forEach(input => {
        selectedChannels.push(input.value);
      });
      
      // Get selected orgs
      const orgSelect = document.getElementById('allInOrgSelect');
      const selectedOrgs = [];
      orgSelect.querySelectorAll('.multi-select-item:not(.select-all) input:checked').forEach(input => {
        selectedOrgs.push(input.value);
      });
      
      // Update trigger labels
      const channelCount = selectedChannels.length;
      const orgCount = selectedOrgs.length;
      channelSelect.querySelector('.multi-select-trigger span').textContent = 
        channelCount === 3 ? 'All Channels' : channelCount + ' Channel' + (channelCount !== 1 ? 's' : '');
      orgSelect.querySelector('.multi-select-trigger span').textContent = 
        orgCount === 3 ? 'All Orgs' : orgCount + ' Org' + (orgCount !== 1 ? 's' : '');
      
      // Filter channel rows (Volume and AHT)
      const volumeRows = document.querySelectorAll('.volume-channel-sub');
      const ahtRows = document.querySelectorAll('.aht-channel-sub');
      
      [...volumeRows, ...ahtRows].forEach(row => {
        const cellText = row.querySelector('td')?.textContent || '';
        let show = false;
        if (selectedChannels.includes('phone') && cellText.includes('Phone')) show = true;
        if (selectedChannels.includes('chat') && cellText.includes('Chat')) show = true;
        if (selectedChannels.includes('email') && cellText.includes('Email')) show = true;
        row.style.display = show ? '' : 'none';
      });
      
      // Filter organization rows (HC Need breakdown)
      const hcRows = document.querySelectorAll('.hc-pillar-sub');
      hcRows.forEach(row => {
        const cellText = row.querySelector('td')?.textContent || '';
        let show = false;
        if (selectedOrgs.includes('ondemand') && cellText.includes('On-Demand')) show = true;
        if (selectedOrgs.includes('advanced') && cellText.includes('Advanced')) show = true;
        if (selectedOrgs.includes('dsa') && cellText.includes('DSA')) show = true;
        row.style.display = show ? '' : 'none';
      });
      
      // Also filter the overlay summary section
      filterOverlaysByChannel();
    }
    
    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM loaded, initializing view...');
      
      // First, make sure Project Hub is shown by default
      const projectHubView = document.getElementById('view-projecthub');
      if (projectHubView) {
        projectHubView.style.display = 'block';
        console.log('Project Hub view displayed');
      }
      
      // Set nav active
      const projectHubNav = document.getElementById('nav-projecthub');
      if (projectHubNav) {
        projectHubNav.classList.add('active');
      }
      
      // Set greeting and hide toggle for Project Hub default
      document.getElementById('pageTitle').textContent = '👋 Hello, Bunny B!';
      document.getElementById('comparisonToggle').style.display = 'none';
      document.getElementById('pillarDropdown').style.display = 'none';
      const scenariosBtn = document.getElementById('scenariosBtn');
      if (scenariosBtn) scenariosBtn.style.display = 'none';
      
      // Now check if there's a hash to override
      const hash = window.location.hash.slice(1);
      if (hash && hash !== 'projecthub') {
        console.log('Hash found:', hash);
        if (hash.startsWith('pillar-')) {
          const pillarName = hash.replace('pillar-', '');
          selectPillar(pillarName);
        } else if (['controlpanel', 'allin', 'dashboard', 'comparison', 'datamanagement', 'overlays', 'published', 'scenarios', 'designsystem', 'overview'].includes(hash)) {
          loadView(hash);
        }
      }
      
      console.log('Initialization complete');
    });
    
    // Handle browser back/forward buttons
    window.addEventListener('hashchange', function() {
      const hash = window.location.hash.slice(1);
      console.log('Hash changed to:', hash);
      
      if (hash) {
        if (hash.startsWith('pillar-')) {
          const pillarName = hash.replace('pillar-', '');
          selectPillarDirect(pillarName);
        } else if (['controlpanel', 'allin', 'dashboard', 'comparison', 'projecthub', 'datamanagement', 'overlays', 'published', 'scenarios', 'designsystem', 'overview'].includes(hash)) {
          loadViewDirect(hash);
        }
      }
    });
    
    // Direct view loading without hash update (for hashchange)
    function loadViewDirect(view) {
      // Hide all view containers
      document.querySelectorAll('.view-container').forEach(v => {
        v.style.display = 'none';
      });
      
      // Show the selected view
      const viewElement = document.getElementById('view-' + view);
      if (viewElement) {
        viewElement.style.display = 'block';
      }
      
      // Update nav highlighting
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      const navItem = document.getElementById('nav-' + view);
      if (navItem) {
        navItem.classList.add('active');
      }
    }
    
    // Direct pillar selection without hash update (for hashchange)
    function selectPillarDirect(pillar) {
      // Hide all view containers
      document.querySelectorAll('.view-container').forEach(v => {
        v.style.display = 'none';
      });
      document.getElementById('view-pillar').style.display = 'block';
      
      // Update nav highlighting
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      const pillarNav = document.getElementById('pillar-' + pillar);
      if (pillarNav) {
        pillarNav.classList.add('active');
      }
    }
    
  </script>
</body>
</html>





